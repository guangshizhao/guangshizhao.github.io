(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58b555dc"],{6187:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a("7300"),r=a("5873"),n=a("ddf2"),l=a("80ea"),o=a("ae0a"),s=a("97a3"),d=a("652a"),c=a("1269"),u=new d["a"],m=function(e){function t(){var e,a;Object(i["a"])(this,t);for(var o=arguments.length,d=new Array(o),c=0;c<o;c++)d[c]=arguments[c];return a=Object(r["a"])(this,(e=Object(n["a"])(t)).call.apply(e,[this].concat(d))),Object(s["a"])(Object(l["a"])(a),"__name","SystemConfig"),Object(s["a"])(Object(l["a"])(a),"systemKey",u.charField({fieldName:"关键字"})),Object(s["a"])(Object(l["a"])(a),"systemValue",u.charField({fieldName:"值"})),Object(s["a"])(Object(l["a"])(a),"remark",u.charField({fieldName:"备注"})),a}return Object(o["a"])(t,e),t}(c["a"])},"69c1":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("layContentHeader",{attrs:{title:"维修标准",buttons:e.headerBtns}}),a("layContent",[a("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,sort:e.sort,DataSource:e.DataSource,hideOperation:!0,formatFields:e.formatFields,total:e.total},on:{initialize:e.initTable}}),a("contentModal",{attrs:{title:e.title,IsShow:e.IsShow,width:"1100"},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[a("repairStandardDetail",{ref:"addOrUpdate",attrs:{item:e.detailForUpdate}})],1),a("contentModal",{attrs:{title:"导入维修标准",IsShow:e.IsShowImport},on:{modalClosed:function(t){return e.modalClosedImport()},modalComfirmed:function(t){return e.ComfirmImport()}}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:e.downloadTemp}},[e._v("下载导入模板")]),a("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("\n                    (注:文档内标题标红的列为必填项，请勿输入以下非法字符：~、@、$、^、&、《、》、<、>、￥)\n                ")])],1),a("UploadFile",{ref:"uploadFile",attrs:{label:"导入文件"},on:{formData:e.getFormData},model:{value:e.base64,callback:function(t){e.base64=t},expression:"base64"}})],1)],1)],1)},r=[],n=(a("4634"),a("7cfd"),a("de90"),a("7300")),l=a("5873"),o=a("ddf2"),s=a("80ea"),d=a("ae0a"),c=a("97a3"),u=a("652a"),m=a("1269"),f=new u["a"],p=function(e){function t(){var e,a;Object(n["a"])(this,t);for(var i=arguments.length,r=new Array(i),d=0;d<i;d++)r[d]=arguments[d];return a=Object(l["a"])(this,(e=Object(o["a"])(t)).call.apply(e,[this].concat(r))),Object(c["a"])(Object(s["a"])(a),"__name","RepairStandard"),Object(c["a"])(Object(s["a"])(a),"equipmentName",f.charField({require:!0,fieldName:"设备"})),Object(c["a"])(Object(s["a"])(a),"equipmentModel",f.charField({require:!0,fieldName:"规格型号"})),Object(c["a"])(Object(s["a"])(a),"stoppageDescription",f.charField({require:!0,fieldName:"故障现象"})),Object(c["a"])(Object(s["a"])(a),"stoppageReason",f.charField({require:!0,fieldName:"故障原因"})),Object(c["a"])(Object(s["a"])(a),"repairMethod",f.charField({require:!0,fieldName:"维修方法"})),Object(c["a"])(Object(s["a"])(a),"repairTime",f.charField({require:!0,fieldName:"维修标准时间(min)"})),Object(c["a"])(Object(s["a"])(a),"spareCodeNames",f.charField({fieldName:"所需耗材"})),a}return Object(d["a"])(t,e),t}(m["a"]),h=a("d5b3"),b=a("8333"),v=a("a2a7"),x=a("f05f"),g=a("681f"),S=a("55b3"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("treeView",{ref:"treeView",attrs:{independentCheck:!0,Source:e.equipments,MultipleSelect:!1,label:"设备",independentSingleCheck:!0,"return-object":"",require:!0},model:{value:e.item.directoryID,callback:function(t){e.$set(e.item,"directoryID",t)},expression:"item.directoryID"}})],1),a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{label:"故障现象",clearable:"",rules:[function(e){return!!e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n              "+e._s("故障现象")+" "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.stoppageDescription,callback:function(t){e.$set(e.item,"stoppageDescription",t)},expression:"item.stoppageDescription"}})],1),a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{clearable:"",label:"故障原因",rules:[function(e){return!!e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n              "+e._s("故障原因")+" "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.stoppageReason,callback:function(t){e.$set(e.item,"stoppageReason",t)},expression:"item.stoppageReason"}})],1),a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{clearable:"",label:"维修方法",rules:[function(e){return!!e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n              "+e._s("维修方法")+" "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.repairMethod,callback:function(t){e.$set(e.item,"repairMethod",t)},expression:"item.repairMethod"}})],1),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{staticStyle:{width:"200px"},attrs:{label:"维修标准时间",clearable:"",suffix:"min",hint:e.hint,rules:[function(t){return t=t,void 0==t||null==t||0==t.toString().length?"必填项":void 0!=e.maxtime&&null!=e.maxtime&&e.maxtime>0?""!=t&&parseInt(t)<=e.maxtime&&parseInt(t)>0||"0-"+e.maxtime:void 0}],type:"number"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n              维修标准时间 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.repairTime,callback:function(t){e.$set(e.item,"repairTime",t)},expression:"item.repairTime"}})],1),a("v-flex",{attrs:{xs12:""}},[a("v-select",{attrs:{items:e.sparePartsList,label:"所需耗材","item-text":"codeName","item-value":"id",multiple:""},model:{value:e.item.sparePartIds,callback:function(t){e.$set(e.item,"sparePartIds",t)},expression:"item.sparePartIds"}})],1),a("v-flex",{attrs:{xs12:""}},[a("span",{staticStyle:{"font-weight":"bold",width:"100%","padding-top":"20px"}},[e._v("上传附件:")]),a("v-icon",{on:{click:function(t){return e.addUpload()}}},[e._v("add")])],1),a("v-flex",{attrs:{xs12:""}},e._l(e.item.standardDocumentList,(function(t,i){return a("v-layout",{key:t.id,attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs9:""}},[a("fileUploader",{ref:"uploadFile",refInFor:!0,attrs:{label:"上传附件",multiple:!1,fileNames:t.documentViewModel.dname,uploadBase64:!1,userVersion:t},on:{formData:e.getFormData},model:{value:t.documentViewModel,callback:function(a){e.$set(t,"documentViewModel",a)},expression:"doc.documentViewModel"}})],1),a("v-flex",{attrs:{xs3:""}},[a("v-icon",{on:{click:function(t){return e.deleteItem(i)}}},[e._v("delete")])],1)],1)})),1)],1)],1)],1)],1)},w=[],O=a("f19a"),I=a("d685"),D=a("a1de"),F=a("2c75"),$=a("6187"),_={name:"repairStandardDetail",data:function(){return{valid:!0,equipmentList:[],sparePartsList:[],hint:"",maxtime:0}},components:{treeView:O["a"],fileUploader:D["a"]},created:function(){var e=this;e.$Server.queryAll((new I["a"]).__name).then((function(t){e.equipmentList=t.datas})),e.$Server.queryAll((new F["a"]).__name,{},{deleted:"false"}).then((function(t){e.sparePartsList=t.datas})),e.$Server.queryAll((new $["a"]).__name,{},{systemKey:"repairMaxTime"}).then((function(t){t.datas&&t.datas.length>0&&t.datas[0].systemValue&&(e.maxtime=t.datas[0].systemValue,e.maxtime>0&&(e.hint="0-"+e.maxtime))}))},computed:{equipments:function(){var e=[],t=[];if(this.equipmentList.forEach((function(a){e.push(a),-1==t.indexOf(a.eType)&&(a.eType&&a.eType.length>0||(a.eType="无"),t.push(a.eType))})),t.forEach((function(t,a){e.push({name:t,id:a+1,parentId:-1,isshow:!1})})),void 0==this.equipmentList||null==this.equipmentList||0==this.equipmentList.length);else{this.equipmentList.forEach((function(e){e.name=e.nameAndModel}));for(var a=0;a<e.length;a++)for(var i=0;i<e.length;i++)if(e[a].eType==e[i].name){e[a].parentId=e[i].id;break}}return e}},props:["item"],methods:{validate:function(){var e=!0;return this.item.standardDocumentList.forEach((function(t){null==t||null!=t.documentViewModel&&""!=t.documentViewModel&&null!=t.documentViewModel.dname||(e=!1)})),0==e?(h["a"].alert("请选择上传文件或者删除当前文件选项列"),!1):1==this.$refs.form.validate()},addUpload:function(){this.item.standardDocumentList.push({documentViewModel:{}})},getFormData:function(e){},deleteItem:function(e){this.item.standardDocumentList.splice(e,1)}}},j=_,k=a("6691"),T=Object(k["a"])(j,y,w,!1,null,"42c3d302",null),M=T.exports,C=new b["a"](new p),N={name:"repairStandard",data:function(){var e=this;return{initObject:{id:"",equipment:{},stoppageDescription:"",stoppageReason:"",repairMethod:"",repairTime:"",sparePartIds:[],standardDocumentList:[{documentViewModel:{}}]},searchfx:"",sort:!0,total:1,DataSource:[],title:"",IsShow:!1,IsAddOp:!0,detailForUpdate:{},IsShowImport:!1,base64:"",headerBtns:[{disabled:!this.$per("RepairStandard","c"),text:"添加",icon:"self_add",click:function(){return e.tableAdd()}},{disabled:!this.$per("RepairStandard","u"),text:"编辑",icon:"self_edit",click:function(){return e.tableEdit()}},{disabled:!this.$per("RepairStandard","d"),text:"删除",icon:"self_delete",click:function(){return e.tableDelete()}},{disabled:!this.$per("RepairStandard","import"),text:"导入",icon:"self_import",click:function(){return e.import()}},{disabled:!this.$per("RepairStandard","e"),text:"导出",icon:"self_export",click:function(){return e.export()}}]}},computed:{headers:function(){var e=C.formatGridHeader();return!0===this.sort&&e.unshift({text:"序号",align:"center",sortable:!1}),e},formatFields:function(){return C.getFormatFields()}},components:{contentModal:v["a"],dataTable:x["a"],UploadFile:S["a"],repairStandardDetail:M},mounted:function(){},methods:{getFormData:function(e){var t=this,a=e.get("data");if(a){var i=a.name.substring(a.name.lastIndexOf(".")+1,a.name.length);"xls"!=i&&"xlsx"!=i&&(h["a"].alert("请检查文件是否为Excel文件"),t.$refs.uploadFile.clearFile())}},downloadTemp:function(){var e=document.createElement("a");e.href="/imporTemp/repairStandard.xls",e.download="维修标准.xls",e.click()},ComfirmImport:function(){var e=this,t=this.$refs.uploadFile.filename,a={base64:this.base64,fileName:t,fileType:"xls"};null==this.base64||0==this.base64.length?h["a"].alert("请选择导入的文件"):this.$Server.importFile(C.getModelName(),a).then((function(t){t.success&&null==t.datas.error?(h["a"].alert("导入成功","success"),e.$refs.uploadFile.clearFile(),e.IsShowImport=!1,e.initTable()):h["a"].alert(t.datas.error)}),(function(e){return h["a"].alert(e)}))},modalClosedImport:function(){this.IsShowImport=!1,this.$refs.uploadFile.clearFile()},import:function(){this.IsShowImport=!0},export:function(){this.$Server.exportFile(C.getModelName(),"维修标准"+this.$Utils.getLocalFotmatTime())},tableAdd:function(){this.resetForm(),this.IsAddOp=!0,this.initObject.standardDocumentList=[],this.detailForUpdate=JSON.parse(JSON.stringify(this.initObject)),this.title="添加维修标准",this.IsShow=!0},tableEdit:function(){var e=this;if(e.resetFormValidation(),e.IsAddOp=!1,e.title="编辑维修标准",1!=e.$refs.childDataTable.getCheckItems().length)h["a"].alert("请选择一项作为你修改的对象");else{var t=e.$refs.childDataTable.getCheckItems()[0];null==t.standardDocumentList&&(t.standardDocumentList=[]),e.detailForUpdate=JSON.parse(JSON.stringify(t)),e.IsShow=!0}},doSearch:function(){var e=this.$refs.childDataTable.getPagination();1==e.page?this.initTable(e):this.$refs.childDataTable.setPage(1)},clearMessage:function(){this.searchfx="",this.doSearch()},initTable:function(e){var t=this;e&&e.page||(e=t.$refs.childDataTable.getPagination()),t.$Server.queryAll(C.getModelName(),{page:e.page,rowsPerPage:e.rowsPerPage},{searchfx:t.searchfx}).then((function(e){t.$refs.childDataTable.unCheckItems(),t.DataSource=e.datas,t.DataSource.forEach((function(e){e.directoryID&&(e.directoryID=[e.directoryID])})),t.total=e.page.total}),(function(e){}))},modalComfirmed:function(){var e=this;1==e.$refs.addOrUpdate.validate()&&(e.detailForUpdate.directoryID&&(e.detailForUpdate.directoryID=e.detailForUpdate.directoryID[0]),e.$Server.addOrUpdate(C.getModelName(),e.detailForUpdate,!e.IsAddOp).then((function(t){t.success&&(e.IsShow=!1,e.initTable(),h["a"].alert("保存成功","success"))}),(function(e){h["a"].alert(e)})))},modalClosed:function(){this.IsShow=!1},resetFormValidation:function(){this.$refs.addOrUpdate.$refs.form.resetValidation()},resetForm:function(){this.$refs.addOrUpdate.$refs.form.reset(),this.$refs.addOrUpdate.$refs.form.resetValidation()},cofirmDelete:function(){var e=this,t=this.$refs.childDataTable.getCheckItems();e.$Server.batchDelete(C.getModelName(),t).then((function(){e.initTable()}),(function(e){h["a"].alert(e)}))},tableDelete:function(){var e=this;e.$refs.childDataTable.getCheckItems().length<=0?h["a"].alert("请选中需要删除的对象"):g["a"].confirm("确定删除所选维修标准?","提示",500,(function(){e.cofirmDelete()}),(function(){}))}}},q=N,U=Object(k["a"])(q,i,r,!1,null,null,null);t["default"]=U.exports}}]);