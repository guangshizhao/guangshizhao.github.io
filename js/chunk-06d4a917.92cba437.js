(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06d4a917"],{1228:function(e,t,i){},1367:function(e,t,i){"use strict";var r,n,o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[i("v-layout",[i("layContentLeft",{attrs:{title:e.treeTitle,id:"layoutLeft"}},[i("div",{staticStyle:{height:"calc(100% - 63px)"}},[i("div",{staticStyle:{margin:"0px 0px 0px 20px"},attrs:{id:"tree"}},[i("v-tree",{ref:"childTreeView",attrs:{data:e.treeSource,radio:!0},on:{"node-select":e.selectChanged}})],1)])]),i("layContentRight",[i("gridTemplate",{ref:"childGridTemplate",attrs:{title:e.gridTitle,gridModel:e.gridModel,sort:e.sort,initCondition:e.initCondition},on:{editorsReCode:e.editorsReCode,beforeEdit:e.beforeEdit,beforeAdd:e.beforeAdd,beforeEditSubmit:e.beforeEditSubmit,afterInit:e.afterGridInit,afterCommitSuccess:e.afterCommitSuccess,beforeCancel:e.beforeCancel,rowDbClick:e.rowDbClick}},[e._t("default")],2)],1)],1)],1)])},a=[],d=(i("7cfd"),i("3596")),l=i("b9da"),s=i("8333"),c=i("ff4f"),f=i("d5b3"),u={name:"gridwithTree",props:{gridModel:{type:Object,required:!0},treeModel:{type:Object,required:!0},treeTitle:{type:String,required:!0},gridTitle:{type:String,required:!0},sort:{type:Boolean,default:!1},initCondition:{type:Object}},mounted:function(){var e=this;document.addEventListener("click",(function(t){var i=document.getElementById("tree"),r=document.getElementById("layoutLeft");i&&!i.contains(t.target)&&r&&r.contains(t.target)&&e.$refs.childTreeView.nodeSelected({})}))},watch:{treeModel:{handler:function(e,t){r=new s["a"](e),this.treeInit()}},gridModel:{handler:function(e,t){n=new s["a"](e),this.treeInit()}}},data:function(){return{treeSource:[]}},components:{gridTemplate:l["a"],treeView:c["a"]},methods:{treeObj:function(e){var t={};for(var i in e){var r=e[i];null!=r&&(t[i]="object"===Object(d["a"])(r)?arguments.callee(r):r)}return t["children"]=[],t},setTree:function(e){for(var t=e,i=[],r=this,n=0;n<t.length;n++)""!==t[n].parentId&&null!==t[n].parentId&&"-1"!==t[n].parentId||(i.push(r.treeObj(t[n])),t.splice(n,1),n--);function o(e){if(0!==t.length)for(var i=0;i<e.length;i++){for(var n=0;n<t.length;n++)if(e[i].id===t[n].parentId){var a=r.treeObj(t[n]);e[i].children.push(a),t.splice(n,1),n--}o(e[i].children)}}return o(i),i},treeInit:function(){if(r&&n){var e=this;this.$Server.queryAll(r.getModelName(),null).then((function(t){for(var i=[],r=0;r<t.datas.length;r++){var n={};n.id=t.datas[r].id,n.title=t.datas[r].name,n.parentId=t.datas[r].parentId,n.expanded=!0,n.createdTime=t.datas[r].createdTime,n.description=t.datas[r].description,n.modifiedTime=t.datas[r].modifiedTime,n.oname=t.datas[r].oname,n.name=t.datas[r].name,n.orgCode=t.datas[r].orgCode,n.parentName=t.datas[r].parentName,n.rootNode=t.datas[r].rootNode,i.push(n)}e.treeSource=e.setTree(i),e.$emit("afterTreeInit",t.datas)}),(function(e){return f["a"].alert(e)}))}},selectChanged:function(e){var t=[];if(e){t.push(e.id);var i={};this.$emit("afterSelectChange",i,t),this.$refs.childGridTemplate.doSearch(i)}else this.$refs.childGridTemplate.init()},afterGridInit:function(e){this.$emit("afterGridInit",e)},editorsReCode:function(e){this.$emit("editorsReCode",e)},beforeEdit:function(e,t){this.$emit("beforeEdit",e,t)},beforeAdd:function(e){this.$emit("beforeAdd",e)},beforeEditSubmit:function(e){this.$emit("beforeEditSubmit",e)},GridAdd:function(){this.$refs.childGridTemplate.GridAdd()},GridEdit:function(){this.$refs.childGridTemplate.GridEdit()},GridDelete:function(){this.$refs.childGridTemplate.GridDelete()},getSelectedItems:function(){return this.$refs.childGridTemplate.getSelectedItems()},gridInit:function(e){this.$refs.childGridTemplate.doSearch(e)},afterCommitSuccess:function(){this.$emit("afterCommitSuccess")},beforeCancel:function(){this.$emit("beforeCancel")},rowDbClick:function(e){this.$emit("rowDbClick",e)}}},h=u,m=(i("f4119"),i("6691")),p=Object(m["a"])(h,o,a,!1,null,null,null);t["a"]=p.exports},d5f9:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("layContentHeader",{attrs:{title:"岗位管理",buttons:e.headerBtns,allowSearch:""}}),i("layContent",[i("gridWithTreeTemplate",{ref:"childGridWithTreeTemplate",attrs:{gridTitle:e.modelTittle,gridModel:e.position,treeTitle:"组织架构",treeModel:e.organization},on:{afterTreeInit:e.afterTreeInit,afterSelectChange:e.afterSelectChange,beforeEditSubmit:e.beforeEditSubmit,afterGridInit:e.afterGridInit,beforeEdit:e.beforeEdit,afterCommitSuccess:e.afterCommitSuccess}},[i("treeCombo",{attrs:{itemName:"name",label:"直属上级",Source:e.cPositions,independentSingleCheck:!0,independentCheck:!0},model:{value:e.PositionModelSelect,callback:function(t){e.PositionModelSelect=t},expression:"PositionModelSelect"}})],1)],1),i("contentModal",{attrs:{title:"导入岗位",IsShow:e.IsExportModelShow},on:{modalClosed:function(t){return e.hideExportWindow()},modalComfirmed:function(t){return e.ExportWindowConfirm()}}},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:e.downloadTemp}},[e._v("下载导入模板")]),i("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("\n        (注:文档内标题标红的列为必填项，请勿输入以下非法字符：~、@、$、^、&、《、》、<、>、￥)\n      ")])],1),i("div",[i("fileUploader",{ref:"uploadFile",attrs:{label:"请选择文件"},on:{formData:e.getFormData},model:{value:e.exportExcel,callback:function(t){e.exportExcel=t},expression:"exportExcel"}})],1)])],1)},n=[],o=(i("7cfd"),i("4634"),i("b9da"),i("1367")),a=i("a2a7"),d=i("55b3"),l=i("8333"),s=i("0909"),c=i("20d3"),f=i("d5b3"),u=i("f19a"),h=new l["a"](new s["a"]),m={name:"position",data:function(){var e=this;return{modelTittle:"岗位",organization:{},position:{},cannotEdit:!1,PositionModelSelect:[],Positions:[],cPositions:[],selectedOrgId:"",IsExportModelShow:!1,exportExcel:{},headerBtns:[{disabled:!this.$per("Position","c"),text:"添加",icon:"self_add",click:function(){return e.beforeAdd()}},{disabled:!this.$per("Position","u"),text:"编辑",icon:"self_edit",click:function(){return e.$refs.childGridWithTreeTemplate.GridEdit()}},{disabled:!this.$per("Position","d"),text:"删除",icon:"self_delete",click:function(){return e.$refs.childGridWithTreeTemplate.GridDelete()}},{disabled:!this.$per("Position","import"),text:"导入",icon:"self_import",click:function(){return e.showExportWindow()}},{disabled:!this.$per("Position","e"),text:"导出",icon:"self_export",click:function(){return e.exportFile()}}],total:1}},components:{gridWithTreeTemplate:o["a"],treeCombo:u["a"],contentModal:a["a"],fileUploader:d["a"]},mounted:function(){this.organization=new c["a"],this.position=new s["a"]},methods:{afterGridInit:function(e){e.forEach((function(e){e.positionSkillList&&e.positionSkillList.length>0?e.positionSkill=e.positionSkillList.map((function(e){return e.sname})).join():e.positionSkill=""}));var t=this;this.$Server.queryAll(h.getModelName()).then((function(e){t.Positions=e.datas}),(function(e){return f["a"].alert(e)}))},afterSelectChange:function(e,t){this.selectedOrgId=e["orgId"]=t[0]},afterTreeInit:function(e){},editorsReCode:function(e){},beforeEdit:function(e,t){this.PositionModelSelect=[t.parentId],e.orgId=t.orgId;var i=this.Positions.filter((function(e){return e.parentId==t.id})).length>0;if(this.cPositions=[],i){var r=[];this.findfathers(t,this.Positions,r);var n=this.Positions.filter((function(e){return"-1"==e.parentId&&e.id!=t.id}));r=r.concat(n);for(var o=[],a=0;a<r.length;a++){for(var d=a+1;d<r.length;d++)r[a]===r[d]&&++a;r[a].name=r[a].fullName,o.push(r[a])}this.cPositions=o}else{var l=this.Positions.filter((function(e){return e.id!=t.id}));l.forEach((function(e){e.name=e.fullName})),this.cPositions=l}},beforeAdd:function(e){var t=JSON.parse(JSON.stringify(this.Positions));t&&t.length>0&&t.forEach((function(e){e.name=e.fullName})),this.cPositions=t,this.PositionModelSelect=[],""==this.selectedOrgId?f["a"].alert("请选择一个组织架构"):this.$refs.childGridWithTreeTemplate.GridAdd()},beforeEditSubmit:function(e){e.parentId=this.PositionModelSelect[0],void 0==e.orgId&&(e.orgId=this.selectedOrgId)},confirmDelet:function(){},afterCommitSuccess:function(){this.PositionModelSelect={}},findfathers:function(e,t,i){var r=this,n=t.filter((function(t){return t.id==e.parentId}));n.forEach((function(e){r.findfathers(e,t,i),i.push(e)}))},exportFile:function(){this.$Server.exportFile(h.getModelName(),"岗位管理"+this.$Utils.getLocalFotmatTime())},hideExportWindow:function(){this.$refs.uploadFile.clearFile(),this.IsExportModelShow=!1},ExportWindowConfirm:function(){var e=this,t=this.$refs.uploadFile.filename,i={base64:this.exportExcel,fileName:t,fileType:"xls"};this.$Server.importFile(h.getModelName(),i).then((function(t){t.success?(f["a"].alert("导入成功","success"),e.$refs.uploadFile.clearFile(),e.IsExportModelShow=!1,e.$refs.childGridWithTreeTemplate.gridInit()):f["a"].alert(t.datas.error)}),(function(e){return f["a"].alert(e)}))},downloadTemp:function(){var e=document.createElement("a");e.href="/imporTemp/position.xls",e.download="岗位管理.xls",e.click()},showExportWindow:function(){this.IsExportModelShow=!0},getFormData:function(e){var t=this,i=e.get("data");if(i){var r=i.name.substring(i.name.lastIndexOf(".")+1,i.name.length);"xls"!=r&&"xlsx"!=r&&(f["a"].alert("请检查文件是否为Excel文件"),t.$refs.uploadFile.clearFile())}}}},p=m,g=i("6691"),b=Object(g["a"])(p,r,n,!1,null,null,null);t["default"]=b.exports},f4119:function(e,t,i){"use strict";var r=i("1228"),n=i.n(r);n.a}}]);