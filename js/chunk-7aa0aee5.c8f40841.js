(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7aa0aee5"],{6696:function(e,t,i){"use strict";var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-text-field",{ref:"fileTextField",attrs:{"prepend-icon":"attach_file","single-line":"",label:e.label,required:e.required,disabled:e.disabled},nativeOn:{click:function(t){return e.onFocus(t)}},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),i("input",{ref:"fileInput",attrs:{type:"file",accept:e.accept,name:e.name,multiple:e.multiple,disabled:e.disabled},on:{change:e.onFileChange}})],1)},a=[],r=(i("e6d1"),i("7cfd"),i("dea4")),o=(i("4634"),{props:{value:{type:[Array,String]},accept:{type:String,default:"*"},label:{type:String,default:"Please choose..."},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},name:{type:String,default:"files"}},data:function(){return{filename:""}},watch:{value:function(e){this.filename=e}},mounted:function(){this.filename=this.value},methods:{getFormData:function(e){var t=new FormData;return Object(r["a"])(e).forEach((function(e){t.append("data",e,e.name)})),t},onFocus:function(){this.disabled||this.$refs.fileInput.click()},onFileChange:function(e){var t=e.target.files||e.dataTransfer.files,i=this.getFormData(t);t?t.length>0?this.filename=Object(r["a"])(t).map((function(e){return e.name})).join(", "):this.filename=null:this.filename=e.target.value.split("\\").pop(),this.$emit("input",this.filename),this.$emit("formData",i)},clearFile:function(){this.filename="",this.$refs.fileInput.value=""}}}),n=o,d=(i("904b"),i("6691")),s=Object(d["a"])(n,l,a,!1,null,"40907837",null);t["a"]=s.exports},"71ba":function(e,t,i){"use strict";var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{attrs:{"grid-list-md":""}},[i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-layout",{attrs:{wrap:"",row:""}},e._l(e.editors,(function(t){return i("v-flex",{key:t.field,class:t.colspan?t.colspan:"md6",attrs:{xs12:""}},["imageField"==t.fieldType?i("div",[i("uploadInput",{ref:"uploadInput",refInFor:!0,attrs:{disabled:t.disable,btnName:t.fieldName},model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}})],1):e._e(),"charField"==t.fieldType?i("div",[i("v-text-field",{attrs:{disabled:t.disable,label:t.fieldName,rules:e.getRules(t.rules,t.require)},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                            "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}})],1):e._e(),"boolField"==t.fieldType?i("v-radio-group",{attrs:{row:"",label:t.fieldName,disabled:t.disable},model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}},e._l(e.boolSelectField[t.field],(function(e){return i("v-radio",{key:e.dvalue,attrs:{label:e.dname,value:e}})})),1):e._e(),"manyToManyField"==t.fieldType?i("v-select",{attrs:{items:e.selectSources[t.field],multiple:"","single-line":"",clearable:"",label:t.fieldName,rules:[function(e){return!t.require||""!=e||"必填项"}],disabled:t.disable},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                        "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0},{key:"selection",fn:function(l){return[i("v-chip",{attrs:{selected:l.selected,close:""},on:{input:function(i){return e.removeSelected(e.showItem[t.field],l.item)}}},[e._v("\n                            "+e._s(l.item.text)+"\n                        ")])]}}],null,!0),model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"dateField"==t.fieldType?i("v-datetime-picker",{attrs:{label:t.fieldName,clearText:"",okText:"确定",model:"String",rules:[function(e){return!t.require||!!e||"必填项"}],prependIcon:t.require?"glyphicon-asterisk":""},on:{input:e.input},model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"numberField"==t.fieldType&&"float"==t.type?i("v-text-field",{attrs:{label:t.fieldName,type:"number",disabled:t.disable,rules:[function(e){return!t.require||!!e||"必填项"},function(e){return!e||/^[\+\-]?\d*?\.?\d*?$/.test(e)||"只能是数字或者小数！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                        "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"numberField"==t.fieldType&&"int"==t.type?i("v-text-field",{attrs:{label:t.fieldName,disabled:t.disable,type:"number",rules:[function(e){return!t.require||!!e||"必填项"},function(e){return!e||/^(0|[1-9][0-9]*)$/.test(e)||"只能是正整数"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                    "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"comboboxField"==t.fieldType&&null!=t.model&&"Datadict"!=t.model.__name?i("v-select",{attrs:{items:e.dataDictSource[t.field],label:t.fieldName,"item-value":"value","item-text":"text",clearable:"",disabled:t.disable,rules:[function(e){return!t.require||e&&!!e||""==e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                    "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"comboboxField"==t.fieldType&&null!=t.model&&"Datadict"==t.model.__name?i("v-select",{attrs:{items:e.dataDictSource[t.field],label:t.fieldName,"return-object":"","item-text":"dname",clearable:"",disabled:t.disable,rules:[function(e){return!t.require||e&&!!e||""==e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                    "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"comboboxField"==t.fieldType&&null==t.model?i("v-select",{attrs:{items:t.comboboxSelect,label:t.fieldName,"item-value":"id","item-text":"name",clearable:"",disabled:t.disable,rules:[function(e){return!t.require||e&&!!e||""==e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                    "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"fileField"==t.fieldType?i("upload-file",{ref:"uploadFile",refInFor:!0,attrs:{label:t.fieldName,uploadBase64:!1,fileNames:e.showItem[t.field]?e.showItem[t.field].dname:""},on:{formData:e.getFormData},model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"comboTree"==t.fieldType&&null!=t.model&&"oneToMany"==t.related?i("treeCombo",{ref:"treeCombo1",refInFor:!0,attrs:{require:t.require,Source:e.dataDictSource[t.field],MultipleSelect:!1,label:t.fieldName,disabled:t.disable,independentCheck:!1,"return-object":""},model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e(),"comboTree"==t.fieldType&&null!=t.model&&"oneToOne"==t.related?i("treeCombo",{ref:"treeCombo",refInFor:!0,attrs:{require:t.require,Source:e.dataDictSource[t.field],MultipleSelect:!1,label:t.fieldName,disabled:t.disable,independentCheck:!1,independentSingleCheck:!0,rules:[function(e){return!t.require||e&&!!e||""==e||"必填项"}],"return-object":""},model:{value:e.showItem[t.field],callback:function(i){e.$set(e.showItem,t.field,i)},expression:"showItem[editor.field]"}}):e._e()],1)})),1),e._t("default")],2)],1)},a=[],r=(i("7cfd"),i("dea4")),o=(i("4634"),i("8333")),n=i("b27e"),d=(i("6696"),i("55b3")),s=i("f19a"),c=i("a7fe"),u=i("d5b3"),f=i("6e6d"),m=i("431e");i("8bad");f["default"].use(m["a"]);var h={name:"formTemplate",data:function(){return{valid:!0,editedStr:{},selectSources:{},showItem:{},dataDictSource:{},dataList:[{id:0,name:"F类"},{id:1,name:"M类"},{id:2,name:"R类"}],boolSelectField:{}}},components:{UploadFile:d["a"],uploadInput:n["a"],treeCombo:s["a"]},watch:{editedItem:{handler:function(e){for(var t in this.showItem={},e)this.showItem[t]=e[t]},deep:!0},editors:{handler:function(e){var t=this;e.forEach((function(e){if("manyToManyField"==e.fieldType){var i=new o["a"](e.model);t.$Server.queryAll(i.getModelName(),null,e.bindSource.parms).then((function(i){var l=i.datas.map((function(t){return{text:t[e.bindSource.text],value:t[e.bindSource.value]}}));t.$set(t.selectSources,e.field,l)}),(function(e){return u["a"].alert(e)}))}if("comboboxField"==e.fieldType&&null!=e.model&&"Datadict"!=e.model.__name){var l=new o["a"](e.model);t.$Server.queryAll(l.getModelName(),null,e.bindSource.parms).then((function(i){var l=i.datas.map((function(t){return{text:t[e.bindSource.text],value:t[e.bindSource.value]}}));t.$set(t.dataDictSource,e.field,l),t.$emit("selectEdit",e.model)}))}if("comboboxField"==e.fieldType&&null!=e.model&&"Datadict"==e.model.__name){var a=new o["a"](e.model);t.$Server.queryAll(a.getModelName(),null,e.bindSource.parms).then((function(i){t.$set(t.dataDictSource,e.field,i.datas),t.$emit("selectEdit",e.model)}))}if("comboTree"==e.fieldType&&null!=e.model){var r=new o["a"](e.model);t.$Server.queryAll(r.getModelName(),null,{}).then((function(i){t.$set(t.dataDictSource,e.field,i.datas)}))}if("boolField"==e.fieldType){var n=new o["a"](new c["a"]);t.$Server.queryAll(n.getModelName(),{},e.parms?e.parms:"").then((function(i){t.$set(t.boolSelectField,e.field,i.datas)}))}}))},deep:!0}},props:{editors:{type:Array,required:!0},editedItem:{type:Object,required:!0}},methods:{getRules:function(e,t){return e||(t?[function(e){return e&&""!=e||"必填项"}]:void 0)},removeSelected:function(e,t){e.splice(e.indexOf(t.id),1),e=Object(r["a"])(e)},input:function(){var e=this.showItem;this.showItem={},this.showItem=e},dateFormatted:function(e){var t="";try{t=new Date(e).toISOString().substr(0,10)}catch(i){t=""}return t},editedItemChang:function(e){this.$set(this.editedStr,e,this.showItem[e])},getValues:function(){return this.showItem},getValid:function(){return this.$refs.form.validate()},resetValid:function(){this.$refs.form.resetValidation()},resetForm:function(){},getFormData:function(e){var t=this,i=e.get("data");if(i){var l=i.name.substring(i.name.lastIndexOf(".")+1,i.name.length);"docx"!=l&&"doc"!=l&&(u["a"].alert("请检查文件是否为doc文件"),t.$refs.uploadFile[0].clearFile())}}}},p=h,b=(i("a8c3"),i("6691")),v=Object(b["a"])(p,l,a,!1,null,"b58db9d4",null);t["a"]=v.exports},"7db8":function(e,t,i){},"8bad":function(e,t,i){},"904b":function(e,t,i){"use strict";var l=i("7db8"),a=i.n(l);a.a},"94ff":function(e,t,i){},a8c3:function(e,t,i){"use strict";var l=i("94ff"),a=i.n(l);a.a},b9da:function(e,t,i){"use strict";var l,a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,sort:e.sort,DataSource:e.DataSource,hideOperation:!0,formatFields:e.FormatFields,total:e.total},on:{rowDbClick:e.rowDbClick,initialize:e.init}}),i("contentModal",{attrs:{title:e.title1,IsShow:e.IsShow,width:e.width},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[i("formTemplate",{ref:"childForm",attrs:{editors:e.editors,editedItem:e.editedItem}},[e._t("default")],2)],1),i("comfirmModal",{attrs:{title:"提示",IsShow:e.IsComfirmShow,text:e.deleteTittle},on:{modalComfirmedClose:function(t){return e.modalComfirmedClose()},modalComfirmed:function(t){return e.cofirmDelete()}}})],1)},r=[],o=(i("ed8b"),i("4634"),i("de90"),i("8f42"),i("a2a7")),n=i("23f5"),d=i("71ba"),s=i("f05f"),c=i("8333"),u=i("d5b3"),f={name:"gridTemplate",props:{gridModel:{type:Object,required:!0},title:{type:String,required:!0},sort:{type:Boolean,default:!1},width:{type:Number},initCondition:{type:Object}},data:function(){return{valid:!0,IsShow:!1,IsComfirmShow:!1,IsLoading:!0,editors:[],totalDatas:0,total:1,DataSource:[],headers:[],editedItem:{},search:"",deletItems:[],FormatFields:{},currentparams:{},isAddOrUpdate:!0,title1:"",deleteTittle:"",likeParent:{}}},components:{contentModal:o["a"],comfirmModal:n["a"],dataTable:s["a"],formTemplate:d["a"]},watch:{gridModel:{handler:function(e){l=new c["a"](e),this.headers=l.formatGridHeader(),!0===this.sort&&this.headers.unshift({text:"序号",align:"center",sortable:!1});var t=l.getEditFields();t.sort((function(e,t){var i=0;return e.formOrder<t.formOrder&&(i=-1),e.formOrder>t.formOrder&&(i=1),i})),this.editors=t,this.$emit("editorsReCode",t),this.FormatFields=l.getFormatFields()}}},methods:{init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;null!=e.page&&(this.currentparams=e);var i=this.currentparams,a=i.page,r=i.rowsPerPage;t.initCondition&&Object.keys(t.initCondition).forEach((function(e){t.likeParent[e]=t.initCondition[e]})),this.$Server.queryAll(l.getModelName(),{page:a,rowsPerPage:r},t.likeParent).then((function(e){t.DataSource=e.datas,t.total=e.page.total,t.$emit("afterInit",t.DataSource),null!=t.$refs.childDataTable.getCheckItems()&&t.$refs.childDataTable.getCheckItems().length>0&&t.$refs.childDataTable.unCheckItems()}),(function(e){return u["a"].alert(e)}))},doSearch:function(e){this.likeParent=e;var t=this.currentparams.page;1==t?this.init():this.$refs.childDataTable.setPage(1)},getPages:function(e){this.params=e},rowDbClick:function(e){this.$emit("rowDbClick",e)},GridDelete:function(){this.$refs.childDataTable.getCheckItems().length<=0?u["a"].alert("请选中需要删除的项"):(this.deleteTittle="确定删除所选"+this.title+"?",this.IsComfirmShow=!0)},getSelectedItems:function(){return this.$refs.childDataTable.getCheckItems()},unCheckItems:function(){return this.$refs.childDataTable.unCheckItems()},cofirmDelete:function(){var e=this.getSelectedItems();this.$emit("beforeExcuteDelete",e);var t=this;this.$Server.batchDelete(l.getModelName(),e).then((function(){t.IsComfirmShow=!1,t.init(t.currentparams)}),(function(e){t.IsComfirmShow=!1,u["a"].alert(e)}))},resetValid:function(){this.$refs.childForm.resetValid()},GridAdd:function(){this.editedItem={},this.$emit("beforeAdd",this.editedItem),this.IsShow=!0,this.$refs.childForm.resetValid(),this.$refs.childForm.resetForm(),this.title1="添加"+this.title},GridEdit:function(){var e=this;if(e.title1="编辑"+e.title,1!=e.$refs.childDataTable.getCheckItems().length)u["a"].alert("请选择一项作为你修改的对象");else{e.editedItem={};var t=e.$refs.childDataTable.getCheckItems()[0],i=t.id,l=t.createTime,a=t.updateTime,r=t.creator,o=t.modifier;e.editedItem={id:i,createTime:l,updateTime:a,creator:r,modifier:o},e.editors.forEach((function(i){i.field&&(e.editedItem[i.field]=t[i.field])})),e.$refs.childForm.resetValid(),e.$emit("beforeEdit",e.editedItem,t),e.IsShow=!0}},modalClosed:function(){this.$emit("beforeCancel"),this.IsShow=!1},modalComfirmed:function(){var e=this,t=this.$refs.childForm.getValues();this.$emit("beforeEditSubmit",t),0==this.$refs.childForm.getValid()?u["a"].alert("验证不通过"):e.isAddOrUpdate&&(e.isAddOrUpdate=!1,e.$Server.addOrUpdate(l.getModelName(),t,t.id).then((function(i){i.success&&(e.IsShow=!1,t.id&&(e.$refs.childDataTable.unCheckItems(),e.$refs.childDataTable.setCheckItems(t)),e.init(e.currentparams),u["a"].alert("保存成功","success"),e.$emit("afterCommitSuccess"),e.isAddOrUpdate=!0)}),(function(t){u["a"].alert(t),e.isAddOrUpdate=!0})))},modalComfirmedClose:function(){this.IsComfirmShow=!1},getCheckItems:function(){return this.$refs.childDataTable.getCheckItems()}}},m=f,h=i("6691"),p=Object(h["a"])(m,a,r,!1,null,null,null);t["a"]=p.exports}}]);