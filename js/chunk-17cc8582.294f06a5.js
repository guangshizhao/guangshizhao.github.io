(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17cc8582"],{"0464":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a("7300"),n=a("5873"),r=a("ddf2"),l=a("80ea"),o=a("ae0a"),c=a("97a3"),s=a("652a"),d=a("1269"),u=a("20d3"),m=new s["a"],f=function(e){function t(){var e,a;Object(i["a"])(this,t);for(var o=arguments.length,s=new Array(o),d=0;d<o;d++)s[d]=arguments[d];return a=Object(n["a"])(this,(e=Object(r["a"])(t)).call.apply(e,[this].concat(s))),Object(c["a"])(Object(l["a"])(a),"__name","MeteringEquipment"),Object(c["a"])(Object(l["a"])(a),"code",m.charField({require:!1,fieldName:"仪器编号",icon:"star",tableOrder:10,formOrder:10,rules:[function(e){return!e||/^[\w|-]+$/.test(e)||"只能是数字,字母,下划线"}]})),Object(c["a"])(Object(l["a"])(a),"name",m.charField({require:!0,fieldName:"仪器名称",icon:"star",tableOrder:20,formOrder:20})),Object(c["a"])(Object(l["a"])(a),"model",m.charField({require:!1,fieldName:"规格型号",icon:"star",tableOrder:30,formOrder:30})),Object(c["a"])(Object(l["a"])(a),"departmentName",m.charField({require:!1,fieldName:"所属部门",icon:"star",editable:!1,tableOrder:40})),Object(c["a"])(Object(l["a"])(a),"usedDepartmentName",m.charField({require:!1,visible:!1,fieldName:"使用部门",icon:"star",editable:!1,tableOrder:50})),Object(c["a"])(Object(l["a"])(a),"departmentID",m.comboTree(u["a"],{require:!1,fieldName:"所属部门",related:"oneToOne",formOrder:50})),Object(c["a"])(Object(l["a"])(a),"type",m.boolField({require:!0,fieldName:"校准类型",editable:!1,tableOrder:51,icon:"star",boolSelect:[],parms:{dname:"校准标准"},format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),Object(c["a"])(Object(l["a"])(a),"usedDepartmentID",m.comboTree(u["a"],{require:!1,visible:!1,formOrder:60,fieldName:"使用部门",related:"oneToOne"})),Object(c["a"])(Object(l["a"])(a),"usedPart",m.charField({require:!1,fieldName:"使用位置",formOrder:40,icon:"star",visible:!1,tableOrder:60})),Object(c["a"])(Object(l["a"])(a),"periodData",m.charField({require:!0,fieldName:"校准周期",editable:!1,icon:"star",tableOrder:70})),Object(c["a"])(Object(l["a"])(a),"lastCalibrationDate",m.dateField({require:!0,visible:!0,fieldName:"上次校准时间",editable:!1,format:function(e){if(e)return e.substring(0,10)}})),Object(c["a"])(Object(l["a"])(a),"nextCalibrationDate",m.dateField({require:!0,fieldName:"下次校准时间",editable:!1,tableOrder:80,format:function(e){if(e)return e.substring(0,10)}})),Object(c["a"])(Object(l["a"])(a),"period",m.charField({require:!0,visible:!1,editable:!1,fieldName:"校准时间",icon:"star"})),Object(c["a"])(Object(l["a"])(a),"periodUnit",m.boolField({require:!0,visible:!1,editable:!1,fieldName:"周期单位",icon:"star",boolSelect:[],parms:{dname:"周期单位"},format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),Object(c["a"])(Object(l["a"])(a),"meteringStandardName",m.charField({require:!1,visible:!1,fieldName:"计量标准",icon:"star",editable:!1,tableOrder:90})),Object(c["a"])(Object(l["a"])(a),"meteringStandardVersion",m.charField({require:!1,visible:!1,fieldName:"计量标准版本",icon:"star",editable:!1})),Object(c["a"])(Object(l["a"])(a),"meteringStandardVM",m.charField({require:!1,visible:!1,fieldName:"计量标准",icon:"star",editable:!1})),Object(c["a"])(Object(l["a"])(a),"calibrationReportVM",m.charField({require:!1,visible:!1,fieldName:"校准报告",icon:"star",editable:!1})),Object(c["a"])(Object(l["a"])(a),"calibrationReportName",m.charField({require:!1,visible:!1,fieldName:"校准报告",icon:"star",editable:!1,tableOrder:100})),Object(c["a"])(Object(l["a"])(a),"calibrationReportVName",m.charField({require:!1,visible:!1,fieldName:"校准报告文件名称",icon:"star",editable:!1})),Object(c["a"])(Object(l["a"])(a),"meteringStandardVName",m.charField({require:!1,visible:!1,fieldName:"计量标准文件名称",icon:"star",editable:!1})),Object(c["a"])(Object(l["a"])(a),"calibrationReportVersion",m.charField({require:!1,visible:!1,fieldName:"校准报告版本",icon:"star",editable:!1})),a}return Object(o["a"])(t,e),t}(d["a"])},"0583":function(e,t,a){},2907:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("layContentHeader",{attrs:{buttons:e.docuVersionHeaderBtns}}),a("layContent",[a("v-layout",[a("layContentRight",[a("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,DataSource:e.DocumentversionDataSource,allowActive:!1,total:e.DocumentversionTotalDatas,hideOperation:!0}})],1)],1)],1)],1)},n=[],r=(a("e6d1"),a("b013")),l=a("7300"),o=a("5873"),c=a("ddf2"),s=a("80ea"),d=a("ae0a"),u=a("97a3"),m=a("652a"),f=a("1269"),h=new m["a"],p=function(e){function t(){var e,a;Object(l["a"])(this,t);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return a=Object(o["a"])(this,(e=Object(c["a"])(t)).call.apply(e,[this].concat(n))),Object(u["a"])(Object(s["a"])(a),"__name","Documentversion"),Object(u["a"])(Object(s["a"])(a),"fileName",h.charField({require:!0,fieldName:"文档名称"})),Object(u["a"])(Object(s["a"])(a),"creatorName",h.charField({require:!0,fieldName:"上传人"})),Object(u["a"])(Object(s["a"])(a),"description",h.charField({require:!0,fieldName:"描述"})),Object(u["a"])(Object(s["a"])(a),"version",h.charField({require:!0,fieldName:"版本"})),Object(u["a"])(Object(s["a"])(a),"documentId",h.charField({require:!0,fieldName:"文档id",visible:!1})),Object(u["a"])(Object(s["a"])(a),"filePath",h.charField({require:!0,fieldName:"文件路径",visible:!1})),Object(u["a"])(Object(s["a"])(a),"fileExt",h.charField({require:!0,fieldName:"文件后缀",visible:!1})),Object(u["a"])(Object(s["a"])(a),"fileSize",h.charField({require:!0,fieldName:"文件大小",visible:!1})),Object(u["a"])(Object(s["a"])(a),"creatorLoginName",h.charField({require:!0,fieldName:"上传人工号",visible:!1})),a}return Object(d["a"])(t,e),t}(f["a"]),b=a("8333"),v=a("f05f"),g=a("1e17"),w=a("07c5"),O=a("adf0"),y=a("d5b3"),D=new b["a"](new p),S={name:"documentVersion",components:{dataTable:v["a"],layContent:g["a"],layContentHeader:w["a"],layContentRight:O["a"]},data:function(){var e=this;return{docuVersionHeaderBtns:[{text:"下载",icon:"self_download",click:function(){return e.downloadDV()}},{text:"查看",icon:"self_see",click:function(){return e.preViewDV()}}],IsShow:!1,IsComfirmShow:!1,IsLoading:!0,DocumentversionDataSource:[],DocumentversionTotalDatas:1,temporary:{},documentVersionServer:{},headers:[{text:"文档名称",value:"fileName",align:"center",sortable:!1},{text:"上传人",value:"creatorName",align:"center",sortable:!1},{text:"描述",value:"description",align:"center",sortable:!1},{text:"创建日期",value:"createdTime",align:"center",sortable:!1},{text:"版本",value:"userVersion",align:"center",sortable:!1}]}},mounted:function(){this._documentVersionServer=new r["a"],this.initialize()},methods:{initialize:function(e){var t=this;e&&this.$Server.queryAll(D.getModelName(),this.$refs.childDataTable.getPagination(),{documentId:e}).then((function(e){t.$refs.childDataTable.unCheckItems(),t.DocumentversionDataSource=e.datas,t.DocumentversionTotalDatas=e.page.total}),(function(e){return y["a"].alert(e)}))},downloadDV:function(){var e=this.$refs.childDataTable.getCheckItems();if(null!=e&&1==e.length){var t=e[0],a=document.createElement("a");a.href=t.filePath;var i=t.filePath.split("/");a.download=i[i.length-1],a.click()}else y["a"].alert("请选择一个需要下载的文档！")},preViewDV:function(){var e=this.$refs.childDataTable.getCheckItems();if(null!=e&&1==e.length){var t=e[0];t&&t.id?this.$emit("preView",t.fileExt,t.filePath,t.fileSize):y["a"].alert("没有获取到该数据的文档信息！")}else y["a"].alert("请选择需要查看的文档！")}}},j=S,x=a("6691"),F=Object(x["a"])(j,i,n,!1,null,"23795565",null);t["a"]=F.exports},"5cbc":function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a("7300"),n=a("5873"),r=a("ddf2"),l=a("80ea"),o=a("ae0a"),c=a("97a3"),s=a("652a"),d=a("1269"),u=new s["a"],m=function(e){function t(){var e,a;Object(i["a"])(this,t);for(var o=arguments.length,s=new Array(o),d=0;d<o;d++)s[d]=arguments[d];return a=Object(n["a"])(this,(e=Object(r["a"])(t)).call.apply(e,[this].concat(s))),Object(c["a"])(Object(l["a"])(a),"__name","Document"),Object(c["a"])(Object(l["a"])(a),"docuCode",u.charField({require:!0,fieldName:"文档编号"})),Object(c["a"])(Object(l["a"])(a),"dname",u.charField({require:!0,fieldName:"文档名称"})),Object(c["a"])(Object(l["a"])(a),"creatorName",u.charField({require:!0,fieldName:"上传人"})),Object(c["a"])(Object(l["a"])(a),"docuDescription",u.charField({require:!0,fieldName:"描述"})),Object(c["a"])(Object(l["a"])(a),"newestDate",u.charField({require:!0,fieldName:"最后更新日期"})),Object(c["a"])(Object(l["a"])(a),"newestVersion",u.charField({require:!0,fieldName:"最新版本"})),Object(c["a"])(Object(l["a"])(a),"category",u.charField({require:!0,fieldName:"类别",visible:!1})),Object(c["a"])(Object(l["a"])(a),"creatorLoginName",u.charField({require:!0,fieldName:"上传人工号",visible:!1})),Object(c["a"])(Object(l["a"])(a),"newestFileId",u.charField({require:!0,fieldName:"最新文件id",visible:!1})),Object(c["a"])(Object(l["a"])(a),"newestFileExt",u.charField({require:!0,fieldName:"最新文件后缀",visible:!1})),Object(c["a"])(Object(l["a"])(a),"newestFilePath",u.charField({require:!0,fieldName:"最新文件路径",visible:!1})),Object(c["a"])(Object(l["a"])(a),"newestFileSize",u.charField({require:!0,fieldName:"最新文件大小",visible:!1})),Object(c["a"])(Object(l["a"])(a),"docuFile",u.charField({require:!0,fieldName:"最新文件流",visible:!1})),a}return Object(o["a"])(t,e),t}(d["a"])},6696:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-text-field",{ref:"fileTextField",attrs:{"prepend-icon":"attach_file","single-line":"",label:e.label,required:e.required,disabled:e.disabled},nativeOn:{click:function(t){return e.onFocus(t)}},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),a("input",{ref:"fileInput",attrs:{type:"file",accept:e.accept,name:e.name,multiple:e.multiple,disabled:e.disabled},on:{change:e.onFileChange}})],1)},n=[],r=(a("e6d1"),a("7cfd"),a("dea4")),l=(a("4634"),{props:{value:{type:[Array,String]},accept:{type:String,default:"*"},label:{type:String,default:"Please choose..."},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},name:{type:String,default:"files"}},data:function(){return{filename:""}},watch:{value:function(e){this.filename=e}},mounted:function(){this.filename=this.value},methods:{getFormData:function(e){var t=new FormData;return Object(r["a"])(e).forEach((function(e){t.append("data",e,e.name)})),t},onFocus:function(){this.disabled||this.$refs.fileInput.click()},onFileChange:function(e){var t=e.target.files||e.dataTransfer.files,a=this.getFormData(t);t?t.length>0?this.filename=Object(r["a"])(t).map((function(e){return e.name})).join(", "):this.filename=null:this.filename=e.target.value.split("\\").pop(),this.$emit("input",this.filename),this.$emit("formData",a)},clearFile:function(){this.filename="",this.$refs.fileInput.value=""}}}),o=l,c=(a("904b"),a("6691")),s=Object(c["a"])(o,i,n,!1,null,"40907837",null);t["a"]=s.exports},7100:function(e,t,a){},"7db8":function(e,t,a){},"904b":function(e,t,a){"use strict";var i=a("7db8"),n=a.n(i);n.a},b013:function(e,t,a){"use strict";var i=a("7300"),n=a("e9e3"),r=a("5873"),l=a("ddf2"),o=a("ae0a"),c=a("b490"),s=a("f753"),d=a.n(s),u=a("531b"),m=function(e){function t(){return Object(i["a"])(this,t),Object(r["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(o["a"])(t,e),Object(n["a"])(t,[{key:"uploadDocument",value:function(e,a,i){return new Promise((function(n,r){var l=new t;l&&(i.progressShow=!0,d.a.put(l.apiUrl+"/"+a+"?t="+Date.now(),e,{onUploadProgress:function(e){i.progressValue=parseInt(Math.round(100*e.loaded/e.total))}}).then((function(e){e.data.code?r(e.msg):n(e.data),i.progressShow=!1})).catch((function(e){r(e.message)})))}))}},{key:"downloadDocument",value:function(e){var a=new t;if(a){var i=document.createElement("a");i.style.display="none",i.href=a.apiUrl+"/Documentversion/"+e+"?t="+Date.now(),i.setAttribute("download",""),document.body.appendChild(i),i.click()}}},{key:"validateFileName",value:function(e,a){var i=new t;return new Promise((function(t,n){var r=i.apiUrl+"/"+e+"/"+a+"?t="+Date.now();u["a"].http(r,"GET",null,{success:function(e){t(e.data)},error:function(e){n(e.msg)}})}))}},{key:"getBase64",value:function(e){return new Promise((function(t,a){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return a(e)}}))}}]),t}(c["a"]);t["a"]=m},ccc7:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("layContent",[a("layContentHeader",{attrs:{title:"文档管理",buttons:e.headerBtns}},[a("div",{staticStyle:{display:"inline-block"}},[a("v-text-field",{staticStyle:{width:"350px"},attrs:{label:"请输入文档编号或文档名称或上传人","hide-details":"","single-line":"",clearable:""},on:{"click:clear":e.clearMessage},scopedSlots:e._u([{key:"append-outer",fn:function(){return[a("v-icon",{on:{click:function(t){return e.searchTextChange()}}},[e._v("search")])]},proxy:!0}]),model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),a("div",{staticStyle:{display:"inline-block","vertical-align":"middle","margin-top":"-18px"}},[a("v-btn",{attrs:{small:"",flat:""},on:{click:e.advanced}},[e._v("高级搜索")])],1)]),e.showAdvance?a("v-layout",{attrs:{row:""}},[a("v-text-field",{attrs:{label:"文档编号",clearable:""},model:{value:e.dcode,callback:function(t){e.dcode=t},expression:"dcode"}}),a("v-text-field",{attrs:{label:"文档名称",clearable:""},model:{value:e.dname,callback:function(t){e.dname=t},expression:"dname"}}),a("v-select",{attrs:{"item-text":"module","item-value":"module",label:"所属模块",items:e.dModuleData,clearable:""},model:{value:e.dModule,callback:function(t){e.dModule=t},expression:"dModule"}}),a("v-select",{attrs:{"item-text":"name","item-value":"id",label:"设备",items:e.docSource,clearable:"","return-object":""},model:{value:e.sourceitem,callback:function(t){e.sourceitem=t},expression:"sourceitem"}}),a("v-select",{attrs:{label:"上传人",items:e.userList,"item-text":"uname","item-value":"uname"},model:{value:e.dperson,callback:function(t){e.dperson=t},expression:"dperson"}}),a("v-layout",[a("p",{staticStyle:{"font-size":"16px",width:"100px","text-align":"center","margin-bottom":"5px","margin-top":"20px"}},[e._v("\n          更新时间：\n        ")]),a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","min-width":"100px","full-width":""},model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-text-field",{attrs:{slot:"activator","prepend-icon":"event",readonly:"",clearable:""},slot:"activator",model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}}),a("v-date-picker",{attrs:{locale:"zh-cn",dayFormat:e.dayFormat},on:{change:function(t){e.menu=!1}},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1),a("p",{staticStyle:{width:"60px","font-size":"16px","text-align":"center","margin-top":"20px"}},[e._v("到")]),a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","full-width":"","min-width":"100px"},model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[a("v-text-field",{attrs:{slot:"activator","prepend-icon":"event",readonly:"",clearable:""},slot:"activator",model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}}),a("v-date-picker",{attrs:{locale:"zh-cn",dayFormat:e.dayFormat},on:{change:function(t){e.menu2=!1}},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1),a("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:function(t){return e.gridSearch()}}},[e._v("搜索")]),a("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:function(t){return e.clearSearch()}}},[e._v("清空搜索")])],1)],1):e._e(),a("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,search:e.search,DataSource:e.DataSource,total:e.totalDatas,sort:!0,hideOperation:!0},on:{rowDbClick:e.rowDbClick,initialize:e.init}}),a("contentModal",{attrs:{title:"文档详情",IsShow:e.isDetailShow,isDetails:!0},on:{modalClosed:function(t){return e.detailShowCancel()},modalComfirmed:function(t){return e.detailShowCancel()}}},[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},e._l(e.showItemFileds,(function(t){return a("v-flex",{key:t.id,attrs:{xs6:""}},[a("v-layout",{attrs:{row:"","align-center":"","justify-start":""}},[a("v-flex",{attrs:{xs4:""}},[a("label",{staticStyle:{color:"gray"}},[e._v(e._s(t.name)+":")])]),a("v-flex",{attrs:{xs8:""}},[e.dbClickShowItem[t.field]&&e.dbClickShowItem[t.field].power?a("label",{staticStyle:{color:"black"}},[e._v(e._s(e.dbClickShowItem[t.field].dname))]):a("label",{staticStyle:{color:"black"}},[e._v(e._s(e.dbClickShowItem[t.field]))])])],1)],1)})),1)],1)],1),a("contentModal",{attrs:{title:"更新文档",IsShow:e.UpdateIsShow},on:{modalClosed:function(t){return e.docUploadCancel()},modalComfirmed:function(t){return e.docUploadComfirmed()}}},[e._v("\n      "+e._s(e.uploadNotifyText)+"\n      "),a("v-progress-linear",{attrs:{active:e.progressShow},model:{value:e.progressValue,callback:function(t){e.progressValue=t},expression:"progressValue"}}),a("v-container",{attrs:{"grid-list-md":""}},[a("v-form",{ref:"form"},[a("v-text-field",{attrs:{label:"文件名字","prepend-icon":"edit"},model:{value:e.inputFileName,callback:function(t){e.inputFileName=t},expression:"inputFileName"}}),a("v-text-field",{attrs:{label:"更新描述","prepend-icon":"edit"},model:{value:e.docuDescription,callback:function(t){e.docuDescription=t},expression:"docuDescription"}}),a("v-text-field",{attrs:{"prepend-icon":"edit",prefix:"V",rules:[function(e){return!e||/^\d+$/.test(e)||/^\d+(\.\d+)+$/.test(e)||"只能是数字或者小数点！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n              版本号"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.userVersion,callback:function(t){e.userVersion=t},expression:"userVersion"}}),a("fileUploader",{ref:"fileUploader",attrs:{label:"请选择文件",name:"docuFile",disabled:e.fileUploaderDisabled},on:{formData:e.getFormData}}),a("p",[e._v("文档命名规则："+e._s(e.codeRull))])],1)],1)],1),a("contentModal",{attrs:{title:"历史版本",IsShow:e.HistoryIsShow,isDetails:!0},on:{modalClosed:function(t){e.HistoryIsShow=!1}}},[a("document-version",{ref:"getDocumentVersionList",on:{preView:e.preViewContainer}})],1),a("viewer",{staticClass:"images images-viewer",attrs:{options:e.viewerOptions},on:{inited:e.inited}},[a("img",{attrs:{src:e.imageSrc,"data-source":e.imageSrc,alt:"12"}})]),a("contentModal",{attrs:{title:"视频播放",IsShow:e.VideoIsShow,isDetails:!0},on:{modalClosed:function(t){return e.videoComfirmed()}}},[a("video-player",{ref:"videoPlayer",staticClass:"vjs-custom-skin",attrs:{options:e.playerOptions,playsinline:!0}})],1)],1)],1)},n=[],r=(a("7cfd"),a("e6d1"),a("c041"),a("4634"),a("0b34"),a("a7fe")),l=a("5cbc"),o=a("8333"),c=(a("9ee5"),a("0464"),a("2c75"),a("b013")),s=a("a2a7"),d=a("f05f"),u=a("6696"),m=a("2907"),f=a("1e17"),h=a("07c5"),p=a("8907"),b=a("adf0"),v=(a("2d09"),a("ac2c")),g=a.n(v),w=a("e248"),O=(a("48b0"),a("6e6d")),y=a("d5b3"),D=new o["a"](new r["a"]),S=new o["a"](new l["a"]);O["default"].use(g.a),a("48b0"),a("7100");var j={name:"documentManage",components:{documentVersion:m["a"],contentModal:s["a"],dataTable:d["a"],fileUploader:u["a"],videoPlayer:w["videoPlayer"],layContent:f["a"],layContentHeader:h["a"],layContentLeft:p["a"],layContentRight:b["a"]},data:function(){var e=this;return{headerBtns:[{disabled:!this.$per("Document","u"),text:"更新",icon:"self_refresh",click:function(){return e.updateDocument()}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/Document"==e.pvalue&&"下载"==e.pname}))),text:"下载",icon:"self_download",click:function(){return e.downloadDocument()}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/Document"==e.pvalue&&"查看"==e.pname}))),text:"查看",icon:"self_see",click:function(){return e.preViewDocument()}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/Document"==e.pvalue&&"历史版本"==e.pname}))),text:"历史版本",icon:"self_historicalversion",click:function(){return e.preHistory()}}],UpdateIsShow:!1,progressValue:0,progressShow:!1,uploadNotifyText:"",uploadFile:null,docuDescription:"",fileUploaderDisabled:!1,HistoryIsShow:!1,IsComfirmShow:!1,menu2:!1,menu:!1,IsLoading:!0,DataSource:[],datadictServer:{},totalDatas:1,showItem:{},userVersion:"",dcode:"",inputFileName:"",dtype:"",dModule:"",dModuleData:[],eqptype:"",eqptypes:[],sourceitem:{},docSource:[],eqps:[],meqps:[],spareParts:[],category:"",dperson:"",startDate:"",endDate:"",isDetailShow:!1,dbClickShowItem:{},showAdvance:!1,codeRull:"",condition:{},showItemNameAndFiled:[{id:1,name:"关联工单",field:"dsourse"},{id:2,name:"文档编号",field:"docuCode"},{id:3,name:"文档类型",field:"dType"}],headers:[{text:"序号",value:"",align:"center",sortable:!1},{text:"文档编号",value:"docuCode",align:"center",sortable:!1},{text:"文档名称",value:"dname",align:"center",sortable:!1},{text:"所属模块",value:"module",align:"center",sortable:!1},{text:"设备",value:"dsourse",align:"center",sortable:!1},{text:"上传人",value:"creatorName",align:"center",sortable:!1},{text:"描述",value:"docuDescription",align:"center",sortable:!1},{text:"最后更新日期",value:"newestDate",align:"center",sortable:!1},{text:"最新版本",value:"userVersion",align:"center",sortable:!1}],dtypes:[{name:"文档",value:0},{name:"图片",value:1},{name:"视频",value:2}],categorys:[{name:"维修",value:0},{name:"保养",value:1},{name:"点巡检",value:2},{name:"校准",value:3},{name:"其他",value:4}],showItemFileds:[{id:"1",field:"docuCode",name:"文档编号"},{id:"2",field:"dname",name:"文档名称"},{id:"3",field:"type",name:"文档类型"},{id:"4",field:"equipmentName",name:"关联设备"},{id:"5",field:"equipmentType",name:"设备类型"},{id:"6",field:"categoryName",name:"维护方式"},{id:"7",field:"docuDescription",name:"描述"},{id:"8",field:"newestDate",name:"最新更新日期"}],docuTreeSource:[],_docuTreeSource:[],docuTreeModel:[],docuTreeActive:[],userList:[],parentIds:[],_documentServer:{},searchText:null,search:"",dataTableSelectItem:null,imageSrc:"",viewerOptions:{inline:!1,navbar:!1},VideoIsShow:!1,playerOptions:{language:"zh-CN",playbackRates:[.7,1,1.5,2],sources:[{type:"video/mp4",src:"http://vjs.zencdn.net/v/oceans.mp4"}],poster:"https://avatars0.githubusercontent.com/u/24718510?s=460&v=4"},player:null}},mounted:function(){this._documentServer=new c["a"],this.initialize()},methods:{inited:function(e){this.$viewer=e},initialize:function(){var e=this;this.$Server.queryAll(D.getModelName(),{},{dname:"设备类型"}).then((function(t){e.eqptypes=t.datas}),(function(e){return y["a"].alert(e)})),this.$Server.queryAll("User",{}).then((function(t){e.userList=t.datas})),this.$Server.queryAll((new l["a"]).__name,{},{eqpCondtion:"eqp"}).then((function(t){e.eqps=t.datas;var a=[];e.eqps.forEach((function(e){var t={id:e.id,name:e.equipmentName,type:0};a.push(t)})),e.docSource=e.docSource.concat(a)}),(function(e){return y["a"].alert(e)})),this.$Server.queryAll((new l["a"]).__name,{},{meqpCondtion:"meqp"}).then((function(t){e.meqps=t.datas;var a=[];e.meqps.forEach((function(e){var t={id:e.id,name:e.equipmentName,type:1};a.push(t)})),e.docSource=e.docSource.concat(a)}),(function(e){return y["a"].alert(e)})),this.$Server.queryAll((new l["a"]).__name,{},{sparePartCondtion:"spc"}).then((function(t){e.spareParts=t.datas;var a=[];e.spareParts.forEach((function(e){var t={id:e.id,name:e.equipmentName,type:2};a.push(t)})),e.docSource=e.docSource.concat(a)}),(function(e){return y["a"].alert(e)})),this.$Server.queryAll("CodeRule",{},{codeType:40}).then((function(t){t.datas&&t.datas[0]&&(e.codeRull=t.datas[0].joinModifiers)}),(function(e){return y["a"].alert(e)})),this.$Server.queryAll("DocumentSource",{},{docuTreeType:99}).then((function(t){e.dModuleData=t.datas}),(function(e){return y["a"].alert(e)}))},dayFormat:function(e){return e?new Date(e.replace(/-/g,"/")).getDate():""},init:function(e){var t=this,a=this.$refs.childDataTable.getPagination(),i=a.page,n=a.rowsPerPage;this.$Server.queryAll(S.getModelName(),{page:i,rowsPerPage:n},this.condition).then((function(e){t.$refs.childDataTable.unCheckItems(),t.DataSource=e.datas,t.totalDatas=e.page.total}),(function(e){return y["a"].alert(e)}))},queryData:function(e){this.condition=e,1==this.$refs.childDataTable.getPagination().page?this.init():this.$refs.childDataTable.setPage(1)},updateDocument:function(){var e=this.$refs.childDataTable.getCheckItems();null==e||0==e.length?y["a"].alert("请选择需要更新的指定文档行数据！"):(this.dataTableSelectItem=e[0],this.UpdateIsShow=!0)},downloadDocument:function(){var e=this.getSelectItems("请选择需要下载的文档！");if(e&&1==e.length){var t=e[0];if(t.newestVersion>0){var a=document.createElement("a");a.href=t.newestFilePath;var i=t.newestFilePath.split("/");a.download=i[i.length-1],a.click()}else y["a"].alert("该文档还没有更新，没有可供下载的文件")}else y["a"].alert("请选择一项")},getFormData:function(e){var t=this,a=this.dataTableSelectItem;if(e&&a&&a.id){var i=e.get("data");if(i){if(i.size>=51380224)return void y["a"].alert("文件大小超过系统上限！");var n=i.name.substring(i.name.lastIndexOf(".")+1,i.name.length);if("cmd"==n||"exe"==n||"bat"==n||"com"==n||"vbs"==n)return void y["a"].alert("禁止上传该类型的文件！");this.uploadNotifyText="",this.progressValue=0,this.progressShow=!1,t.uploadFile=i}else y["a"].alert("请选择需要更新的指定文档行数据！")}},docUploadComfirmed:function(){var e=this,t=this;if(t.$refs.form.validate()){var a=this.uploadFile,i=this.dataTableSelectItem,n={};a&&(t.uploadNotifyText="正在处理文件……",t.fileUploaderDisabled=!0,t._documentServer.getBase64(a).then((function(r){n=JSON.parse(JSON.stringify(i)),n.id=i.id,n.docuFile=r,n.dname=a.name,n.docuDescription=t.docuDescription,n.newestFileExt="."+n.dname.split(".")[1],n.userVersion=e.userVersion,t.uploadNotifyText="文件处理成功，开始上传……",""!=t.inputFileName&&(n.dname=t.inputFileName+a.name.substring(a.name.lastIndexOf("."))),t.$Server.addOrUpdate(S.getModelName(),n,!0).then((function(e){if(e.success){var a=e.model;a.dname&&(i.dname=a.dname),a.docuDescription&&(i.docuDescription=a.docuDescription),a.updateTime&&(i.updateTime=a.updateTime),a.newestFileId&&(i.newestFileId=a.newestFileId),a.newestFileExt&&(i.newestFileExt=a.newestFileExt),a.newestFilePath&&(i.newestFilePath=a.newestFilePath),a.newestVersion&&(i.newestVersion=a.newestVersion),a.newestFileSize&&(i.newestFileSize=a.newestFileSize),t.queryData(),y["a"].alert("文件上传成功","success"),t.docUploadCancel()}}),(function(e){return y["a"].alert(e)}))})))}else y["a"].alert("请上传文件！")},preViewDocument:function(){var e=this.getSelectItem();e?this.preViewContainer(e.newestFileExt,e.newestFilePath,e.newestFileSize):y["a"].alert("请选择需要查看的文档！")},preViewContainer:function(e,t,a){var i=this;if(".png"==e||".gif"==e||".jpg"==e||".bmp"==e||".jpeg"==e)i.imageSrc=t,i.$viewer.show();else if(".mp4"==e)i.playerOptions.sources[0].src=t,i.VideoIsShow=!0;else if(".pdf"==e)window.open(t);else if(".doc"==e||".docx"==e||".ppt"==e||".pptx"==e){var n=t.replace(/documents/g,"documents/ToPdf"),r=n.split(".");r[2]="pdf",window.open(r.join("."))}else if(".xls"==e||".xlsx"==e){var l=t.replace(/documents/g,"documents/ToPdf"),o=l.split(".");o[2]="pdf",window.open(o.join("."))}else y["a"].alert("暂不提供改类型文件在线预览！")},preHistory:function(){var e=this.getSelectItem();e?e.id?(this.$refs.getDocumentVersionList.initialize(e.id),this.showItem=e,this.HistoryIsShow=!0):y["a"].alert("未获取到文档信息！"):y["a"].alert("请选择需要查看历史版本的文档行数据！")},clearFileInput:function(){this.$refs.fileUploader.clearFile()},docUploadCancel:function(){this.clearFileInput(),this.$refs.form.reset(),this.progressValue=0,this.progressShow=!1,this.uploadNotifyText="",this.docuDescription="",this.inputFileName="",this.uploadFile=null,this.UpdateIsShow=!1,this.fileUploaderDisabled=!1},getSelectItem:function(){var e=this.$refs.childDataTable.getCheckItems();return null!=e&&e.length>0?e[0]:null},getSelectItems:function(e){var t=this.$refs.childDataTable.getCheckItems();if(null!=t&&t.length>0)return t;y["a"].alert(e)},videoComfirmed:function(){this.VideoIsShow=!1,this.$refs.videoPlayer.player.pause()},searchTextChange:function(){this.queryData({docuCode:this.searchText?this.searchText:""})},clearMessage:function(){this.queryData({})},clearSearch:function(){this.dcode="",this.dname="",this.dtype="",this.eqptype="",this.category="",this.dperson="",this.startDate="",this.endDate="",this.dModule="",this.sourceitem="",this.queryData({})},gridSearch:function(){var e={dcode:this.dcode,dname:this.dname,dtype:this.dtype,dModule:this.dModule,eqptype:this.eqptype,category:this.category,dperson:this.dperson,startDate:this.startDate,endDate:this.endDate};if(this.sourceitem)switch(e.type=this.sourceitem.type,this.sourceitem.type){case 0:e.eqp=this.sourceitem.id;break;case 1:e.meqp=this.sourceitem.id;break;case 2:e.sparePart=this.sourceitem.id;break;default:break}this.queryData(e)},toTree:function(e,t){for(var a,i=this,n=[],r=0;r<e.length;r++)if(e[r].parentId==t){i.parentIds.push(t);var l=e[r];a=i.toTree(e,e[r].id),a.length>0&&(l.children=a),n.push(l)}return n},detailShowCancel:function(){this.isDetailShow=!1},rowDbClick:function(e){this.dbClickShowItem=JSON.parse(JSON.stringify(e)),this.isDetailShow=!0},advanced:function(){this.showAdvance=!this.showAdvance}}},x=j,F=(a("d727"),a("6691")),N=Object(F["a"])(x,i,n,!1,null,null,null);t["default"]=N.exports},d727:function(e,t,a){"use strict";var i=a("0583"),n=a.n(i);n.a}}]);