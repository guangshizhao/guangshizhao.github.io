(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04e686ee"],{"2edb":function(e,t,i){"use strict";var a,n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{"max-width":"1000px",persistent:!0,scrollable:""},model:{value:e.IsShow,callback:function(t){e.IsShow=t},expression:"IsShow"}},[i("v-card",[i("v-card-title",{staticClass:"primary"},[i("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v(e._s(e.title))])]),i("v-card-text",[i("v-container",{staticStyle:{padding:"0"},attrs:{"grid-list-md":"","text-md-center":""}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm2:""}},[i("treeCombo",{attrs:{Source:e.dataSource,MultipleSelect:!1,label:"工厂产线架构",independentCheck:!1,independentSingleCheck:!0,"item-value":"id","item-text":"oname",clearable:"","return-object":""},on:{cleared:e.clearSearch},model:{value:e.equipmentPosition,callback:function(t){e.equipmentPosition=t},expression:"equipmentPosition"}})],1),i("v-flex",{attrs:{xs12:"",ms2:"",md2:""}},[i("v-select",{attrs:{items:e.equipType,label:"设备类型","item-value":"dvalue","item-text":"dname",clearable:"","single-line":""},on:{"click:clear":e.clearSearch},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),i("v-flex",{attrs:{xs12:"",sm2:""}},[i("v-text-field",{attrs:{label:"设备编号",clearable:"","single-line":""},on:{"click:clear":e.clearSearch},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),i("v-flex",{attrs:{xs12:"",sm2:""}},[i("v-text-field",{attrs:{label:"设备名称",clearable:"","single-line":""},on:{"click:clear":e.clearSearch},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),i("v-flex",{attrs:{xs3:""}},[i("v-btn",{attrs:{color:"default","d-flex":""},on:{click:function(t){return e.Search()}}},[e._v("查询")]),i("v-btn",{attrs:{color:"default","d-flex":""},on:{click:function(t){return e.clearSearch()}}},[e._v("清空查询")])],1)],1)],1),i("gridTemplate2",{ref:"childGridTemplate",attrs:{title:"设备台账",gridModel2:e.equipmentModal,sort:!0,initCondition:e.initCondition}})],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.equipmentModalComfirmed()}}},[e._v("确定")]),i("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.equipmentModalClosed()}}},[e._v("取消")])],1)],1)],1)},o=[],r=(i("7cfd"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,sort:e.sort,DataSource:e.DataSource,hideOperation:!0,formatFields:e.FormatFields,total:e.total},on:{rowDbClick:e.rowDbClick,initialize:e.init}}),i("contentModal",{attrs:{title:e.title1,IsShow:e.IsShow,width:e.width},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[i("formTemplate",{ref:"childForm",attrs:{editors:e.editors,editedItem:e.editedItem}},[e._t("default")],2)],1),i("comfirmModal",{attrs:{title:"提示",IsShow:e.IsComfirmShow,text:e.deleteTittle},on:{modalComfirmedClose:function(t){return e.modalComfirmedClose()},modalComfirmed:function(t){return e.cofirmDelete()}}})],1)}),l=[],s=(i("ed8b"),i("4634"),i("de90"),i("8f42"),i("a2a7")),d=i("23f5"),c=i("71ba"),m=i("f05f"),u=i("8333"),h=i("d5b3"),p={name:"gridTemplate2",props:{gridModel2:{type:Object,required:!0},title:{type:String,required:!0},sort:{type:Boolean,default:!1},width:{type:Number},initCondition:{type:Object}},data:function(){return{valid:!0,IsShow:!1,IsComfirmShow:!1,IsLoading:!0,editors:[],totalDatas:0,total:1,DataSource:[],headers:[],editedItem:{},search:"",deletItems:[],FormatFields:{},currentparams:{},isAddOrUpdate:!0,title1:"",deleteTittle:"",likeParent:{}}},components:{contentModal:s["a"],comfirmModal:d["a"],dataTable:m["a"],formTemplate:c["a"]},watch:{gridModel2:{handler:function(e){a=new u["a"](e),this.headers=a.formatGridHeader(),!0===this.sort&&this.headers.unshift({text:"序号",align:"center",sortable:!1});var t=a.getEditFields();t.sort((function(e,t){var i=0;return e.formOrder<t.formOrder&&(i=-1),e.formOrder>t.formOrder&&(i=1),i})),this.editors=t,this.$emit("editorsReCode",t),this.FormatFields=a.getFormatFields()}}},methods:{init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;null!=e.page&&(this.currentparams=e);var i=this.currentparams,n=i.page,o=i.rowsPerPage;t.initCondition&&Object.keys(t.initCondition).forEach((function(e){t.likeParent[e]=t.initCondition[e]})),this.$Server.queryAll(a.getModelName(),{page:n,rowsPerPage:o},t.likeParent).then((function(e){t.DataSource=e.datas,t.total=e.page.total,t.$emit("afterInit",t.DataSource),null!=t.$refs.childDataTable.getCheckItems()&&t.$refs.childDataTable.getCheckItems().length>0&&t.$refs.childDataTable.unCheckItems()}),(function(e){return h["a"].alert(e)}))},doSearch:function(e){this.likeParent=e;var t=this.currentparams.page;1==t?this.init():this.$refs.childDataTable.setPage(1)},getPages:function(e){this.params=e},rowDbClick:function(e){this.$emit("rowDbClick",e)},GridDelete:function(){this.$refs.childDataTable.getCheckItems().length<=0?h["a"].alert("请选中需要删除的项"):(this.deleteTittle="确定删除所选"+this.title+"?",this.IsComfirmShow=!0)},getSelectedItems:function(){return this.$refs.childDataTable.getCheckItems()},unCheckItems:function(){return this.$refs.childDataTable.unCheckItems()},cofirmDelete:function(){var e=this.getSelectedItems();this.$emit("beforeExcuteDelete",e);var t=this;this.$Server.batchDelete(a.getModelName(),e).then((function(){t.IsComfirmShow=!1,t.init(t.currentparams)}),(function(e){t.IsComfirmShow=!1,h["a"].alert(e)}))},GridAdd:function(){this.editedItem={},this.$emit("beforeAdd",this.editedItem),this.IsShow=!0,this.$refs.childForm.resetValid(),this.$refs.childForm.resetForm(),this.title1="添加"+this.title},GridEdit:function(){var e=this;if(e.title1="编辑"+e.title,1!=e.$refs.childDataTable.getCheckItems().length)h["a"].alert("请选择一项作为你修改的对象");else{e.editedItem={};var t=e.$refs.childDataTable.getCheckItems()[0],i=t.id,a=t.createTime,n=t.updateTime,o=t.creator,r=t.modifier;e.editedItem={id:i,createTime:a,updateTime:n,creator:o,modifier:r},e.editors.forEach((function(i){i.field&&(e.editedItem[i.field]=t[i.field])})),e.$refs.childForm.resetValid(),e.$emit("beforeEdit",e.editedItem,t),e.IsShow=!0}},modalClosed:function(){this.$emit("beforeCancel"),this.IsShow=!1},modalComfirmed:function(){var e=this,t=this.$refs.childForm.getValues();this.$emit("beforeEditSubmit",t),0==this.$refs.childForm.getValid()?h["a"].alert("验证不通过"):e.isAddOrUpdate&&(e.isAddOrUpdate=!1,e.$Server.addOrUpdate(a.getModelName(),t,t.id).then((function(i){i.success&&(e.IsShow=!1,t.id&&(e.$refs.childDataTable.unCheckItems(),e.$refs.childDataTable.setCheckItems(t)),e.init(e.currentparams),h["a"].alert("保存成功","success"),e.$emit("afterCommitSuccess"),e.isAddOrUpdate=!0)}),(function(t){h["a"].alert(t),e.isAddOrUpdate=!0})))},modalComfirmedClose:function(){this.IsComfirmShow=!1},getCheckItems:function(){return this.$refs.childDataTable.getCheckItems()}}},f=p,v=i("6691"),b=Object(v["a"])(f,r,l,!1,null,null,null),q=b.exports,C=i("f19a"),S=i("7c02"),y=i("a7fe"),g=i("4027"),T={name:"equipmentModal",data:function(){return{title:"选择设备",equipmentModal:{},equipType:[],type:"",code:"",name:"",equipmentPosition:"",dataSource:[]}},mounted:function(){console.log(22222222),console.log(this.initCondition),this.init()},watch:{},computed:{},methods:{equipmentModalClosed:function(){this.$emit("equipmentModalClosed"),this.init(),this.$refs.childGridTemplate.init()},equipmentModalComfirmed:function(){this.$refs.childGridTemplate.getSelectedItems().length<=0?h["a"].alert("请选中需要确定的项"):(this.$emit("result",this.$refs.childGridTemplate.getSelectedItems()),this.$emit("equipmentModalComfirmed"),this.init(),this.$refs.childGridTemplate.unCheckItems(),this.$refs.childGridTemplate.init())},init:function(){var e=this;e.equipmentModal={},e.equipType=[],e.type="",e.code="",e.name="",e.equipmentPosition="",e.dataSource=[],this.equipmentModal=new S["a"],this.$Server.queryAll((new y["a"]).__name,{},{type:"4"}).then((function(t){e.equipType=t.datas})),this.$Server.queryAll((new g["a"]).__name,{},{searchEqpStation:!0}).then((function(t){e.dataSource=t.datas}))},Search:function(){var e=[],t=this;e={name:this.name,code:this.code,type:this.type,model:this.model,equipmentPosition:this.equipmentPosition&&this.equipmentPosition.length>0?this.equipmentPosition[0]:""},e.deleted=this.initCondition.deleted,e.eStatus=this.initCondition.eStatus,this.$Server.queryAll((new S["a"]).__name,{},e).then((function(e){t.$refs.childGridTemplate.DataSource=e.datas,t.$refs.childGridTemplate.total=e.total}))},clearSearch:function(){this.equipmentPosition="",this.name="",this.code="",this.type="",this.model="",this.$refs.childGridTemplate.init()}},components:{gridTemplate2:q,treeCombo:C["a"]},props:{IsShow:{type:Boolean,default:!1},initCondition:{type:Object,default:function(){var e={deleted:!1,eStatus:[0,1,2,4]};return e}}}},w=T,k=Object(v["a"])(w,n,o,!1,null,null,null);t["a"]=k.exports},c976:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{"max-width":"1000px",persistent:!0,scrollable:""},model:{value:e.IsShow,callback:function(t){e.IsShow=t},expression:"IsShow"}},[i("v-card",[i("v-card-title",{staticClass:"primary"},[i("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v(e._s(e.title))])]),i("v-card-text",[i("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,DataSource:e.importbackModal,allowActive:!0,hideOperation:!0}})],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.importBackModalComfirmed()}}},[e._v("继续添加")]),i("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.importBackModalClosed()}}},[e._v("取消")])],1)],1)],1)},n=[],o=i("f05f"),r=(i("d5b3"),{name:"importbackModal",data:function(){return{}},mounted:function(){},watch:{},methods:{importBackModalClosed:function(){this.$emit("importBackModalClosed")},importBackModalComfirmed:function(){this.$emit("importBackModalComfirmed")},init:function(){}},components:{dataTable:o["a"]},props:["IsShow","title","headers","importbackModal"]}),l=r,s=i("6691"),d=Object(s["a"])(l,a,n,!1,null,null,null);t["a"]=d.exports},fa2f:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-container",{staticStyle:{padding:"0"},attrs:{"grid-list-md":"","text-md-center":""}},[i("v-layout",{attrs:{row:"",wrap:"","align-content-start":""}},[i("v-flex",{attrs:{xs4:""}},[i("v-select",{attrs:{label:"分类方式",items:e.typeList,"item-text":"name","item-value":"id",clearable:""},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),e.isFactoryLine?i("v-flex",{attrs:{xs4:""}},[i("treeCombo",{attrs:{Source:e.equipmentPositionData,MultipleSelect:!1,label:"工厂产线架构",independentCheck:!1,independentSingleCheck:!0,clearable:"","return-object":""},model:{value:e.equipmentPosition,callback:function(t){e.equipmentPosition=t},expression:"equipmentPosition"}})],1):e._e(),e.isEquipmentType?i("v-flex",{attrs:{xs4:""}},[i("v-select",{attrs:{label:"设备类型",items:e.equipmentTypeData,"item-text":"dname","item-value":"dvalue",clearable:""},model:{value:e.equipmentType,callback:function(t){e.equipmentType=t},expression:"equipmentType"}})],1):e._e()],1)],1),i("EquipmentModalTemplate",{attrs:{initCondition:e.initCondition,IsShow:e.IsShow},on:{result:e.getResult,equipmentModalClosed:function(t){return e.equipmentModalClosed()},equipmentModalComfirmed:function(t){return e.equipmentModalComfirmed()}}}),e.isEquipment?i("div",[i("div",[e._v("关联设备\n            "),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-icon",e._g({on:{click:function(t){return e.addEquipment()}}},a),[e._v("add")])]}}],null,!1,3160527147)},[i("span",[e._v("新增设备")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-icon",e._g({on:{click:function(t){return e.removeEquipment()}}},a),[e._v("remove")])]}}],null,!1,3340036171)},[i("span",[e._v("移除设备")])])],1),i("simpleDataTable",{ref:"childDataTable",attrs:{headers:e.headers,hideHeaders:!1,sort:!0,items:e.equipment,allowActive:!0,hideOperation:!0}})],1):e._e()],1)},n=[],o=(i("4634"),i("ef3e")),r=i("2edb"),l=i("d5b3"),s=i("a7fe"),d=i("f19a"),c=i("4027"),m={name:"addEquipmentModal",data:function(){return{headers:[{text:"设备编号",value:"code",align:"center",sortable:!1},{text:"设备名称",value:"name",align:"center",sortable:!1},{text:"规格型号",value:"model",align:"center",sortable:!1},{text:"设备类型",value:"typeChinese",align:"center",sortable:!1},{text:"设备位置",value:"factoryName",align:"center",sortable:!1}],typeList:[{id:"isFactoryLine",name:"工厂产线架构"},{id:"isEquipmentType",name:"设备类型"},{id:"isEquipment",name:"设备"}],isFactoryLine:!1,isEquipmentType:!1,isEquipment:!1,equipment:[],type:"",IsShow:!1,equipmentPositionData:[],equipmentPosition:"",equipmentTypeData:[],equipmentType:""}},props:["isClear","initCondition"],components:{EquipmentModalTemplate:r["a"],simpleDataTable:o["a"],treeCombo:d["a"]},mounted:function(){},watch:{isClear:{handler:function(e,t){e&&(this.type="")}},type:{handler:function(e,t){this.init(),"isFactoryLine"===e?this.isFactoryLine=!0:"isEquipmentType"===e?(this.isEquipmentType=!0,this.isFactoryLine=!0):"isEquipment"===e&&(this.isEquipment=!0)}},equipmentType:{handler:function(e,t){this.$emit("equipmentType",e),this.$emit("equipmentPosition",this.equipmentPosition[0]||this.equipmentPosition)}},equipmentPosition:{handler:function(e,t){console.log("11111111111111111"),console.log(e),this.$emit("equipmentPosition",e[0])}},equipment:{handler:function(e,t){console.log(e),this.$emit("equipment",e)}}},methods:{init:function(){var e=this;e.isFactoryLine=!1,e.isEquipmentType=!1,e.isEquipment=!1,e.equipment=[],e.IsShow=!1,e.equipmentPositionData=[],e.equipmentTypeData=[],e.equipmentPosition="",e.equipmentType="",this.$Server.queryAll((new c["a"]).__name,{},{searchEqpStation:!0}).then((function(t){e.equipmentPositionData=t.datas})),this.$Server.queryAll((new s["a"]).__name,{},{type:"4"}).then((function(t){e.equipmentTypeData=t.datas}))},getResult:function(e){var t=this;e.forEach((function(e){e.typeChinese=e.type.dname;var i=t.equipment.filter((function(t){return t.code===e.code}));0===i.length&&t.equipment.push(e)}))},equipmentModalClosed:function(){this.IsShow=!1},equipmentModalComfirmed:function(){this.IsShow=!1},addEquipment:function(){this.IsShow=!0},removeEquipment:function(){var e=this,t=this.$refs.childDataTable.getCheckItems();0===t.length?l["a"].alert("请选择删除的设备"):t.forEach((function(t){e.equipment.forEach((function(e,i,a){e.code==t.code&&a.splice(i,1)}))}))}}},u=m,h=i("6691"),p=Object(h["a"])(u,a,n,!1,null,null,null);t["a"]=p.exports}}]);