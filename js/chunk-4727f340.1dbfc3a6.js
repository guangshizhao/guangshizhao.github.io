(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4727f340"],{2214:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("layContentHeader",{attrs:{title:"维修统计"}}),i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[i("div",{staticClass:"box"},[i("div",{staticClass:"box-header flex-header",staticStyle:{height:"50px",overflow:"hidden"}},[i("div",{staticClass:"label-title"},[t._v("时间:")]),i("div",{staticClass:"width280 mar-l22"},[i("datePicker",{attrs:{required:!1,rules:[function(t){return!!t||"必填项"}],prependIcon:"star",locale:"zh-cn"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),i("div",{staticClass:"label-title"},[t._v("到")]),i("div",{staticClass:"width280"},[i("datePicker",{attrs:{required:!1,rules:[function(t){return!!t||"必填项"},function(e){return new Date(e)>new Date(t.startDate)||"结束时间应该大于开始时间"}],prependIcon:"star",locale:"zh-cn"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),i("div",{staticClass:"label-title"},[t._v("维度:")]),i("div",{staticClass:"width280"},[i("v-select",{staticClass:"self-select",attrs:{items:["月","周","年"]},on:{change:t.getChatInfo},model:{value:t.timeDimension,callback:function(e){t.timeDimension=e},expression:"timeDimension"}})],1),i("v-btn",{staticClass:"btn-0",attrs:{small:"",depressed:""},on:{click:t.doSearch}},[t._v("查询")]),i("v-btn",{staticClass:"btn-0",attrs:{small:"",depressed:""},on:{click:t.handleToggleData}},[t._v(t._s(t.show?"隐藏数据":"显示数据"))])],1)])]),i("div",{staticClass:"box mar-t22"},[i("div",{staticClass:"box-header flex-header",staticStyle:{height:"50px",overflow:"hidden"}},[i("div",{staticClass:"label-title"},[t._v("统计维度:")]),i("div",{staticClass:"width280 mar-l22"},[i("v-select",{staticClass:"self-select",attrs:{items:["工厂","车间","产线","设备类型","设备"]},on:{change:t.handleQueryTypeChange},model:{value:t.statisDimension,callback:function(e){t.statisDimension=e},expression:"statisDimension"}})],1),i("div",{staticClass:"label-title"},[t._v(t._s(t.statisDimension)+":")]),"工厂"===t.statisDimension?i("div",{staticClass:"width280"},[i("v-select",{attrs:{items:t.factoryList,"item-text":"fname","item-value":"id"},model:{value:t.id,callback:function(e){t.id=e},expression:"id"}})],1):t._e(),"车间"===t.statisDimension?i("div",{staticClass:"width280"},[i("treeComboForNode",{attrs:{itemName:"oname",Source:t.forgList,independentCheck:!1,nodeValue:"1",disabled:!1,independentSingleCheck:!0,"return-object":""},model:{value:t.id,callback:function(e){t.id=e},expression:"id"}})],1):t._e(),"产线"===t.statisDimension?i("div",{staticClass:"width280"},[i("treeComboForNode",{attrs:{itemName:"oname",Source:t.forgList,independentCheck:!1,independentSingleCheck:!0,nodeValue:"5"},model:{value:t.id,callback:function(e){t.id=e},expression:"id"}})],1):t._e(),"设备类型"===t.statisDimension?i("div",{staticClass:"width280"},[i("v-select",{attrs:{items:t.typeList,"item-text":"dname","item-value":"dvalue"},model:{value:t.id,callback:function(e){t.id=e},expression:"id"}})],1):t._e(),"设备"===t.statisDimension?i("div",{staticClass:"width280"},[i("treeCombo",{ref:"treeCombos",attrs:{require:!1,Source:t.eqpList,MultipleSelect:!1,disabled:!1,independentCheck:!0,independentSingleCheck:!0,"return-object":""},model:{value:t.id,callback:function(e){t.id=e},expression:"id"}})],1):t._e()])]),i("div",{staticClass:"box-flex mar-t22"},[i("div",{staticClass:"flex2"},[t._m(0),t._m(1),i("div",{staticClass:"box mar-t22"},[i("div",{staticClass:"box-header flex-header"},[i("div",{staticClass:"title-0"},[t._v("维保对比统计")]),i("div",{staticClass:"label-title"},[t._v("统计类容:")]),i("div",{staticClass:"width280"},[i("v-select",{staticClass:"self-select",attrs:{items:["次数","时间"]},on:{change:t.handleStatisContentChange},model:{value:t.statisContent,callback:function(e){t.statisContent=e},expression:"statisContent"}})],1)]),i("div",{staticStyle:{width:"100%",height:"350px"},attrs:{id:"chat5"}})])]),t._m(2)])],1)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box-wrap"},[i("div",{staticClass:"box flex6"},[i("div",{staticClass:"box-header flex-header"},[i("div",{staticClass:"title-0"},[t._v("维修工时统计")])]),i("div",{staticStyle:{width:"100%",height:"350px"},attrs:{id:"chat1"}})]),i("div",{staticClass:"box flex4"},[i("div",{staticClass:"box-header flex-header"},[i("div",{staticClass:"title-0"},[t._v("维修时间")])]),i("div",{staticStyle:{width:"100%",height:"350px"},attrs:{id:"chat2"}})])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box mar-t22"},[i("div",{staticClass:"box-header flex-header"},[i("div",{staticClass:"title-0"},[t._v("人员工时统计")])]),i("div",{staticStyle:{width:"100%",height:"350px"},attrs:{id:"chat3"}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flex1 border-l mar-l16"},[i("div",{staticClass:"box flex1"},[i("div",{staticClass:"box-header flex-header"},[i("div",{staticClass:"title-0"},[t._v("\n                        平均故障时间统计\n                    ")])]),i("div",{staticStyle:{width:"100%",height:"350px"},attrs:{id:"chat4"}})])])}],n=(i("7cfd"),i("40c5"),i("4634"),i("fafd"),i("63ff"),i("f8f9")),r=i("1d53"),o=i("d5b3"),l=i("6bf2"),c=i.n(l),h=i("0b43"),d=i("b188"),u=i("f19a"),f=i("4027"),m=i("a7fe"),p=i("d685"),x={name:"repaireStatistics",components:{datePicker:r["a"],treeComboForLastNode:h["a"],treeComboForNode:d["a"],treeCombo:u["a"]},data:function(){return{valid:!0,startDate:c()((new Date).setMonth((new Date).getMonth()-1)).format("YYYY-MM-DD"),endDate:c()(new Date).format("YYYY-MM-DD"),chatOne:"",chatTwo:"",chatThree:"",timeDimension:"月",showLabel:!1,show:!1,statisDimension:"工厂",id:"",typeList:[],eqpList:[],forgList:[],factoryList:[],xAxis1:[],yAxis1:[],xAxis2:[],yAxis2:[],yAxis2_1:[],xAxis3:[],yAxis3:[],xAxis4:[],yAxis4:[],yAxis4_1:[],typeDimension:"故障停机时间",statisContent:"次数"}},watch:{statisDimension:function(){this.getChatInfo()},id:function(t){""!=t&&null!=t&&"[]"!=JSON.stringify(t)&&this.getChatInfo()}},methods:{initChat:function(){this.chatOne=this.$echarts.init(document.getElementById("chat1")),this.chatTwo=this.$echarts.init(document.getElementById("chat2")),this.chatThree=this.$echarts.init(document.getElementById("chat3")),this.chatFour=this.$echarts.init(document.getElementById("chat4")),this.chatFive=this.$echarts.init(document.getElementById("chat5"))},handleToggleData:function(){this.show=!this.show,this.initChatOne(this.xAxis1,this.yAxis1,this.show),this.initChatTwo(this.xAxis2,this.yAxis2,this.yAxis2_1,this.show),this.initChatThree(this.xAxis3,this.yAxis3,this.show),this.initChatFour(this.xAxis4,this.yAxis4,this.yAxis4_1,this.show),this.initChatFive(this.xAxis5,this.series5_1,this.series5_2,this.series5_3,this.show)},doSearch:function(){this.$refs.form.validate()&&(this.getChatInfo(),this.getChat2Info())},handleQueryTypeChange:function(){this.id=""},initChatOne:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={xAxis:{type:"category",data:t,axisLabel:{color:"#8b8f98",rotate:"30"}},yAxis:[{type:"value",name:"工时(小时)"}],tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["维修工时"],right:80},series:[{color:"#fe785c",name:"维修工时",data:e,type:"line",label:{show:i,position:"top"}}]};this.chatOne.setOption(a)},initChatTwo:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={color:["#facdc4","#ff614b","#487de9","#969ba6","#ffcb99","#787993"],xAxis:{type:"category",data:t,axisLabel:{color:"#8b8f98",rotate:"30"}},grid:{bottom:5,containLabel:!0},yAxis:[{type:"value",name:"维修工时(小时)"},{type:"value",name:"维修率",axisTick:{show:!0},axisLabel:{formatter:function(t){return 100*t+"%"}},min:0,max:1,boundaryGap:[.2,.2]}],tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["维修工时","维修率"],right:80},series:[{name:"维修工时",data:e,type:"bar",barMaxWidth:window.infoConfig.barMaxWidth,label:{show:a,position:"top"}},{name:"维修率",data:i,type:"line",yAxisIndex:1,label:{show:a,position:"top"}}]};this.chatTwo.setOption(s)},initChatThree:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={color:["#dee4ed","#ff614b","#487de9","#969ba6","#ffcb99","#787993"],xAxis:{type:"category",data:t,axisLabel:{color:"#8b8f98",rotate:"30"}},grid:{containLabel:!0},yAxis:[{type:"value",name:"维修时间"}],tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["维修时间"],right:80},series:[{name:"维修时间",data:e,type:"bar",barMaxWidth:window.infoConfig.barMaxWidth,label:{show:i,position:"top"}}]};this.chatThree.setOption(a)},initChatFour:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={color:["#f37070","#ff614b","#487de9","#969ba6","#ffcb99","#787993"],xAxis:{type:"category",data:t,axisLabel:{color:"#8b8f98",rotate:"30"}},yAxis:[{type:"value",name:"平均故障时间(小时)"},{type:"value",name:"故障率",axisTick:{show:!0},axisLabel:{formatter:function(t){return 100*t+"%"}},min:0,max:1,boundaryGap:[.2,.2]}],tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["平均故障时间","故障率"],right:80},series:[{name:"平均故障时间",data:e,type:"bar",barMaxWidth:window.infoConfig.barMaxWidth,label:{show:a,position:"top"}},{name:"故障率",data:i,type:"line",yAxisIndex:1,label:{show:a,position:"top"}}]};this.chatFour.setOption(s)},initChatFive:function(t,e,i,a){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n={color:["#ff0000","#ff7052","#d0d8e5","#969ba6","#ffcb99","#787993"],xAxis:{type:"category",data:t,axisLabel:{color:"#8b8f98",rotate:"30"}},yAxis:[{type:"value",name:"次数"==this.statisContent?"维修次数":"维修时间(小时)"}],tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:["保养"+this.statisContent,"维修"+this.statisContent,"二次维修"+this.statisContent],right:80},series:[{name:"保养"+this.statisContent,stack:"广告",data:e,type:"bar",barMaxWidth:window.infoConfig.barMaxWidth,label:{show:s,color:"#000",position:["50%","50%"]}},{name:"维修"+this.statisContent,stack:"广告",data:i,type:"bar",barMaxWidth:window.infoConfig.barMaxWidth,label:{show:s,color:"#000",position:["50%","50%"]}},{name:"二次维修"+this.statisContent,stack:"广告",data:a,type:"bar",barMaxWidth:window.infoConfig.barMaxWidth,label:{show:s,color:"#000",position:["50%","50%"]}}]};this.chatFive.setOption(n)},getCondition:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$Server.queryAll((new m["a"]).__name,{},{type:"4"}),i=this.$Server.queryAll((new f["a"]).__name,{},{searchEqpStation:!0}),a=this.$Server.queryAll((new p["a"]).__name,{},{all:"all"}),s=Promise.all([e,i,a]),t.next=6,s;case 6:n=t.sent,this.typeList=n[0].datas,this.forgList=n[1].datas,this.factoryList=n[1].datas.filter((function(t){return t.orgType&&"工厂"===t.orgType.dname})),this.eqpList=this.toEqpTree(n[2].datas);case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getChatInfo:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,a,s,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="",e=Array.isArray(this.id)?this.id[0]||"":(this.id,this.id),i=this.$Server.queryAll("RepairStatis",null,{startDate:this.startDate,endDate:this.endDate,statisDimension:this.statisDimension,content:"维修工时统计",objectId:e,timeDimension:this.timeDimension}).catch(o["a"].alert),t.next=5,i;case 5:a=t.sent,s=a.datas[0].repariTaskTime,this.xAxis1=s.map((function(t){return t.itemName})),this.yAxis1=s.map((function(t){return t.itemValue})),this.initChatOne(this.xAxis1,this.yAxis1),n=a.datas[0].repariTaskTimeDetails,n.length>7&&(n.length=7),this.xAxis2=n.map((function(t){return t.itemName})),this.yAxis2=n.map((function(t){return t.itemValue})),r=a.datas[0].repariTaskTimeDetailsPotal,r.length>7&&(n.length=7),this.yAxis2_1=r.map((function(t){return t.itemValue})),this.initChatTwo(this.xAxis2,this.yAxis2,this.yAxis2_1);case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getChat2Info:function(){var t=this,e="";e=Array.isArray(this.id)?this.id[0]||"":(this.id,this.id),this.$Server.queryAll("RepairStatis",null,{startDate:this.startDate,endDate:this.endDate,statisDimension:this.statisDimension,content:"人员工时统计",objectId:e,timeDimension:this.timeDimension}).then((function(e){var i=e.datas[0].personTaskTime;t.xAxis3=i.map((function(t){return t.itemName})),t.yAxis3=i.map((function(t){return t.itemValue})),t.initChatThree(t.xAxis3,t.yAxis3)})).catch(o["a"].alert),this.$Server.queryAll("RepairStatis",null,{startDate:this.startDate,endDate:this.endDate,statisDimension:this.statisDimension,content:"平均故障时间统计",objectId:e,timeDimension:this.timeDimension}).then((function(e){var i=e.datas[0].avgStopTime;i.length>7&&(i.length=7),t.xAxis4=i.map((function(t){return t.itemName})),t.yAxis4=i.map((function(t){return t.itemValue}));var a=e.datas[0].avgStopTimePotal;t.yAxis4_1=a.map((function(t){return t.itemValue})),t.initChatFour(t.xAxis4,t.yAxis4,t.yAxis4_1)})).catch(o["a"].alert),this.$Server.queryAll("RepairStatis",null,{startDate:this.startDate,endDate:this.endDate,statisDimension:this.statisDimension,content:"维保对比统计",objectId:e,timeDimension:this.timeDimension,statisContent:this.statisContent}).then((function(e){var i=e.datas[0].maintainCountOrTime,a=e.datas[0].repairCountOrTime,s=e.datas[0].secondRepairCountOrTime;t.xAxis5=i.map((function(t){return t.itemName})),t.series5_1=i.map((function(t){return t.itemValue})),t.series5_2=a.map((function(t){return t.itemValue})),t.series5_3=s.map((function(t){return t.itemValue})),t.initChatFive(t.xAxis5,t.series5_1,t.series5_2,t.series5_3)})).catch(o["a"].alert)},handleStatisContentChange:function(){var t=this,e="";e=Array.isArray(this.id)?this.id[0]:(this.id,this.id),this.$Server.queryAll("RepairStatis",null,{startDate:this.startDate,endDate:this.endDate,statisDimension:this.statisDimension,content:"维保对比统计",objectId:e,timeDimension:this.timeDimension,statisContent:this.statisContent}).then((function(e){var i=e.datas[0].maintainCountOrTime,a=e.datas[0].repairCountOrTime,s=e.datas[0].secondRepairCountOrTime;t.xAxis5=i.map((function(t){return t.itemName})),t.series5_1=i.map((function(t){return t.itemValue})),t.series5_2=a.map((function(t){return t.itemValue})),t.series5_3=s.map((function(t){return t.itemValue})),t.initChatFive(t.xAxis5,t.series5_1,t.series5_2,t.series5_3)})).catch(o["a"].alert)},toEqpTree:function(t){var e=[],i=[];if(t.forEach((function(t){void 0==t.eType||null==t.eType||0==t.eType.length?(t.typeChinese="无",e.push(t)):e.push(t),-1==i.indexOf(t.eType)&&(void 0==t.eType||null==t.eType||0==t.eType.length?i.includes("无")||i.push("无"):i.push(t.eType))})),i.forEach((function(t,i){e.push({name:t,id:i+1,parentId:-1,isshow:!1})})),void 0==t||null==t||0==t.length);else{t.forEach((function(t){t.name=t.nameAndModel}));for(var a=0;a<e.length;a++)for(var s=0;s<e.length;s++)if(e[a].eType==e[s].name){e[a].parentId=e[s].id;break}}return e}},mounted:function(){var t=this;this.initChat(),this.getCondition().then((function(e){t.getChatInfo(),t.getChat2Info()}))}},v=x,b=(i("8243"),i("6691")),y=Object(b["a"])(v,a,s,!1,null,"665f4836",null);e["default"]=y.exports},8243:function(t,e,i){"use strict";var a=i("9671"),s=i.n(a);s.a},9671:function(t,e,i){},b188:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-menu",{attrs:{"offset-overflow":"","full-width":"",disabled:t.disabled,"close-on-content-click":!1},model:{value:t.showMenu,callback:function(e){t.showMenu=e},expression:"showMenu"}},[i("v-text-field",{attrs:{slot:"activator",label:t.label,"append-icon":"arrow_drop_down",value:t.textValueStr,disabled:t.disabled,clearable:"",readonly:"",rules:t.getRules(t.requireVaild)},on:{"click:clear":function(e){return t.clearfield()}},slot:"activator",scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n        "+t._s(t.label)+" "),t.requireVaild?i("span",{staticStyle:{color:"red"}},[t._v("*")]):t._e()]},proxy:!0}])}),i("v-list",[i("v-text-field",{staticStyle:{width:"97%",margin:"0px auto 12px auto"},attrs:{label:"查询","hide-details":"","single-line":"",primary:"",clearable:"","append-icon":"fa-search"},on:{"click:clear":t.clearMessage,"click:append":t.doSearch},model:{value:t.searchfx,callback:function(e){t.searchfx=e},expression:"searchfx"}}),i("treeView",{ref:"childTreeView",attrs:{Source:t.searchSource,MultipleSelect:t.MultipleSelect,independentCheck:t.independentCheck,independentSingleCheck:t.independentSingleCheck,IsTree:t.IsTree},on:{SelectChanged:t.selectChanged}})],1)],1)},s=[],n=(i("bada"),i("4634"),i("8062"),i("fafd"),i("a9b1"),i("7cfd"),i("ff4f")),r=i("d5b3"),o={name:"treeComboForLastNode",data:function(){return{showMenu:!1,treeValues:[],activeValue:[],selectedItem:[],IsShow:!1,textValueStr:"",requireVaild:"",searchfx:"",searchSource:[]}},components:{treeView:n["a"]},watch:{value:{handler:function(t,e){void 0!=t&&(this.textValueStr=this.getTextValueStr(t),this.$refs.childTreeView.setSelectItems(t))}},Source:{handler:function(t){this.searchSource=t},immediate:!0}},computed:{},mounted:function(){this.requireVaild=this.require},methods:{familyTree:function(t,e){var i=[],a=function e(a,s){for(var n=0;n<a.length;n++){var r=a[n];if(r.id==s){i.push(r),e(t,r.parentId);break}r.children&&e(r.children,s)}};return a(t,e),i},clearMessage:function(){var t=this;t.searchfx="",t.searchSource=t.Source},doSearch:function(){var t=this;if(t.searchfx.length>0){for(var e=[],i=0;i<t.Source.length;i++){var a=[];t.Source[i].name.indexOf(t.searchfx)>-1&&(a=t.familyTree(t.Source,t.Source[i].id),e=e.concat(e,a))}this.searchSource=Array.from(new Set(e))}else t.searchSource=t.Source},getRules:function(t){return t?[function(t){return t&&""!=t||"必填项"}]:void 0},clearfield:function(){this.$refs.childTreeView.clearfield(),this.$emit("cleared")},getTextValueStr:function(t){var e=this;Array.isArray(t)||(t=[t]);var i=this;if(t&&t.length){var a=t.map((function(t){if(!t)return"";var a={};if(a=1==e.IsTree?e.Source.find((function(e){return e.id==t&&"-1"!=e.parentId})):e.Source.find((function(e){return e.id==t})),a&&a.name)return a.name;i.$Console.error("未找到已保存的关联id："+t)}));return a.join("，")}},selectChanged:function(t){if(t&&t.length>0){var e=this.Source.find((function(e){return e.id==t[0]}));e&&e.orgType&&this.nodeValue.indexOf(e.orgType.dvalue)>-1?(this.textValueStr=this.getTextValueStr(t),this.$emit("input",t)):1==this.nodeValue?r["a"].alert("只能选择车间"):5==this.nodeValue?r["a"].alert("只能选择产线"):"1,2"==this.nodeValue||"2,1"==this.nodeValue?r["a"].alert("只能选择车间或设备仓库"):"5,7"!=this.nodeValue&&"7,5"!=thi.nodeValue||r["a"].alert("只能选择产线或库位")}else this.textValueStr=this.getTextValueStr(t),this.$emit("input",t)},setActiveVaules:function(){this.clearMessage(),this.$refs.childTreeView.setActiveVaules(),this.$refs.childTreeView.clearfield()}},props:["label","Source","MultipleSelect","independentCheck","value","independentSingleCheck","require","disabled","IsTree","nodeValue"]},l=o,c=i("6691"),h=Object(c["a"])(l,a,s,!1,null,null,null);e["a"]=h.exports}}]);