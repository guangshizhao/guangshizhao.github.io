(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cbacb0d"],{"25c2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("layContentHeader",{attrs:{title:"知识库",buttons:e.headerBtns}},[a("v-text-field",{staticStyle:{width:"260px"},attrs:{label:"请输入标题或作者","hide-details":"","single-line":"",primary:"",clearable:""},on:{"click:clear":e.clearMessage},scopedSlots:e._u([{key:"append-outer",fn:function(){return[a("v-icon",{on:{click:function(t){return e.doSearch()}}},[e._v("search")])]},proxy:!0}]),model:{value:e.searchfx,callback:function(t){e.searchfx=t},expression:"searchfx"}})],1),a("layContent",[a("v-layout",[a("layContentLeft",{attrs:{title:"知识分类",id:"layoutLeft"}},[a("div",{staticStyle:{height:"calc(100% - 63px)"}},[a("div",{staticClass:"selfvuetree",staticStyle:{margin:"0px"},attrs:{id:"tree"}},[a("v-tree",{ref:"childTreeView",attrs:{data:e.treeSource,radio:!0},on:{"node-select":e.selectChanged}})],1)])]),a("layContentRight",[a("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,sort:e.sort,DataSource:e.DataSource,hideOperation:!0,formatFields:e.formatFields,total:e.total},on:{initialize:e.initTable,rowDbClick:e.rowDbClick}}),a("contentModal",{attrs:{title:e.title,IsShow:e.IsShowForCategory,width:"1100"},on:{modalClosed:function(t){return e.modalClosedForCategory()},modalComfirmed:function(t){return e.modalComfirmedForCategory()}}},[a("knowledgeCategoryDetail",{ref:"addOrUpdateForCategory",attrs:{item:e.detailForCategoryUpdate}})],1),a("contentModal",{attrs:{title:e.title,IsShow:e.IsShow,width:"1100",cancelDrag:!0},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[a("knowledgeDetail",{ref:"addOrUpdate",attrs:{item:e.detailForUpdate}})],1),a("contentModal",{attrs:{title:e.titleForSee,IsShow:e.IsShowForSee,width:"1100",isDetails:!0},on:{modalClosed:function(t){return e.modalClosedForSee()}}},[a("knowledgeSee",{ref:"See",attrs:{item:e.detailForUpdate},on:{updatelist:e.updatelist}})],1)],1)],1)],1)],1)},r=[],n=(a("7cfd"),a("4634"),a("3596")),o=(a("de90"),a("7300")),l=a("5873"),s=a("ddf2"),c=a("80ea"),d=a("ae0a"),u=a("97a3"),f=a("652a"),h=a("1269"),m=new f["a"],p=function(e){function t(){var e,a;Object(o["a"])(this,t);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return a=Object(l["a"])(this,(e=Object(s["a"])(t)).call.apply(e,[this].concat(r))),Object(u["a"])(Object(c["a"])(a),"__name","Knowledge"),Object(u["a"])(Object(c["a"])(a),"title",m.charField({require:!0,fieldName:"标题"})),Object(u["a"])(Object(c["a"])(a),"categoryName",m.charField({require:!0,fieldName:"所属分类"})),Object(u["a"])(Object(c["a"])(a),"author",m.charField({require:!0,fieldName:"作者"})),Object(u["a"])(Object(c["a"])(a),"files",m.charField({require:!0,fieldName:"相关文件"})),a}return Object(d["a"])(t,e),t}(h["a"]),g=a("d5b3"),b=a("8333"),v=a("a2a7"),w=a("f05f"),y=a("681f"),F=a("8c84"),O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{rules:[function(e){return e+="",""!=e.replace(/\s/g,"")||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                            知识分类名称"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}})],1)],1)],1)],1)],1)},S=[],D={name:"knowledgeCategoryDetail",data:function(){return{valid:!0}},components:{},created:function(){},computed:{},props:["item"],methods:{validate:function(){return 1==this.$refs.form.validate()}}},C=D,j=a("6691"),I=Object(j["a"])(C,O,S,!1,null,"529c895f",null),x=I.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs1:""}},[e._v("标题：")]),a("v-flex",{attrs:{xs11:""}},[e._v(e._s(e.item.title))]),a("v-flex",{attrs:{xs1:""}},[e._v("所属分类：")]),a("v-flex",{attrs:{xs11:""}},[e._v(e._s(e.getCategoryName))]),a("v-flex",{attrs:{xs12:""}},[a("quill-editor",{ref:"quillEditor",attrs:{options:e.editorOption},model:{value:e.item.content,callback:function(t){e.$set(e.item,"content",t)},expression:"item.content"}})],1),e.item.knowledgeDocumentList&&e.item.knowledgeDocumentList.length>0?a("v-flex",{attrs:{xs12:""}},[a("span",{staticStyle:{"font-weight":"bold",width:"100%"}},[e._v("上传附件:")])]):e._e(),a("v-flex",{attrs:{xs12:""}},e._l(e.item.knowledgeDocumentList,(function(t,i){return e.item.knowledgeDocumentList&&e.item.knowledgeDocumentList.length>0?a("v-layout",{key:t.id,attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("span",{staticClass:"filename"},[e._v(e._s(t.documentViewModel.dname))]),a("v-btn",{attrs:{color:"primary",small:""},on:{click:function(a){return e.updateDocument(t.documentViewModel)}}},[e._v("更新")]),a("v-btn",{attrs:{color:"primary",small:""},on:{click:function(a){return e.preHistory(t.documentID)}}},[e._v("历史版本")])],1)],1):e._e()})),1)],1)],1),a("contentModal",{attrs:{title:"更新文档",IsShow:e.UpdateIsShow},on:{modalClosed:function(t){return e.docUploadCancel()},modalComfirmed:function(t){return e.docUploadComfirmed()}}},[e._v("\n        "+e._s(e.uploadNotifyText)+"\n        "),a("v-progress-linear",{attrs:{active:e.progressShow},model:{value:e.progressValue,callback:function(t){e.progressValue=t},expression:"progressValue"}}),a("v-container",{attrs:{"grid-list-md":""}},[a("v-form",{ref:"form"},[a("v-text-field",{attrs:{label:"文件名字","prepend-icon":"edit"},model:{value:e.inputFileName,callback:function(t){e.inputFileName=t},expression:"inputFileName"}}),a("v-text-field",{attrs:{label:"更新描述","prepend-icon":"edit"},model:{value:e.docuDescription,callback:function(t){e.docuDescription=t},expression:"docuDescription"}}),a("v-text-field",{attrs:{"prepend-icon":"edit",prefix:"V",rules:[function(e){return!e||/^\d+$/.test(e)||/^\d+(\.\d+)+$/.test(e)||"只能是数字或者小数点！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                        版本号"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.userVersion,callback:function(t){e.userVersion=t},expression:"userVersion"}}),a("fileUploader",{ref:"fileUploader",attrs:{label:"请选择文件",name:"docuFile",disabled:e.fileUploaderDisabled},on:{formData:e.getFormData}}),a("p",[e._v("文档命名规则："+e._s(e.codeRull))])],1)],1)],1),a("contentModal",{attrs:{title:"历史版本",IsShow:e.HistoryIsShow,isDetails:!0},on:{modalClosed:function(t){e.HistoryIsShow=!1}}},[a("document-version",{ref:"getDocumentVersionList",on:{preView:e.preViewContainer}})],1),a("viewer",{staticClass:"images images-viewer",attrs:{options:e.viewerOptions},on:{inited:e.inited}},[a("img",{attrs:{src:e.imageSrc,"data-source":e.imageSrc}})]),a("contentModal",{attrs:{title:"视频播放",IsShow:e.VideoIsShow,isDetails:!0},on:{modalClosed:function(t){return e.videoComfirmed()}}},[a("video-player",{ref:"videoPlayer",staticClass:"vjs-custom-skin",attrs:{options:e.playerOptions,playsinline:!0}})],1)],1)},$=[],k=(a("e6d1"),a("c041"),a("2d09"),a("ac2c")),V=a.n(k),T=a("e248"),_=(a("48b0"),a("6e6d")),U=a("b881"),q=(a("121a"),a("7e41"),a("96be"),a("6696")),E=a("b013"),P=a("2907"),A=a("5cbc");_["default"].use(V.a),a("48b0"),a("7100");var M=new b["a"](new A["a"]),L={name:"knowledgeSee",data:function(){return{valid:!0,categorys:[],editorOption:{placeholder:"请填写内容",readOnly:!0},UpdateIsShow:!1,progressValue:0,progressShow:!1,inputFileName:"",docuDescription:"",userVersion:"",fileUploaderDisabled:!1,codeRull:"",uploadNotifyText:"",uploadFile:null,_documentServer:{},HistoryIsShow:!1,imageSrc:"",viewerOptions:{inline:!1,navbar:!1},VideoIsShow:!1,playerOptions:{language:"zh-CN",playbackRates:[.7,1,1.5,2],sources:[{type:"video/mp4",src:"http://vjs.zencdn.net/v/oceans.mp4"}],poster:"https://avatars0.githubusercontent.com/u/24718510?s=460&v=4"},player:null}},components:{quillEditor:U["quillEditor"],fileUploader:q["a"],contentModal:v["a"],documentVersion:P["a"],videoPlayer:T["videoPlayer"]},created:function(){var e=this;e.$Server.queryAll("KnowledgeCategory").then((function(t){e.categorys=t.datas})),e.$Server.queryAll("CodeRule",{},{codeType:40}).then((function(t){t.datas&&t.datas[0]&&(e.codeRull=t.datas[0].joinModifiers)})),e._documentServer=new E["a"]},mounted:function(){this.$refs.quillEditor.quill.container.style.height="".concat(200,"px"),this.$refs.quillEditor.quill.enable(!1)},computed:{getCategoryName:function(){for(var e="",t=this,a=0;a<t.categorys.length;a++)if(t.categorys[a].id==t.item.categoryID){e=t.categorys[a].name;break}return e}},props:["item"],methods:{videoComfirmed:function(){this.VideoIsShow=!1,this.$refs.videoPlayer.player.pause()},inited:function(e){this.$viewer=e},preHistory:function(e){e?(this.$refs.getDocumentVersionList.initialize(e),this.HistoryIsShow=!0):g["a"].alert("未获取到文档信息！")},preViewContainer:function(e,t,a){var i=this;if(".png"==e||".gif"==e||".jpg"==e||".bmp"==e||".jpeg"==e)i.imageSrc=t,i.$viewer.show();else if(".mp4"==e)i.playerOptions.sources[0].src=t,i.VideoIsShow=!0;else if(".pdf"==e)window.open(t);else if(".doc"==e||".docx"==e||".ppt"==e||".pptx"==e){var r=t.replace(/documents/g,"documents/ToPdf"),n=r.split(".");n[2]="pdf",window.open(n.join("."))}else if(".xls"==e||".xlsx"==e){var o=t.replace(/documents/g,"documents/ToPdf"),l=o.split(".");l[2]="pdf",window.open(l.join("."))}else g["a"].alert("暂不提供改类型文件在线预览！")},updateDocument:function(e){this.dataTableSelectItem=e,this.UpdateIsShow=!0},clearFileInput:function(){this.$refs.fileUploader.clearFile()},docUploadCancel:function(){this.clearFileInput(),this.$refs.form.reset(),this.progressValue=0,this.progressShow=!1,this.uploadNotifyText="",this.docuDescription="",this.inputFileName="",this.uploadFile=null,this.UpdateIsShow=!1,this.fileUploaderDisabled=!1},docUploadComfirmed:function(){var e=this;if(e.$refs.form.validate()){var t=e.uploadFile,a=this.dataTableSelectItem,i={};t?(e.uploadNotifyText="正在处理文件……",e.fileUploaderDisabled=!0,e._documentServer.getBase64(t).then((function(r){i=JSON.parse(JSON.stringify(a)),i.id=a.id,i.docuFile=r,i.dname=t.name,i.docuDescription=e.docuDescription,i.newestFileExt="."+i.dname.split(".")[1],i.userVersion=e.userVersion,e.uploadNotifyText="文件处理成功，开始上传……",""!=e.inputFileName&&(i.dname=e.inputFileName+t.name.substring(t.name.lastIndexOf("."))),e.$Server.addOrUpdate(M.getModelName(),i,!0).then((function(t){if(t.success){var i=t.model;i.dname&&(a.dname=i.dname),i.docuDescription&&(a.docuDescription=i.docuDescription),i.updateTime&&(a.updateTime=i.updateTime),i.newestFileId&&(a.newestFileId=i.newestFileId),i.newestFileExt&&(a.newestFileExt=i.newestFileExt),i.newestFilePath&&(a.newestFilePath=i.newestFilePath),i.newestVersion&&(a.newestVersion=i.newestVersion),i.newestFileSize&&(a.newestFileSize=i.newestFileSize),e.docUploadCancel(),e.$emit("updatelist"),g["a"].alert("文件上传成功","success")}}),(function(e){return g["a"].alert(e)}))}))):g["a"].alert("请上传文件！")}},getFormData:function(e){var t=this,a=t.dataTableSelectItem;if(e&&a&&a.id){var i=e.get("data");if(i){if(i.size>=51380224)return void g["a"].alert("文件大小超过系统上限！");var r=i.name.substring(i.name.lastIndexOf(".")+1,i.name.length);if("cmd"==r||"exe"==r||"bat"==r||"com"==r||"vbs"==r)return void g["a"].alert("禁止上传该类型的文件！");t.uploadNotifyText="",t.progressValue=0,t.progressShow=!1,t.uploadFile=i}else g["a"].alert("请选择需要更新的指定文档行数据！")}}}},z=L,H=(a("72be"),Object(j["a"])(z,N,$,!1,null,"5a5f5a8c",null)),B=H.exports,K=(a("debc"),new b["a"](new p)),J={name:"knowledge",data:function(){var e=this;return{initObject:{id:"",title:"",content:"",categoryID:[],knowledgeDocumentList:[{documentViewModel:{}}]},searchfx:"",sort:!0,total:1,DataSource:[],title:"",IsShow:!1,IsAddOp:!0,detailForUpdate:{},detailForCategoryUpdate:{},treeSource:[],IsAddOpForCategory:!0,selectNode:{},titleForSee:"查看知识详情",IsShowForSee:!1,IsShowForCategory:!1,headerBtns:[{disabled:!this.$per("KnowledgeCategory","c"),text:"添加知识分类",icon:"self_add",click:function(){return e.tableAddForCategory()}},{disabled:!this.$per("KnowledgeCategory","u"),text:"编辑知识分类",icon:"self_edit",click:function(){return e.tableEditForCategory()}},{disabled:!this.$per("KnowledgeCategory","d"),text:"删除知识分类",icon:"self_delete",click:function(){return e.tableDeleteForCategory()}},{disabled:!this.$per("Knowledge","c"),text:"添加知识",icon:"self_add",click:function(){return e.tableAdd()}},{disabled:!this.$per("Knowledge","u"),text:"编辑知识",icon:"self_edit",click:function(){return e.tableEdit()}},{disabled:!this.$per("Knowledge","d"),text:"删除知识",icon:"self_delete",click:function(){return e.tableDelete()}}],IsSearch:!1}},computed:{headers:function(){var e=K.formatGridHeader();return!0===this.sort&&e.unshift({text:"序号",align:"center",sortable:!1}),e},formatFields:function(){return K.getFormatFields()}},components:{contentModal:v["a"],dataTable:w["a"],knowledgeDetail:F["a"],knowledgeCategoryDetail:x,knowledgeSee:B},mounted:function(){var e=this;document.addEventListener("click",(function(t){var a=document.getElementById("tree"),i=document.getElementById("layoutLeft");a&&!a.contains(t.target)&&i&&i.contains(t.target)&&e.$nextTick((function(){e.$refs.childTreeView&&e.$refs.childTreeView.nodeSelected({})}))}))},created:function(){this.treeInit()},methods:{modalClosedForSee:function(){this.IsShowForSee=!1},rowDbClick:function(e){this.detailForUpdate=JSON.parse(JSON.stringify(e)),this.titleForSee="查看知识详情",this.IsShowForSee=!0},treeObj:function(e){var t={};for(var a in e){var i=e[a];t[a]="object"===Object(n["a"])(i)?arguments.callee(i):i}return t["children"]=[],t},setTree:function(e){for(var t=e,a=[],i=this,r=0;r<t.length;r++)""!==t[r].parentID&&null!==t[r].parentID&&"-1"!==t[r].parentID||(a.push(i.treeObj(t[r])),t.splice(r,1),r--);function n(e){if(0!==t.length)for(var a=0;a<e.length;a++){for(var r=0;r<t.length;r++)if(e[a].id===t[r].parentID){var o=i.treeObj(t[r]);e[a].children.push(o),t.splice(r,1),r--}n(e[a].children)}}return n(a),a},treeInit:function(){var e=this;e.$Server.queryAll("KnowledgeCategory").then((function(t){if(t.datas&&t.datas.length>0){var a=[];t.datas.forEach((function(e){var t={};t.id=e.id,t.title=e.name,t.name=e.name,t.parentID=e.parentID?e.parentID:"",t.expanded=!0,t.rootNode=e.rootNode?e.rootNode:"",a.push(t)})),e.treeSource=e.setTree(a),e.$nextTick((function(){e.$refs.childTreeView&&e.$refs.childTreeView.nodeSelected({})}))}}))},selectChanged:function(e){this.selectNode=e,this.initTable()},tableAddForCategory:function(){this.resetForm(),this.IsAddOpForCategory=!0;var e={name:"",parentID:"",rootNode:""};this.selectNode.id&&(e.parentID=this.selectNode.id,e.rootNode=this.selectNode.rootNode),this.detailForCategoryUpdate=Object.assign({},e),this.title="添加知识分类",this.IsShowForCategory=!0},tableEditForCategory:function(){var e=this;e.resetFormValidation(),e.IsAddOpForCategory=!1,e.title="编辑知识分类",e.selectNode&&e.selectNode.id?(e.detailForCategoryUpdate=Object.assign({},e.selectNode),e.IsShowForCategory=!0):g["a"].alert("请选择一项作为你修改的对象")},modalComfirmedForCategory:function(){var e=this;1==e.$refs.addOrUpdateForCategory.validate()&&e.$Server.addOrUpdate("KnowledgeCategory",e.detailForCategoryUpdate,!e.IsAddOpForCategory).then((function(t){t.success&&(e.IsShowForCategory=!1,e.treeInit(),g["a"].alert("保存成功","success"),e.resetForm())}),(function(e){g["a"].alert(e)}))},modalClosedForCategory:function(){this.IsShowForCategory=!1,this.resetForm()},tableDeleteForCategory:function(){var e=this;if(e.selectNode&&e.selectNode.id){if(e.selectNode.children&&e.selectNode.children.length>0)return void g["a"].alert("当前节点下有子节点，不能被删除！");y["a"].confirm("确定删除所选知识分类?","提示",500,(function(){e.cofirmDeleteForCategory()}),(function(){}))}else g["a"].alert("请选中需要删除的对象")},cofirmDeleteForCategory:function(){var e=this;e.$Server.delete("KnowledgeCategory",e.selectNode).then((function(){e.treeInit()}),(function(e){g["a"].alert(e)}))},tableAdd:function(){this.resetForm(),this.IsAddOp=!0,this.selectNode&&this.selectNode.id&&(this.initObject.categoryID=[this.selectNode.id]),this.initObject.knowledgeDocumentList=[],this.detailForUpdate=JSON.parse(JSON.stringify(this.initObject)),this.title="添加知识",this.IsShow=!0},tableEdit:function(){var e=this;if(e.resetFormValidation(),e.IsAddOp=!1,e.title="编辑知识",1!=e.$refs.childDataTable.getCheckItems().length)g["a"].alert("请选择一项作为你修改的对象");else{var t=e.$refs.childDataTable.getCheckItems()[0];null==t.knowledgeDocumentList&&(t.knowledgeDocumentList=[]),e.$refs.addOrUpdate.setEditor(t.content),e.detailForUpdate=JSON.parse(JSON.stringify(t)),e.IsShow=!0}},updatelist:function(){this.doSearch()},doSearch:function(){var e=this.$refs.childDataTable.getPagination();this.searchfx&&this.searchfx.length>0&&(this.IsSearch=!0),1==e.page?this.initTable(e):this.$refs.childDataTable.setPage(1)},clearMessage:function(){this.searchfx="",this.IsSearch=!1,this.doSearch()},initTable:function(e){var t=this;e&&e.page||(e=t.$refs.childDataTable.getPagination());var a="";0==t.IsSearch&&t.selectNode&&t.selectNode.id&&(a=t.selectNode.id),t.$Server.queryAll(K.getModelName(),{page:e.page,rowsPerPage:e.rowsPerPage},{searchfx:t.searchfx,categoryID:a}).then((function(e){t.$refs.childDataTable.unCheckItems(),t.DataSource=e.datas,t.DataSource.forEach((function(e){if(e.categoryID&&(e.categoryID=[e.categoryID]),e.knowledgeDocumentList){var t=[];e.knowledgeDocumentList.forEach((function(e){e.documentViewModel&&(e.documentViewModel.dname=e.documentViewModel.dname+e.documentViewModel.newestFileExt,t.push(e.documentViewModel.dname))})),e.files=t}})),t.total=e.page.total}),(function(e){}))},modalComfirmed:function(){var e=this;1==e.$refs.addOrUpdate.validate()&&(e.detailForUpdate.categoryID&&Array.isArray(e.detailForUpdate.categoryID)&&(e.detailForUpdate.categoryID=e.detailForUpdate.categoryID[0]),e.$Server.addOrUpdate(K.getModelName(),e.detailForUpdate,!e.IsAddOp).then((function(t){t.success&&(e.IsShow=!1,e.initTable(),g["a"].alert("保存成功","success"),e.resetForm())}),(function(e){g["a"].alert(e)})))},modalClosed:function(){this.IsShow=!1,this.resetForm()},resetFormValidation:function(){this.$refs.addOrUpdateForCategory.$refs.form.resetValidation(),this.$refs.addOrUpdate.$refs.form.resetValidation()},resetForm:function(){this.$refs.addOrUpdate.$refs.form.reset(),this.$refs.addOrUpdate.$refs.form.resetValidation(),this.$refs.addOrUpdateForCategory.$refs.form.reset(),this.$refs.addOrUpdateForCategory.$refs.form.resetValidation(),this.$refs.addOrUpdate.clearEditor()},cofirmDelete:function(){var e=this,t=this.$refs.childDataTable.getCheckItems();e.$Server.batchDelete(K.getModelName(),t).then((function(){e.initTable()}),(function(e){g["a"].alert(e)}))},tableDelete:function(){var e=this;e.$refs.childDataTable.getCheckItems().length<=0?g["a"].alert("请选中需要删除的对象"):y["a"].confirm("确定删除所选知识?","提示",500,(function(){e.cofirmDelete()}),(function(){}))}}},R=J,G=Object(j["a"])(R,i,r,!1,null,null,null);t["default"]=G.exports},2907:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("layContentHeader",{attrs:{buttons:e.docuVersionHeaderBtns}}),a("layContent",[a("v-layout",[a("layContentRight",[a("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,DataSource:e.DocumentversionDataSource,allowActive:!1,total:e.DocumentversionTotalDatas,hideOperation:!0}})],1)],1)],1)],1)},r=[],n=(a("e6d1"),a("b013")),o=a("7300"),l=a("5873"),s=a("ddf2"),c=a("80ea"),d=a("ae0a"),u=a("97a3"),f=a("652a"),h=a("1269"),m=new f["a"],p=function(e){function t(){var e,a;Object(o["a"])(this,t);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return a=Object(l["a"])(this,(e=Object(s["a"])(t)).call.apply(e,[this].concat(r))),Object(u["a"])(Object(c["a"])(a),"__name","Documentversion"),Object(u["a"])(Object(c["a"])(a),"fileName",m.charField({require:!0,fieldName:"文档名称"})),Object(u["a"])(Object(c["a"])(a),"creatorName",m.charField({require:!0,fieldName:"上传人"})),Object(u["a"])(Object(c["a"])(a),"description",m.charField({require:!0,fieldName:"描述"})),Object(u["a"])(Object(c["a"])(a),"version",m.charField({require:!0,fieldName:"版本"})),Object(u["a"])(Object(c["a"])(a),"documentId",m.charField({require:!0,fieldName:"文档id",visible:!1})),Object(u["a"])(Object(c["a"])(a),"filePath",m.charField({require:!0,fieldName:"文件路径",visible:!1})),Object(u["a"])(Object(c["a"])(a),"fileExt",m.charField({require:!0,fieldName:"文件后缀",visible:!1})),Object(u["a"])(Object(c["a"])(a),"fileSize",m.charField({require:!0,fieldName:"文件大小",visible:!1})),Object(u["a"])(Object(c["a"])(a),"creatorLoginName",m.charField({require:!0,fieldName:"上传人工号",visible:!1})),a}return Object(d["a"])(t,e),t}(h["a"]),g=a("8333"),b=a("f05f"),v=a("1e17"),w=a("07c5"),y=a("adf0"),F=a("d5b3"),O=new g["a"](new p),S={name:"documentVersion",components:{dataTable:b["a"],layContent:v["a"],layContentHeader:w["a"],layContentRight:y["a"]},data:function(){var e=this;return{docuVersionHeaderBtns:[{text:"下载",icon:"self_download",click:function(){return e.downloadDV()}},{text:"查看",icon:"self_see",click:function(){return e.preViewDV()}}],IsShow:!1,IsComfirmShow:!1,IsLoading:!0,DocumentversionDataSource:[],DocumentversionTotalDatas:1,temporary:{},documentVersionServer:{},headers:[{text:"文档名称",value:"fileName",align:"center",sortable:!1},{text:"上传人",value:"creatorName",align:"center",sortable:!1},{text:"描述",value:"description",align:"center",sortable:!1},{text:"创建日期",value:"createdTime",align:"center",sortable:!1},{text:"版本",value:"userVersion",align:"center",sortable:!1}]}},mounted:function(){this._documentVersionServer=new n["a"],this.initialize()},methods:{initialize:function(e){var t=this;e&&this.$Server.queryAll(O.getModelName(),this.$refs.childDataTable.getPagination(),{documentId:e}).then((function(e){t.$refs.childDataTable.unCheckItems(),t.DocumentversionDataSource=e.datas,t.DocumentversionTotalDatas=e.page.total}),(function(e){return F["a"].alert(e)}))},downloadDV:function(){var e=this.$refs.childDataTable.getCheckItems();if(null!=e&&1==e.length){var t=e[0],a=document.createElement("a");a.href=t.filePath;var i=t.filePath.split("/");a.download=i[i.length-1],a.click()}else F["a"].alert("请选择一个需要下载的文档！")},preViewDV:function(){var e=this.$refs.childDataTable.getCheckItems();if(null!=e&&1==e.length){var t=e[0];t&&t.id?this.$emit("preView",t.fileExt,t.filePath,t.fileSize):F["a"].alert("没有获取到该数据的文档信息！")}else F["a"].alert("请选择需要查看的文档！")}}},D=S,C=a("6691"),j=Object(C["a"])(D,i,r,!1,null,"23795565",null);t["a"]=j.exports},"5cbc":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a("7300"),r=a("5873"),n=a("ddf2"),o=a("80ea"),l=a("ae0a"),s=a("97a3"),c=a("652a"),d=a("1269"),u=new c["a"],f=function(e){function t(){var e,a;Object(i["a"])(this,t);for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];return a=Object(r["a"])(this,(e=Object(n["a"])(t)).call.apply(e,[this].concat(c))),Object(s["a"])(Object(o["a"])(a),"__name","Document"),Object(s["a"])(Object(o["a"])(a),"docuCode",u.charField({require:!0,fieldName:"文档编号"})),Object(s["a"])(Object(o["a"])(a),"dname",u.charField({require:!0,fieldName:"文档名称"})),Object(s["a"])(Object(o["a"])(a),"creatorName",u.charField({require:!0,fieldName:"上传人"})),Object(s["a"])(Object(o["a"])(a),"docuDescription",u.charField({require:!0,fieldName:"描述"})),Object(s["a"])(Object(o["a"])(a),"newestDate",u.charField({require:!0,fieldName:"最后更新日期"})),Object(s["a"])(Object(o["a"])(a),"newestVersion",u.charField({require:!0,fieldName:"最新版本"})),Object(s["a"])(Object(o["a"])(a),"category",u.charField({require:!0,fieldName:"类别",visible:!1})),Object(s["a"])(Object(o["a"])(a),"creatorLoginName",u.charField({require:!0,fieldName:"上传人工号",visible:!1})),Object(s["a"])(Object(o["a"])(a),"newestFileId",u.charField({require:!0,fieldName:"最新文件id",visible:!1})),Object(s["a"])(Object(o["a"])(a),"newestFileExt",u.charField({require:!0,fieldName:"最新文件后缀",visible:!1})),Object(s["a"])(Object(o["a"])(a),"newestFilePath",u.charField({require:!0,fieldName:"最新文件路径",visible:!1})),Object(s["a"])(Object(o["a"])(a),"newestFileSize",u.charField({require:!0,fieldName:"最新文件大小",visible:!1})),Object(s["a"])(Object(o["a"])(a),"docuFile",u.charField({require:!0,fieldName:"最新文件流",visible:!1})),a}return Object(l["a"])(t,e),t}(d["a"])},6696:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-text-field",{ref:"fileTextField",attrs:{"prepend-icon":"attach_file","single-line":"",label:e.label,required:e.required,disabled:e.disabled},nativeOn:{click:function(t){return e.onFocus(t)}},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),a("input",{ref:"fileInput",attrs:{type:"file",accept:e.accept,name:e.name,multiple:e.multiple,disabled:e.disabled},on:{change:e.onFileChange}})],1)},r=[],n=(a("e6d1"),a("7cfd"),a("dea4")),o=(a("4634"),{props:{value:{type:[Array,String]},accept:{type:String,default:"*"},label:{type:String,default:"Please choose..."},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},name:{type:String,default:"files"}},data:function(){return{filename:""}},watch:{value:function(e){this.filename=e}},mounted:function(){this.filename=this.value},methods:{getFormData:function(e){var t=new FormData;return Object(n["a"])(e).forEach((function(e){t.append("data",e,e.name)})),t},onFocus:function(){this.disabled||this.$refs.fileInput.click()},onFileChange:function(e){var t=e.target.files||e.dataTransfer.files,a=this.getFormData(t);t?t.length>0?this.filename=Object(n["a"])(t).map((function(e){return e.name})).join(", "):this.filename=null:this.filename=e.target.value.split("\\").pop(),this.$emit("input",this.filename),this.$emit("formData",a)},clearFile:function(){this.filename="",this.$refs.fileInput.value=""}}}),l=o,s=(a("904b"),a("6691")),c=Object(s["a"])(l,i,r,!1,null,"40907837",null);t["a"]=c.exports},"6d30":function(e,t,a){},7100:function(e,t,a){},"72be":function(e,t,a){"use strict";var i=a("6d30"),r=a.n(i);r.a},"7db8":function(e,t,a){},"904b":function(e,t,a){"use strict";var i=a("7db8"),r=a.n(i);r.a},b013:function(e,t,a){"use strict";var i=a("7300"),r=a("e9e3"),n=a("5873"),o=a("ddf2"),l=a("ae0a"),s=a("b490"),c=a("f753"),d=a.n(c),u=a("531b"),f=function(e){function t(){return Object(i["a"])(this,t),Object(n["a"])(this,Object(o["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(r["a"])(t,[{key:"uploadDocument",value:function(e,a,i){return new Promise((function(r,n){var o=new t;o&&(i.progressShow=!0,d.a.put(o.apiUrl+"/"+a+"?t="+Date.now(),e,{onUploadProgress:function(e){i.progressValue=parseInt(Math.round(100*e.loaded/e.total))}}).then((function(e){e.data.code?n(e.msg):r(e.data),i.progressShow=!1})).catch((function(e){n(e.message)})))}))}},{key:"downloadDocument",value:function(e){var a=new t;if(a){var i=document.createElement("a");i.style.display="none",i.href=a.apiUrl+"/Documentversion/"+e+"?t="+Date.now(),i.setAttribute("download",""),document.body.appendChild(i),i.click()}}},{key:"validateFileName",value:function(e,a){var i=new t;return new Promise((function(t,r){var n=i.apiUrl+"/"+e+"/"+a+"?t="+Date.now();u["a"].http(n,"GET",null,{success:function(e){t(e.data)},error:function(e){r(e.msg)}})}))}},{key:"getBase64",value:function(e){return new Promise((function(t,a){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return a(e)}}))}}]),t}(s["a"]);t["a"]=f}}]);