(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e1722276"],{"0c10":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-form",{ref:"form1",attrs:{"lazy-validation":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{label:"取消原因",rules:[e.rules.required]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                            取消原因: "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.cancelReason,callback:function(t){e.$set(e.item,"cancelReason",t)},expression:"item.cancelReason"}})],1)],1)],1)],1)],1)},n=[],s=(a("d5b3"),{name:"CancelTask",data:function(){return{rules:{required:function(e){return!!e||"必填项"}}}},props:["item"],methods:{validate:function(){return 1==this.$refs.form1.validate()},resetValid:function(){this.$refs.form1.resetValidation(),this.$refs.form1.reset()}}}),r=s,o=a("6691"),l=Object(o["a"])(r,i,n,!1,null,"058eafcc",null);t["a"]=l.exports},"0da4":function(e,t,a){"use strict";var i=a("60d5"),n=a.n(i);n.a},"5aa8":function(e,t,a){"use strict";var i=a("b696"),n=a.n(i);n.a},"60d5":function(e,t,a){},"99e9":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("layContentHeader",{attrs:{title:"培训管理",buttons:e.headerBtns}},[a("v-text-field",{staticStyle:{width:"260px"},attrs:{label:"输入地点或负责人","hide-details":"","single-line":"",primary:"",clearable:""},on:{"click:clear":e.clearMessage},scopedSlots:e._u([{key:"append-outer",fn:function(){return[a("v-icon",{on:{click:function(t){return e.doSearch()}}},[e._v("search")])]},proxy:!0}]),model:{value:e.searchfx,callback:function(t){e.searchfx=t},expression:"searchfx"}})],1),a("layContent",[a("div",[a("v-btn",{class:{primary:1===e.clickIndex},attrs:{small:""},on:{click:e.getAllData}},[e._v("全部")]),a("v-btn",{class:{primary:2===e.clickIndex},attrs:{small:""},on:{click:e.getLaunchData}},[e._v("我发起的")]),a("v-btn",{class:{primary:3===e.clickIndex},attrs:{small:""},on:{click:e.getParticipateData}},[e._v("我参与的")])],1),a("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,sort:e.sort,DataSource:e.DataSource,hideOperation:!0,formatFields:e.formatFields,total:e.total},on:{rowDbClick:e.rowDbClick,initialize:e.initTable}}),a("contentModal",{attrs:{title:e.title,IsAddOp:e.IsAddOp,IsShow:e.IsShow,width:"1100",isDetails:e.isSee},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[a("trainingDetail",{ref:"addOrUpdate",attrs:{isSee:e.isSee,item:e.detailForUpdate}})],1),a("contentModal",{attrs:{title:"填写培训结论",IsShow:e.IsShowConclusion,isSubmit:!0,width:"1100"},on:{modalClosed:e.modalClosedConclusion,modalStorageClosed:e.modalStorageClosed,modalSubmit:e.modalSubmitJoin}},[e.IsShowConclusion?a("trainingEditResult",{ref:"SeeConclusion",attrs:{item:e.detailForUpdate,dataSource:e.trainingPersonList}}):e._e()],1),a("contentModal",{attrs:{title:"查看培训结果",IsShow:e.IsShowConclusionDetail,isDetails:!0,width:"1100"},on:{modalComfirmed:e.modalComfirmedDetail,modalClosed:e.modalClosedDetail}},[e.IsShowConclusionDetail?a("trainingTeacherResult",{ref:"SeeDetail",attrs:{item:e.detailForUpdate,dataSource:e.trainingPersonList}}):e._e()],1),a("contentModal",{attrs:{title:"培训结果",IsShow:e.IsShowForSeeResult,width:"1100",isDetails:!0},on:{modalClosed:function(t){return e.modalClosedForSeeResult()}}},[e.IsShowForSeeResult?a("trainingSelfResult",{ref:"SeeResult",attrs:{item:e.detailForUpdate,dataSource:e.trainingPersonList}}):e._e()],1),a("trainingSign",{attrs:{title:"签到通知",IsShow:e.IsShowSign,width:"500",item:e.detailForUpdate},on:{modalConfim:function(t){return e.modalConfimSign()},modalClosed:function(t){return e.modalClosedSign()},modalClosedJoin:function(t){return e.modalClosedJoinSign()}}}),a("trainingNotice",{attrs:{title:"考核通知",IsShow:e.IsShowNotice,width:"500",item:e.detailForUpdate},on:{modalConfim:function(t){return e.modalConfimNotice()},modalClosed:function(t){return e.modalClosedNotice()}}}),a("contentModal",{attrs:{title:"取消原因",IsShow:e.IsShowCancelTask,width:"1100"},on:{modalComfirmed:function(t){return e.modalComfirmedCancelTask()},modalClosed:function(t){return e.modalClosedCancelTask()}}},[a("CancelTask",{ref:"CancelTask",attrs:{item:e.detailForUpdate}})],1)],1)],1)},n=[],s=(a("4634"),a("e6d1"),a("de90"),a("0b34"),a("97a3")),r=a("0c10"),o=a("7300"),l=a("5873"),c=a("ddf2"),d=a("80ea"),u=a("ae0a"),m=a("652a"),h=a("1269"),f=new m["a"],g=function(e){function t(){var e,a;Object(o["a"])(this,t);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return a=Object(l["a"])(this,(e=Object(c["a"])(t)).call.apply(e,[this].concat(n))),Object(s["a"])(Object(d["a"])(a),"__name","Training"),Object(s["a"])(Object(d["a"])(a),"code",f.charField({fieldName:"培训单编号"})),Object(s["a"])(Object(d["a"])(a),"trainingBeginTime",f.charField({fieldName:"培训时间",format:function(e){if(e)return e.substring(0,10)}})),Object(s["a"])(Object(d["a"])(a),"trainingLocation",f.charField({fieldName:"培训地点"})),Object(s["a"])(Object(d["a"])(a),"assignedUser",f.charField({fieldName:"负责人",visible:!1})),Object(s["a"])(Object(d["a"])(a),"assignedUserName",f.charField({fieldName:"负责人"})),Object(s["a"])(Object(d["a"])(a),"content",f.charField({fieldName:"培训内容"})),Object(s["a"])(Object(d["a"])(a),"material",f.charField({fieldName:"培训材料"})),Object(s["a"])(Object(d["a"])(a),"examine",f.charField({fieldName:"是否考核",visible:!1})),Object(s["a"])(Object(d["a"])(a),"examineString",f.charField({fieldName:"是否考核"})),Object(s["a"])(Object(d["a"])(a),"state",f.comboBoxField(null,{require:!1,fieldName:"状态",editable:!1,visible:!1,format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),Object(s["a"])(Object(d["a"])(a),"stateName",f.charField({require:!1,fieldName:"状态"})),a}return Object(u["a"])(t,e),t}(h["a"]),p=a("d5b3"),v=a("8333"),S=a("a2a7"),b=a("f05f"),x=a("681f"),I=a("531b"),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训单编号："+e._s(e.item.code))])]),a("v-flex",{attrs:{xs8:""}},[a("p",[e._v("培训时间："+e._s(e.item.trainingBeginTime)+" - "+e._s(e.item.trainingEndTime)+" ")])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("负责人："+e._s(e.item.assignedUserName))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训地点："+e._s(e.item.trainingLocation))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训内容："+e._s(e.item.content))])])],1),a("v-layout",[a("v-flex",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.dataSource,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.jobNumber))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.personName))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.org))]),a("td",{staticClass:"text-xs-center"},[a("v-select",{attrs:{"item-text":"dname","item-value":"dvalue",items:e.examineResultData,rules:[function(e){return e&&null!==e.dname||"必填项"}],"return-object":""},on:{change:e.t1,input:e.t2},model:{value:t.item.examineResult,callback:function(a){e.$set(t.item,"examineResult",a)},expression:"props.item.examineResult"}})],1),a("td",{staticClass:"text-xs-center"},[a("v-select",{attrs:{"item-text":"dname","item-value":"dvalue",items:e.checkinRresultData,"return-object":""},model:{value:t.item.checkinRresult,callback:function(a){e.$set(t.item,"checkinRresult",a)},expression:"props.item.checkinRresult"}})],1),a("td",{staticClass:"text-xs-center"},[a("v-textarea",{model:{value:t.item.evaluation,callback:function(a){e.$set(t.item,"evaluation",a)},expression:"props.item.evaluation"}})],1)]}}])})],1)],1)],1)],1)},k=[],C={name:"trainingEditResult",data:function(){return{valid:!0,headers:[{text:"人员工号",value:"code",align:"center",sortable:!1},{text:"人员姓名",value:"name",align:"center",sortable:!1},{text:"所属部门",value:"department",align:"center",sortable:!1},{text:"考核结果",value:"examineResult",align:"center",sortable:!1},{text:"签到结果",value:"checkinResult",align:"center",sortable:!1},{text:"培训评价",value:"evaluation",align:"center",sortable:!1}],items:[{code:12,name:"还哈",department:"sfs",examineResult:0,checkinResult:1,evaluation:"fsfe"}],id:"",checkinRresultData:[],examineResultData:[]}},mounted:function(){var e=this;e.$Server.queryAll("Datadict",null,{dname:"签到结果"}).then((function(t){e.checkinRresultData=t.datas})),e.$Server.queryAll("Datadict",null,{dname:"考核结果"}).then((function(t){e.examineResultData=t.datas}))},methods:{t1:function(){console.log("t1")},t2:function(){console.log("t2")}},props:["item","dataSource"]},D=C,T=a("6691"),L=Object(T["a"])(D,w,k,!1,null,null,null),P=L.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-layout",[a("p",{staticClass:"title"},[e._v("培训基本信息")])]),a("v-layout",{staticStyle:{"margin-left":"20px"},attrs:{wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训单编号："+e._s(e.item.code))])]),a("v-flex",{attrs:{xs8:""}},[a("p",[e._v("培训时间："+e._s(e.item.trainingBeginTime)+" - "+e._s(e.item.trainingEndTime)+" ")])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("负责人："+e._s(e.item.assignedUserName))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训地点："+e._s(e.item.trainingLocation))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训内容："+e._s(e.item.content))])])],1),a("v-layout",[a("p",{staticClass:"title"},[e._v("培训结果")])]),a("v-layout",{staticStyle:{"margin-left":"20px"},attrs:{wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("人员工号："+e._s(e.dataSource.jobNumber))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("人员姓名："+e._s(e.dataSource.personName))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("所属部门："+e._s(e.dataSource.org))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("考核结果："+e._s(e.dataSource.examineResult&&e.dataSource.examineResult.dname))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("签到结果："+e._s(e.dataSource.checkinRresult&&e.dataSource.checkinRresult.dname))])]),a("v-flex",{attrs:{xs12:""}},[e._v("\n            评价结果："+e._s(e.dataSource.evaluation)+"\n        ")])],1)],1)},$=[],y={name:"trainingSelfResult",data:function(){return{}},props:["item","dataSource"]},U=y,F=Object(T["a"])(U,_,$,!1,null,null,null),O=F.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训单编号："+e._s(e.item.code))])]),a("v-flex",{attrs:{xs8:""}},[a("p",[e._v("培训时间："+e._s(e.item.trainingBeginTime)+" - "+e._s(e.item.trainingEndTime)+" ")])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("负责人："+e._s(e.item.assignedUserName))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训地点："+e._s(e.item.trainingLocation))])]),a("v-flex",{attrs:{xs4:""}},[a("p",[e._v("培训内容："+e._s(e.item.content))])])],1),a("v-layout",[a("v-flex",{attrs:{xs5:""}},[a("v-layout",{attrs:{"align-center":""}},[a("span",[e._v("人员工号：")]),a("v-select",{attrs:{items:e.userItems,"item-text":"jobNumber","item-value":"personID",clearable:""},on:{change:e.changeUserId},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}})],1)],1)],1),a("v-layout",[a("v-flex",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.dataSourceList,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.jobNumber))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.personName))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.org))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.examineResult&&t.item.examineResult.dname))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.checkinRresult&&t.item.checkinRresult.dname))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.evaluation))])]}}])})],1)],1)],1)},M=[],R={name:"trainingTeacherResult",data:function(){return{headers:[{text:"人员工号",value:"code",align:"center",sortable:!1},{text:"人员姓名",value:"name",align:"center",sortable:!1},{text:"所属部门",value:"department",align:"center",sortable:!1},{text:"考核结果",value:"examineResult",align:"center",sortable:!1},{text:"签到结果",value:"checkinResult",align:"center",sortable:!1},{text:"培训评价",value:"evaluation",align:"center",sortable:!1}],items:[{code:12,name:"还哈",department:"sfs",examineResult:0,checkinResult:1,evaluation:"fsfe"}],id:"",userId:"",userItems:[],dataSourceList:[]}},watch:{dataSource:function(e,t){this.userItems=this.dataSource,this.dataSourceList=this.dataSource}},methods:{changeUserId:function(){var e=this;this.dataSourceList=this.dataSource.filter((function(t){return t.personID===e.userId})),0==this.dataSourceList.length&&(this.dataSourceList=this.dataSource)}},props:["item","dataSource"]},j=R,V=Object(T["a"])(j,N,M,!1,null,null,null),A=V.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.IsShow?a("v-dialog",{attrs:{persistent:!0,scrollable:"",width:e.width?e.width:1e3,"content-class":"selfdialog"},model:{value:e.IsShow,callback:function(t){e.IsShow=t},expression:"IsShow"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v(e._s(e.title))]),a("v-spacer"),a("v-btn",{attrs:{icon:"",dark:"",flat:""},on:{click:e.modalClosed}},[a("v-icon",[e._v("close")])],1)],1),a("v-card-text",[e._t("default"),a("div",[e._v(e._s(e.userName)+":")]),a("div",{staticStyle:{"text-indent":"2em"}},[e._v("您好,"+e._s(e.item.trainingBeginTime&&e.item.trainingBeginTime.substring(0,16))+"举行的"+e._s(e.item.trainingNode)+"即将开始，请确认到场并进行签到")])],2),a("v-card-actions",{staticClass:"marginbottom"},[a("v-spacer"),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.modalConfim()}}},[e._v("签到")]),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.modalClosedJoin()}}},[e._v("不参与")])],1)],1)],1):e._e()},J=[],q={name:"trainingSign",data:function(){return{userName:sessionStorage.getItem("uname")}},created:function(){},methods:{modalConfim:function(){this.$emit("modalConfim")},modalClosed:function(){this.$emit("modalClosed")},modalClosedJoin:function(){this.$emit("modalClosedJoin")}},props:["title","IsShow","width","item"]},B=q,z=(a("cd47"),Object(T["a"])(B,E,J,!1,null,"0ef4c789",null)),K=z.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.IsShow?a("v-dialog",{attrs:{persistent:!0,scrollable:"",width:e.width?e.width:1e3,"content-class":"selfdialog"},model:{value:e.IsShow,callback:function(t){e.IsShow=t},expression:"IsShow"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v(e._s(e.title))]),a("v-spacer"),a("v-btn",{attrs:{icon:"",dark:"",flat:""},on:{click:e.modalClosed}},[a("v-icon",[e._v("close")])],1)],1),a("v-card-text",[e._t("default"),a("div",[e._v(e._s(e.userName)+":")]),a("div",{staticStyle:{"text-indent":"2em"}},[e._v("您好,"+e._s(e.item.trainingBeginTime&&e.item.trainingBeginTime.substring(0,16))+"举行的"+e._s(e.item.trainingNode)+"已结束，是否发起线上考核")])],2),a("v-card-actions",{staticClass:"marginbottom"},[a("v-spacer"),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.modalConfim()}}},[e._v("发起线上考核")]),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.modalClosed()}}},[e._v("取消")])],1)],1)],1):e._e()},G=[],H={name:"trainingNotice",data:function(){return{userName:sessionStorage.getItem("uname")}},created:function(){},methods:{modalConfim:function(){this.$emit("modalConfim")},modalClosed:function(){this.$emit("modalClosed")}},props:["title","IsShow","width","item"]},Q=H,W=(a("0da4"),Object(T["a"])(Q,Y,G,!1,null,"7b5f0794",null)),X=W.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-text-field",{attrs:{label:"培训单编号",disabled:e.isSee,rules:[function(e){return!e||/^[\w|-]+$/.test(e)||"只能是数字,字母,下划线"}]},model:{value:e.item.code,callback:function(t){e.$set(e.item,"code",t)},expression:"item.code"}})],1),a("v-flex",{attrs:{xs4:""}},[a("v-datetime-picker",{attrs:{label:"培训开始时间",clearText:"",okText:"确定",rules:[function(e){return!!e||"必填项"}],prependIcon:"star",model:"String",disabled:e.isSee,locale:"zh-cn"},model:{value:e.item.trainingBeginTime,callback:function(t){e.$set(e.item,"trainingBeginTime",t)},expression:"item.trainingBeginTime"}})],1),a("v-flex",{attrs:{xs4:""}},[a("v-datetime-picker",{attrs:{label:"培训结束时间",clearText:"",okText:"确定",rules:[function(e){return!!e||"必填项"}],prependIcon:"star",model:"String",disabled:e.isSee,locale:"zh-cn"},model:{value:e.item.trainingEndTime,callback:function(t){e.$set(e.item,"trainingEndTime",t)},expression:"item.trainingEndTime"}})],1),a("v-flex",{attrs:{xs4:""}},[a("v-text-field",{attrs:{disabled:e.isSee,rules:[function(e){return!!e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n              培训地点"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.trainingLocation,callback:function(t){e.$set(e.item,"trainingLocation",t)},expression:"item.trainingLocation"}})],1),a("v-flex",{attrs:{xs4:""}},[a("selectUser",{ref:"selectUser",attrs:{value:e.item.assignedUserName,disabled:e.isSee,required:!0,label:"负责人",multiple:!1,initselect:1},on:{changeValue:e.changeValueUser}})],1),a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{label:"培训内容",disabled:e.isSee},model:{value:e.item.content,callback:function(t){e.$set(e.item,"content",t)},expression:"item.content"}})],1),a("v-flex",{attrs:{xs12:""}},[a("div",[a("span",[e._v("培训材料:")])]),a("v-layout",{staticStyle:{"margin-left":"10px"},attrs:{"align-center":""}},[a("span",[e._v("从本地选择:")]),a("v-icon",{attrs:{disabled:e.isSee},on:{click:function(t){return e.item.documentList.push({})}}},[e._v("add")])],1)],1),a("v-flex",{attrs:{xs12:""}},e._l(e.item.documentList,(function(t,i){return a("v-layout",{key:i,style:e.selectLocation.includes(t)?"background: #E3F2FD":"",attrs:{"align-center":"",row:"",wrap:""},on:{click:function(a){return e.getClick(t,i)}}},[a("v-flex",{attrs:{xs10:""}},[a("fileUploader",{ref:"uploadFile",refInFor:!0,attrs:{label:"上传附件",multiple:!1,fileNames:t.documentViewModel&&t.documentViewModel.dname,uploadBase64:!1,ndisabled:e.isSee,userVersion:t},on:{formData:e.getFormData},model:{value:t.documentViewModel,callback:function(a){e.$set(t,"documentViewModel",a)},expression:"doc.documentViewModel"}})],1),a("v-flex",{attrs:{xs2:""}},[a("v-icon",{on:{click:function(t){return e.item.documentList.splice(i,1)}}},[e._v("delete")]),a("v-btn",{attrs:{small:"",color:"primary",disabled:e.isSee},on:{click:function(a){return e.handleSyncKnowledge(t)}}},[e._v("同步到知识库")])],1)],1)})),1),a("v-flex",{staticStyle:{"padding-left":"10px"},attrs:{xs12:""}},[a("div",[e._v("从知识库选择:"),a("v-icon",{attrs:{disabled:e.isSee},on:{click:e.handleGetFileList}},[e._v("add")])],1),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.item.knowList,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.categoryName))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.dname))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.userVersion))]),a("td",{staticClass:"text-xs-center"},[a("v-icon",{on:{click:function(a){return e.item.knowList.splice(t.index,1)}}},[e._v("delete")])],1)]}}])})],1),a("v-flex",{staticStyle:{"margin-bottom":"15px"},attrs:{xs12:""}}),a("v-flex",{attrs:{xs4:""}},[a("v-layout",{attrs:{"align-center":""}},[a("span",[e._v("是否考核:"),a("span",{staticStyle:{color:"red","margin-right":"5px"}},[e._v("*")])]),a("v-radio-group",{attrs:{disabled:e.isSee,row:"",rules:[function(e){return""!==e||"必填项"}]},on:{change:e.handleExamineChange},model:{value:e.item.examine,callback:function(t){e.$set(e.item,"examine",t)},expression:"item.examine"}},[a("v-radio",{attrs:{label:"是",value:!0}}),a("v-radio",{attrs:{label:"否",value:!1}})],1)],1)],1),a("v-flex",{attrs:{xs4:""}},[e.isShowExameDate?a("v-datetime-picker",{attrs:{label:"考核时间",clearText:"",okText:"确定",rules:[function(t){return e.isToday||new Date(t)>new Date||"必须大于当前时间"}],prependIcon:"star",disabled:e.isSee,model:"String",locale:"zh-cn"},model:{value:e.item.examineTime,callback:function(t){e.$set(e.item,"examineTime",t)},expression:"item.examineTime"}}):e._e()],1),a("v-flex",{attrs:{xs4:""}}),a("v-flex",{attrs:{xs4:""}},[a("treeCombo",{ref:"treeCombo",attrs:{require:!0,Source:e.positionList,MultipleSelect:!1,label:"培训岗位",disabled:e.isSee,independentCheck:!1,independentSingleCheck:!0,"return-object":""},on:{changeSelected:e.changeSelected},model:{value:e.selfPositionId,callback:function(t){e.selfPositionId=t},expression:"selfPositionId"}})],1),a("v-flex",{attrs:{xs4:""}},[a("v-select",{attrs:{"item-text":"sname",disabled:e.isSee,"item-value":"skillID",items:e.positionSkillList,rules:[function(e){return!!e||"必填项"}]},on:{change:e.handelSkillIDChange},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n              培训技能"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.skillID,callback:function(t){e.$set(e.item,"skillID",t)},expression:"item.skillID"}})],1),a("v-flex",{attrs:{xs4:""}},[a("v-select",{attrs:{"item-text":"trainingNode",disabled:e.isSee,"item-value":"id",items:e.traningPathList,rules:[function(e){return!!e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n              培训课程"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.item.trainingPathDetailID,callback:function(t){e.$set(e.item,"trainingPathDetailID",t)},expression:"item.trainingPathDetailID"}})],1)],1),a("v-layout",{staticStyle:{"margin-top":"25px",border:"1px solid #ccc","border-radius":"5px"},attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("div",{staticStyle:{overflow:"hidden","margin-top":"15px"}},[a("div",{staticStyle:{float:"left","font-weight":"bold"}},[e._v("预约人员：")]),a("div",{staticStyle:{overflow:"hidden"}},e._l(e.item.reservationPersonNameList,(function(t,i){return a("span",{key:i,staticStyle:{"margin-right":"15px"}},[e._v(e._s(t))])})),0)]),a("div",{staticStyle:{overflow:"hidden","margin-top":"15px"}},[a("div",{staticStyle:{float:"left","font-weight":"bold"}},[e._v("应参与人员：")]),a("div",{staticStyle:{overflow:"hidden"}},e._l(e.participantPersonList.map((function(e){return e.uname})),(function(t,i){return a("span",{key:i,staticStyle:{"margin-right":"15px"}},[e._v(e._s(t))])})),0)]),a("v-layout",[a("v-flex",{attrs:{xs12:""}},[a("selectUser",{ref:"selectUser1",attrs:{value:e.item.otherPersonNameList,required:!1,label:"其他人员",multiple:!0,initselect:e.item.otherArr,disabled:e.isSee}})],1)],1)],1)],1)],1),e.isSee?a("div",[a("div",{staticStyle:{overflow:"hidden","margin-top":"5px",border:"1px solid #ccc","border-radius":"5px",padding:"10px 5px",margin:"15px -4px 0"}},[a("b",{staticStyle:{float:"left"}},[e._v("实际参与人员：")]),a("div",{staticStyle:{overflow:"hidden"}},e._l(e.item.actualParticipantNameList,(function(t,i){return a("span",{key:i,staticStyle:{"margin-right":"15px"}},[e._v(e._s(t))])})),0)])]):e._e()],1),a("contentModal",{attrs:{title:"添加知识",IsShow:e.IsShow,width:"1100",cancelDrag:!0},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[a("knowlddgeDetail",{ref:"addOrUpdate",attrs:{item:e.detailForUpdate}})],1),a("contentModal",{attrs:{title:"选择文件",IsShow:e.IsShowFileList,width:"1100"},on:{modalClosed:function(t){return e.modalClosedFile()},modalComfirmed:function(t){return e.modalComfirmedFile()}}},[a("simpleDataTable",{ref:"childDataTable",attrs:{headers:e.headers1,hideHeaders:!1,sort:!0,items:e.fileList,allowActive:!0,hideOperation:!0}})],1)],1)},ee=[],te=(a("8062"),a("fafd"),a("a9b1"),a("bada"),a("63ff"),a("f8f9")),ae=a("1d53"),ie=a("1d18"),ne=a("2c75"),se=a("a1de"),re=a("3876"),oe=a("8c84"),le=a("f19a"),ce=a("ef3e"),de=a("6bf2"),ue=a.n(de),me=(a("49a5"),new v["a"](new ne["a"]),{name:"TrainingDetail",data:function(){return{today:ue()(new Date).format("YYYY-MM-DD"),initObject:{id:"",title:"",content:"",categoryID:[],knowledgeDocumentList:[{documentViewModel:{}}]},detailForUpdate:{},IsShow:!1,valid:!0,inventoryTypes:[],inventoryDimensions:[],test:"",test1:null,isToday:!1,selectLocation:[],deleteIndex:"",headers:[{text:"所属分类",value:"categoryName",align:"center",sortable:!1},{text:"文件名称",value:"dname",align:"center",sortable:!1},{text:"版本号",value:"userVersion",align:"center",sortable:!1},{text:"操作",value:"opertion",align:"center",sortable:!1}],headers1:[{text:"所属分类",value:"categoryName",align:"center",sortable:!1},{text:"文件名称",value:"dname",align:"center",sortable:!1},{text:"版本号",value:"userVersion",align:"center",sortable:!1}],positionList:[],positionSkillList:[],traningPathList:[],selfPositionId:[],IsShowFileList:!1,fileList:[],selfKnowList:[],first:!0,isShowExameDate:!1,positionList1:[],participantPersonList:[],tempPartList:[],pFlag:""}},components:{datePicker:ae["a"],selectUser:ie["a"],fileUploader:se["a"],uploadFile2:re["a"],knowlddgeDetail:oe["a"],contentModal:S["a"],treeCombo:le["a"],simpleDataTable:ce["a"]},watch:{selfPositionId:function(e,t){Array.isArray(e)&&e.length>0&&e[0]?(this.item.positionID=e[0],Array.isArray(t)&&t.length>0&&t[0]&&e[0]!==t[0]&&(this.item.skillID="",this.item.trainingPathDetailID="")):Array.isArray(e)&&0===e.length&&(this.item.positionID="",this.item.positionName="")},"item.positionID":function(e){if(e){if(this.selfPositionId&&this.selfPositionId[0]&&e===this.selfPositionId[0])return;this.selfPositionId=[this.item.positionID]}else this.selfPositionId=[]},"item.skillID":function(e){var t=this;e&&e.length>0&&this.$Server.queryAll("TrainingPath",{},{positionSkillID:e}).then((function(e){t.first=!1,e.datas&&e.datas[0]&&e.datas[0].pathDetailList?t.traningPathList=e.datas[0].pathDetailList:t.traningPathList=[]}))},"item.trainingPathDetailID":function(e){var t=this;e&&e.length>0?(this.setParticipateList(e),this.$Server.queryAll("TrainingAppointment",{},{detailId:e}).then((function(e){t.item.reservationPersonNameList=e.datas.map((function(e){return e.userViewModel.uname})),t.item.reservationPersonList=e.datas.map((function(e){return e.userViewModel.id}))}),(function(e){return p["a"].alert(e)}))):""==e&&(t.item.reservationPersonNameList=[],t.item.reservationPersonList=[])}},created:function(){var e=this;this.$Server.queryAll("Organization",{},{position:"position"}).then((function(t){t.datas&&t.datas.length>0&&(e.positionList=t.datas,e.positionList.length>0&&e.positionList.forEach((function(t){t.IsPosition=!1,t.positionList&&t.positionList.forEach((function(t){t.IsPosition=!0,e.positionList.push(t),e.positionList1.push(t)}))})))}))},computed:{},props:["item","IsAddOp","isSee"],methods:{getParticipants:function(){var e=Object(te["a"])(regeneratorRuntime.mark((function e(t,a){var i,n,s,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=this,n=i.$Server.queryAll("UserPosition",{},{positionId:t}).catch((function(e){return p["a"].alert(e)})),s=i.$Server.queryAll("TrainingPath",{},{positionSkillID:a}).catch(p["a"].alert),e.next=5,n;case 5:return r=e.sent,e.next=8,s;case 8:o=e.sent,console.log(r),r.datas&&(i.tempPartList=r.datas),o.datas&&o.datas[0]&&o.datas[0].pathDetailList?i.traningPathList=o.datas[0].pathDetailList:i.traningPathList=[];case 12:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),validate:function(){if(1==this.$refs.form.validate()){if(this.item.trainingBeginTime>=this.item.trainingEndTime)return p["a"].alert("开始时间不能大于等于结束时间！"),!1;var e=this.$refs.selectUser1.getselectUserList();return e&&e.length>0?(this.item.otherPersonList=e.map((function(e){return e.id})),this.item.otherPersonNameList=e.map((function(e){return e.uname}))):(this.item.otherPersonList=[],this.item.otherPersonNameList=[]),!0}return!1},setParticipateList:function(e){var t=this,a=t.traningPathList.find((function(t){return t.id===e}));if(console.log(a),a){var i=a.trainingPersonList||[];a.inTrainPersons&&(i=i.concat(a.inTrainPersons));var n=Array.from(new Set(i.map((function(e){return e.personID}))));if(n.length>0){var s=[];t.tempPartList.forEach((function(e){-1==n.indexOf(e.userId)&&s.push(e)})),t.participantPersonList=s,t.item.participantList=t.participantPersonList.map((function(e){return e.userId}))}else t.participantPersonList=t.tempPartList,t.item.participantList=t.tempPartList.map((function(e){return e.userId}))}else t.participantPersonList=t.tempPartList,t.item.participantList=t.tempPartList.map((function(e){return e.userId}))},addUpload:function(){this.item.documentList.push({documentViewModel:{}})},getFormData:function(e){},deleteItem:function(e){this.item.documentList.splice(e,1)},handleChooseDay:function(e){"today"===e?(this.isToday=!0,this.item.examineTime=new Date):"notToday"===e&&(this.item.examineTime=null,this.isToday=!1)},getClick:function(e,t){this.selectLocation=[],this.selectLocation.push(e),this.deleteIndex=t},handleExamineChange:function(e){this.isShowExameDate=e,e||this.item.examineTime&&(this.item.examineTime="")},handleSyncKnowledge:function(e){this.$refs.addOrUpdate.$refs.form.resetValidation(),this.$refs.addOrUpdate.clearEditor(),e.documentViewModel&&e.documentViewModel.dname?(this.initObject.knowledgeDocumentList=[e],this.detailForUpdate=JSON.parse(JSON.stringify(this.initObject)),this.IsShow=!0):p["a"].alert("文件不能为空")},modalClosed:function(){this.IsShow=!1},modalComfirmed:function(){var e=this;1==e.$refs.addOrUpdate.validate()&&(e.detailForUpdate.categoryID&&Array.isArray(e.detailForUpdate.categoryID)&&(e.detailForUpdate.categoryID=e.detailForUpdate.categoryID[0]),e.$Server.addOrUpdate("Knowledge",e.detailForUpdate,!1).then((function(t){t.success&&(e.IsShow=!1,p["a"].alert("保存成功","success"))}),(function(e){p["a"].alert(e)})))},changeSelected:function(e){var t=this;if(e&&e.length>0){var a=this.positionList.filter((function(t){return t.id==e[0]&&1==t.IsPosition}));if(a&&a.length>0)if(Array.isArray(e)&&e.length>0&&e[0]){var i=this.positionList.find((function(t){return t.id===e[0]}));i&&i.positionSkillList&&i.positionSkillList.length>0?this.positionSkillList=i.positionSkillList:this.positionSkillList=[],t.$Server.queryAll("UserPosition",{},{positionId:e[0]}).then((function(e){e.datas&&(t.tempPartList=e.datas)})).catch((function(e){return p["a"].alert(e)}))}else Array.isArray(e)&&0===e.length&&(t.item.skillID="",t.positionSkillList=[],t.item.trainingPathDetailID="",t.traningPathList=[],t.participantPersonList=[],t.item.participantList=[]);else this.$refs.treeCombo.setActiveVaules()}},handelSkillIDChange:function(){var e=this;e.item.trainingPathDetailID&&(e.item.trainingPathDetailID="",e.item.reservationPersonNameList=[],e.item.reservationPersonList=[])},handleSkillChange:function(e){var t=this;e&&e.length>0&&this.$Server.queryAll("TrainingPath",{},{positionSkillID:e}).then((function(e){e.datas&&e.datas[0]&&e.datas[0].pathDetailList?t.traningPathList=e.datas[0].pathDetailList:t.traningPathList=[]}))},trainingPathDetailIDChange:function(e){var t=this;this.$Server.queryAll("TrainingAppointment",{},{detailId:e}).then((function(e){t.item.reservationPersonNameList=e.datas.map((function(e){return e.userViewModel.uname})),t.item.reservationPersonList=e.datas.map((function(e){return e.userViewModel.id}))}),(function(e){return p["a"].alert(e)}))},handleGetFileList:function(){var e=this;this.IsShowFileList=!0,this.$Server.queryAll("RKnowledgeDocument").then((function(t){e.fileList=t.datas}))},modalClosedFile:function(){this.IsShowFileList=!1},modalComfirmedFile:function(){var e=this.$refs.childDataTable.getCheckItems();this.item.knowList=e,this.IsShowFileList=!1},changeValueUser:function(e){e.length>0?(this.item.assignedUser=e[0].id,this.item.assignedUserName=e[0].uname):e.length},changeValue:function(e){e.length>0?(this.item.otherPersonList=e.map((function(e){return e.id})),this.item.otherPersonNameList=e.map((function(e){return e.uname}))):e.length}}}),he=me,fe=Object(T["a"])(he,Z,ee,!1,null,"3b8a7526",null),ge=fe.exports,pe=new v["a"](new g),ve={name:"Training",data:function(){var e,t=this;return{initObject:(e={id:"",code:"",trainingBeginTime:"",trainingEndTime:"",trainingLocation:"",assignedUser:"",assignedUserName:"",content:"",examine:"",isExamineString:"",examineTime:null,positionID:"",skillID:"",trainingPathDetailID:"",documentList:[],knowList:[],reservationPersonList:[],reservationPersonNameList:[],participantList:[],participantNameList:[]},Object(s["a"])(e,"participantNameList",[]),Object(s["a"])(e,"otherPersonList",[]),Object(s["a"])(e,"otherPersonNameList",[]),Object(s["a"])(e,"actualParticipantList",[]),Object(s["a"])(e,"actualParticipantNameList",[]),Object(s["a"])(e,"trainingPersonList",[]),e),IsShowCancelTask:!1,searchfx:"",sort:!0,total:1,DataSource:[],DataSource1:[],DataSource2:[],DataSource3:[],clickIndex:1,title:"",IsShow:!1,IsAddOp:!0,isSee:!1,detailForUpdate:{},IsShowForSee:!1,IsShowNotice:!1,IsShowConclusionDetail:!1,titleForSee:"",trainingPerson:{},trainingPersonList:[],headerBtns:[{disabled:!this.$per("Training","c"),text:"添加",icon:"self_add",click:function(){return t.tableAdd()}},{disabled:!this.$per("Training","u"),text:"编辑",icon:"self_edit",click:function(){return t.tableEdit()}},{disabled:!this.$per("Training","d"),text:"删除",icon:"self_delete",click:function(){return t.tableDelete()}},{disabled:!this.$per("Training","exe"),text:"执行",icon:"self_execute",click:function(){return t.excuteTask()}},{disabled:!this.$per("Training","cancel"),text:"取消",icon:"self_cancel",click:function(){return t.cancelTask()}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/Training"==e.pvalue&&"发起考核"==e.pname}))),text:"发起考核",icon:"self_chargeperson",click:function(){return t.showConclusion()}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/Training"==e.pvalue&&"填写结论"==e.pname}))),text:"填写结论",icon:"self_chargeperson",click:function(){return t.editConclusion()}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/Training"==e.pvalue&&"签到"==e.pname}))),text:"签到",icon:"self_selectiontask",click:function(){return t.handleCheckIn()}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/Training"==e.pvalue&&"查看结果"==e.pname}))),text:"查看结果",icon:"self_look",click:function(){return t.showResult()}}],IsShowForSeeResult:!1,IsShowForSpare:!1,IsShowConclusion:!1,IsShowSign:!1,processKey:window.process.Training,PreviewType:1,objectId:"",currentView:""}},computed:{headers:function(){var e=pe.formatGridHeader();return!0===this.sort&&e.unshift({text:"序号",align:"center",sortable:!1}),e},formatFields:function(){return pe.getFormatFields()}},components:{contentModal:S["a"],dataTable:b["a"],trainingDetail:ge,trainingEditResult:P,trainingSelfResult:O,trainingSign:K,trainingNotice:X,trainingTeacherResult:A,CancelTask:r["a"]},methods:{modalClosedDetail:function(){this.IsShowConclusionDetail=!1},modalComfirmedDetail:function(){this.IsShowConclusionDetail=!1},modalConfimNotice:function(){var e=this;e.IsShowNotice=!1,e.IsShowConclusion=!0},modalClosedNotice:function(){this.IsShowNotice=!1},modalConfimSign:function(){var e=this;e.trainingPersonData.checkinRresult.dvalue=0,e.$Server.addOrUpdate("TrainingPerson",e.trainingPersonData,!0).then((function(t){e.IsShowSign=!1,p["a"].alert("签到成功","success")}),(function(e){p["a"].alert(e)}))},modalClosedSign:function(){this.IsShowSign=!1},modalClosedJoinSign:function(){var e=this;e.trainingPersonData.checkinRresult.dvalue=1,e.$Server.addOrUpdate("TrainingPerson",e.trainingPersonData,!0).then((function(e){this.IsShowSign=!1,p["a"].alert("不参与","success")}),(function(e){p["a"].alert(e)}))},getAllData:function(){if(1!==this.clickIndex){this.clickIndex=1;var e=this.$refs.childDataTable.getPagination();if(1!=e.page)return void this.$refs.childDataTable.setPage(1);var t={page:1,rowsPerPage:e.rowsPerPage};this.initTable(t)}},getLaunchData:function(){if(2!==this.clickIndex){this.clickIndex=2;var e=this.$refs.childDataTable.getPagination();if(1!=e.page)return void this.$refs.childDataTable.setPage(1);var t={page:1,rowsPerPage:e.rowsPerPage};this.initTable(t)}},getParticipateData:function(){if(3!==this.clickIndex){this.clickIndex=3;var e=this.$refs.childDataTable.getPagination();if(1!=e.page)return void this.$refs.childDataTable.setPage(1);var t={page:1,rowsPerPage:e.rowsPerPage};this.initTable(t)}},modalClosedForSeeResult:function(){this.IsShowForSeeResult=!1},showResult:function(){var e=this;if(1!=e.$refs.childDataTable.getCheckItems().length)p["a"].alert("请选择一项作为你查看的对象");else{var t=e.$refs.childDataTable.getCheckItems()[0];"已完成"==t.state.dname?(e.detailForUpdate=JSON.parse(JSON.stringify(t)),e.detailForUpdate.trainingBeginTime=e.detailForUpdate.trainingBeginTime.substring(0,16),e.detailForUpdate.trainingEndTime=e.detailForUpdate.trainingEndTime.substring(0,16),t.assignedUser==sessionStorage.getItem("userId")?(e.IsShowConclusionDetail=!0,e.$Server.queryAll("TrainingPerson",{page:-1,rowsPerPage:-1},{trainingID:e.$refs.childDataTable.getCheckItems()[0].id}).then((function(t){e.trainingPersonList=t.datas}),(function(e){}))):e.$Server.queryAll("TrainingPerson",{page:-1,rowsPerPage:-1},{trainingID:e.$refs.childDataTable.getCheckItems()[0].id,personID:sessionStorage.getItem("userId")}).then((function(t){t.page.total>0?(e.IsShowForSeeResult=!0,e.trainingPersonList=t.datas[0]):p["a"].alert("您不是该培训任务中的参与参与，不能查看！")}),(function(e){}))):p["a"].alert("只有对已完成的培训任务才能查看！")}},cancelTask:function(){var e=this,t=e.$refs.childDataTable.getCheckItems();1!=t.length?p["a"].alert("请选择一项作为你取消的对象"):"进行中"==t[0].state.dname?t[0].assignedUser!==sessionStorage.getItem("userId")?p["a"].alert("您不是该任务的负责人，不能取消"):(e.detailForUpdate=JSON.parse(JSON.stringify(t[0])),e.$refs.CancelTask.resetValid(),e.IsShowCancelTask=!0):p["a"].alert("只有对进行中的任务才能取消！")},modalComfirmedCancelTask:function(){var e=this;1==e.$refs.CancelTask.validate()?(e.cofirmCancel(e.detailForUpdate),e.IsShowCancelTask=!1):p["a"].alert("验证错误")},modalClosedCancelTask:function(){var e=this;e.IsShowCancelTask=!1},cofirmCancel:function(e){var t=this;I["a"].http(window.processForUrl.getUrlForInstanceId(e.id),"get","",{success:function(a){a.data&&a.data.data&&a.data.data.id?I["a"].http(window.processForUrl.getUrlForInstance(a.data.data.id),"Delete","",{success:function(a){e.state.dvalue=3,t.$Server.addOrUpdate(pe.getModelName(),e,!0).then((function(e){e.success&&(t.initTable(),p["a"].alert("取消成功","success"))}),(function(e){p["a"].alert(e)}))},error:function(e){p["a"].alert(e)}}):(e.state.dvalue=3,t.$Server.addOrUpdate(pe.getModelName(),e,!0).then((function(e){e.success&&(t.initTable(),p["a"].alert("取消成功","success"))}),(function(e){p["a"].alert(e)})))},error:function(e){p["a"].alert(e)}})},getQueryStringArgs:function(e){if(e&&e.length>0){var t=e.length>0?e.substring(1):"",a={},i=t.length?t.split("&"):[],n=null,s=null,r=null,o=0,l=i.length;for(o=0;o<l;o++)n=i[o].split("="),s=decodeURIComponent(n[0]),r=decodeURIComponent(n[1]),s.length&&(a[s]=r);return a}return{}},excuteTask:function(){var e=this;if(1!=e.$refs.childDataTable.getCheckItems().length)p["a"].alert("请选择一项作为你执行的对象");else{var t=e.$refs.childDataTable.getCheckItems()[0],a=sessionStorage.getItem("userId");"未开始"==t.state.dname?a==t.assignedUser?(t.state.dvalue=1,e.$Server.addOrUpdate(pe.getModelName(),t,!0).then((function(t){t.success&&(e.initTable(),p["a"].alert("发起成功","success"))}),(function(e){p["a"].alert(e)}))):p["a"].alert("这条任务的负责人不是你！"):p["a"].alert("只有对未开始的培训任务才能执行！")}},modalClosedForSpare:function(){this.IsShowForSpare=!1},modalSubmitJoin:function(){var e=this;e.trainingPersonList.forEach((function(e){e.storage=!1})),this.modalSubmit(),this.initTable()},modalSubmit:function(){var e=this;this.$refs.SeeConclusion.$refs.form.validate()&&e.$Server.batchUpdate("TrainingPerson",e.trainingPersonList).then((function(t){t.success&&(e.IsShowConclusion=!1,e.initTable())}),(function(e){p["a"].alert("保存失败")}))},modalComfirmedForSpare:function(){var e=this;1==e.$refs.addOrUpdateForSpare.validate()&&e.$Server.addOrUpdate("SpInventorySubTask",e.detailForUpdate.subTaskList[0],!e.IsAddOp).then((function(t){t.success&&(e.IsShowForSpare=!1,e.initTable(),p["a"].alert("保存成功","success"))}),(function(e){p["a"].alert(e)}))},spareTask:function(){var e=this;e.resetFormValidation(),1!=e.$refs.childDataTable.getCheckItems().length?p["a"].alert("请选择一项作为你培训的对象"):e.$Server.queryObjectById("SpInventoryTask",e.$refs.childDataTable.getCheckItems()[0].id).then((function(t){var a=t.data.data;a.subTaskList&&a.subTaskList.length>0?0==a.subTaskList[0].state?(e.IsAddOp=!1,e.title="培训任务清单",e.detailForUpdate=JSON.parse(JSON.stringify(a)),e.IsShowForSpare=!0):p["a"].alert("你已经培训完了此任务！"):p["a"].alert("这条任务的培训人不是你！")}))},tableAdd:function(){this.resetForm(),this.IsAddOp=!0,this.isSee=!1,this.detailForUpdate=JSON.parse(JSON.stringify(this.initObject)),this.title="添加培训任务",this.$refs.addOrUpdate.tempPartList=[],this.$refs.addOrUpdate.participantPersonList=[],this.IsShow=!0},tableEdit:function(){var e=this;if(e.resetFormValidation(),e.IsAddOp=!1,e.isSee=!1,e.title="编辑培训任务",1!=e.$refs.childDataTable.getCheckItems().length)p["a"].alert("请选择一项作为你修改的对象");else{var t=e.$refs.childDataTable.getCheckItems()[0];null==t.documentList&&(t.documentList=[]),"未开始"==t.state.dname?(e.detailForUpdate=JSON.parse(JSON.stringify(this.initObject)),e.$refs.addOrUpdate.participantPersonList=[],e.$refs.addOrUpdate.tempPartList=[],e.$refs.addOrUpdate.getParticipants(t.positionID,t.skillID).then((function(){t.otherArr=[],t.otherPersonList&&t.otherPersonNameList&&(t.otherArr=t.otherPersonList.map((function(e,a){return{id:e,uname:t.otherPersonNameList[a],name:t.otherPersonNameList[a]}}))),e.detailForUpdate=JSON.parse(JSON.stringify(t)),e.detailForUpdate.userViewModel&&(e.detailForUpdate.userViewModel=[e.detailForUpdate.userViewModel]),e.IsShow=!0}))):p["a"].alert("只有对未开始的培训任务才能编辑！")}},doSearch:function(){1!==this.clickIndex&&(this.clickIndex=1);var e=this.$refs.childDataTable.getPagination();1==e.page?this.initTable(e):this.$refs.childDataTable.setPage(1)},clearMessage:function(){this.searchfx="",this.doSearch()},initTable:function(e){var t=this;e&&e.page||(e=this.$refs.childDataTable.getPagination()),1===this.clickIndex?t.$Server.queryAll(pe.getModelName(),{page:e.page,rowsPerPage:e.rowsPerPage},{searchfx:t.searchfx}).then((function(e){t.$refs.childDataTable.unCheckItems();var a=[],i="";e.datas.forEach((function(e){e.documentList&&e.documentList.length>0&&e.documentList.forEach((function(e){e.documentViewModel&&e.documentViewModel.dname&&e.documentViewModel.newestFilePath&&(i=e.documentViewModel.dname+e.documentViewModel.newestFilePath.substring(e.documentViewModel.newestFilePath.lastIndexOf(".")),a.push(i))})),e.knowList&&e.knowList.length>0&&e.knowList.forEach((function(e){e.dname&&a.push(e.dname)})),a.length>0&&(e.material=a),a=[],e.state&&e.state.dname&&("未开始"==e.state.dname||"已取消"==e.state.dname)?e.stateName=t.$Utils.setStart(e.state.dname):e.state&&e.state.dname&&"进行中"==e.state.dname?e.stateName=t.$Utils.setRed(e.state.dname):e.state&&e.state.dname&&"已完成"==e.state.dname&&(e.stateName=t.$Utils.setSuccess(e.state.dname))})),t.DataSource=e.datas,t.DataSource1=e.datas,t.total=e.page.total}),(function(e){})):2===this.clickIndex?t.$Server.queryAll(pe.getModelName(),{page:e.page,rowsPerPage:e.rowsPerPage},{assignedUser:sessionStorage.getItem("userId")}).then((function(e){t.$refs.childDataTable.unCheckItems();var a=[],i="";e.datas.forEach((function(e){e.documentList&&e.documentList.length>0&&e.documentList.forEach((function(e){e.documentViewModel&&e.documentViewModel.dname&&e.documentViewModel.newestFilePath&&(i=e.documentViewModel.dname+e.documentViewModel.newestFilePath.substring(e.documentViewModel.newestFilePath.lastIndexOf(".")),a.push(i))})),e.knowList&&e.knowList.length>0&&e.knowList.forEach((function(e){e.dname&&a.push(e.dname)})),a.length>0&&(e.material=a),a=[],e.state&&e.state.dname&&("未开始"==e.state.dname||"已取消"==e.state.dname)?e.stateName=t.$Utils.setStart(e.state.dname):e.state&&e.state.dname&&"进行中"==e.state.dname?e.stateName=t.$Utils.setRed(e.state.dname):e.state&&e.state.dname&&"已完成"==e.state.dname&&(e.stateName=t.$Utils.setSuccess(e.state.dname))})),t.DataSource=e.datas,t.DataSource2=e.datas,t.total=e.page.total}),(function(e){})):3===this.clickIndex&&t.$Server.queryAll(pe.getModelName(),{page:e.page,rowsPerPage:e.rowsPerPage},{belongMe:sessionStorage.getItem("userId")}).then((function(e){t.$refs.childDataTable.unCheckItems();var a=[],i="";e.datas.forEach((function(e){e.documentList&&e.documentList.length>0&&e.documentList.forEach((function(e){e.documentViewModel&&e.documentViewModel.dname&&e.documentViewModel.newestFilePath&&(i=e.documentViewModel.dname+e.documentViewModel.newestFilePath.substring(e.documentViewModel.newestFilePath.lastIndexOf(".")),a.push(i))})),e.knowList&&e.knowList.length>0&&e.knowList.forEach((function(e){e.dname&&a.push(e.dname)})),a.length>0&&(e.material=a),e.state&&e.state.dname&&("未开始"==e.state.dname||"已取消"==e.state.dname)?e.stateName=t.$Utils.setStart(e.state.dname):e.state&&e.state.dname&&"进行中"==e.state.dname?e.stateName=t.$Utils.setRed(e.state.dname):e.state&&e.state.dname&&"已完成"==e.state.dname&&(e.stateName=t.$Utils.setSuccess(e.state.dname)),a=[]})),t.DataSource=e.datas,t.DataSource3=e.datas,t.total=e.page.total}),(function(e){}))},rowDbClick:function(e){this.detailForUpdate=JSON.parse(JSON.stringify(e)),this.title="培训任务详情",this.isSee=!0,this.IsShow=!0},modalComfirmed:function(){var e=this;1==e.$refs.addOrUpdate.validate()&&(e.detailForUpdate.userViewModel&&e.detailForUpdate.userViewModel.length>0&&(e.detailForUpdate.userViewModel=e.detailForUpdate.userViewModel[0]),e.$Server.addOrUpdate(pe.getModelName(),e.detailForUpdate,!e.IsAddOp).then((function(t){t.success&&(e.IsShow=!1,e.$refs.addOrUpdate.$refs.treeCombo.closeNode(),e.initTable(),p["a"].alert("保存成功","success"))}),(function(e){p["a"].alert(e)})))},modalClosed:function(){this.IsShow=!1,this.detailForUpdate={documentList:{}},this.$refs.addOrUpdate.$refs.treeCombo.closeNode()},resetFormValidation:function(){this.$refs.addOrUpdate.$refs.form.resetValidation()},resetForm:function(){this.$refs.addOrUpdate.$refs.form.reset(),this.$refs.addOrUpdate.$refs.form.resetValidation()},modalClosedForSee:function(){this.IsShowForSee=!1},cofirmDelete:function(){var e=this,t=this.$refs.childDataTable.getCheckItems();e.$Server.batchDelete(pe.getModelName(),t).then((function(){e.initTable()}),(function(e){p["a"].alert(e)}))},tableDelete:function(){var e=this;if(e.$refs.childDataTable.getCheckItems().length<=0)p["a"].alert("请选中需要删除的对象");else{for(var t=!0,a=0;a<e.$refs.childDataTable.getCheckItems().length;a++)if("未开始"!=e.$refs.childDataTable.getCheckItems()[a].state.dname){t=!1;break}t?x["a"].confirm("确定删除所选培训任务?","提示",500,(function(){e.cofirmDelete()}),(function(){})):p["a"].alert("只有对未开始的培训任务才能删除！")}},showConclusion:function(){var e=this;e.$refs.childDataTable.getCheckItems().length<=0?p["a"].alert("请选中需要考核的培训任务"):1!=e.$refs.childDataTable.getCheckItems().length?p["a"].alert("请选中一个任务进行考核"):"未开始"==e.$refs.childDataTable.getCheckItems()[0].state.dname?p["a"].alert("该培训任务未开始，不能进行考核！"):2===e.$refs.childDataTable.getCheckItems()[0].state.dvalue?p["a"].alert("该培训任务已完成，不能进行填写！"):e.$refs.childDataTable.getCheckItems()[0].assignedUser!==sessionStorage.getItem("userId")?p["a"].alert("您不是该培训任务的负责人，不能发起考核"):e.$refs.childDataTable.getCheckItems()[0].examine?(e.IsShowNotice=!0,e.detailForUpdate=e.$refs.childDataTable.getCheckItems()[0],e.$Server.queryAll("TrainingPerson",{page:-1,rowsPerPage:-1},{trainingID:e.$refs.childDataTable.getCheckItems()[0].id}).then((function(t){e.trainingPersonList=t.datas}),(function(e){}))):p["a"].alert("该培训没有考核要求，不能进行考核")},editConclusion:function(){var e=this;e.$refs.childDataTable.getCheckItems().length<=0?p["a"].alert("请选中需要填写的培训任务"):1!=e.$refs.childDataTable.getCheckItems().length?p["a"].alert("请选中一个任务进行填写"):0==e.$refs.childDataTable.getCheckItems()[0].state.dvalue?p["a"].alert("该培训任务未开始，不能进行填写！"):2===e.$refs.childDataTable.getCheckItems()[0].state.dvalue?p["a"].alert("该培训任务已完成，不能进行填写！"):e.$refs.childDataTable.getCheckItems()[0].assignedUser!==sessionStorage.getItem("userId")?p["a"].alert("您不是该培训任务的负责人，不能发起填写"):(e.IsShowConclusion=!0,e.detailForUpdate=e.$refs.childDataTable.getCheckItems()[0],e.detailForUpdate.trainingBeginTime=e.detailForUpdate.trainingBeginTime.substring(0,16),e.detailForUpdate.trainingEndTime=e.detailForUpdate.trainingEndTime.substring(0,16),e.$Server.queryAll("TrainingPerson",{page:-1,rowsPerPage:-1},{trainingID:e.$refs.childDataTable.getCheckItems()[0].id}).then((function(t){e.trainingPersonList=t.datas,e.$refs.SeeConclusion.$refs.form.resetValidation()}),(function(e){})))},modalStorageClosed:function(){var e=this;e.trainingPersonList.forEach((function(e){e.storage=!0})),this.modalSubmit(),this.initTable()},modalClosedConclusion:function(){this.IsShowConclusion=!1},handleCheckIn:function(){var e=this;if(e.$refs.childDataTable.getCheckItems().length<=0)p["a"].alert("请选中需要签到的培训任务");else{if(-1===e.$refs.childDataTable.getCheckItems()[0].allPersonList.indexOf(sessionStorage.userId))return void p["a"].alert("您不是参与人员");"未开始"==e.$refs.childDataTable.getCheckItems()[0].state.dname?p["a"].alert("该培训任务未开始，不能进行签到！"):1!=e.$refs.childDataTable.getCheckItems().length?p["a"].alert("请选中一个任务进行签到"):"进行中"!=e.$refs.childDataTable.getCheckItems()[0].state.dname?p["a"].alert("该培训任务不是进行中，不能进行签到！"):e.$Server.queryAll("TrainingPerson",{page:-1,rowsPerPage:-1},{trainingID:e.$refs.childDataTable.getCheckItems()[0].id,personID:sessionStorage.getItem("userId")}).then((function(t){e.trainingPersonData=t.datas[0],e.IsShowSign=!0,e.detailForUpdate=e.$refs.childDataTable.getCheckItems()[0]}),(function(e){}))}}}},Se=ve,be=(a("5aa8"),Object(T["a"])(Se,i,n,!1,null,"a37155ae",null));t["default"]=be.exports},"9edc":function(e,t,a){},b696:function(e,t,a){},cd47:function(e,t,a){"use strict";var i=a("9edc"),n=a.n(i);n.a}}]);