(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b098bcb"],{5883:function(e,t,s){"use strict";var a=s("eb21"),i=s.n(a);i.a},8202:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("layContentHeader",{attrs:{title:"备件台账",buttons:e.headerBtns,allowSearch:!1}},[s("v-text-field",{attrs:{label:"请输入备件名称或编号",clearable:"","hide-details":"","single-line":"",primary:""},on:{"click:clear":e.clearMessage},scopedSlots:e._u([{key:"append-outer",fn:function(){return[s("v-icon",{on:{click:function(t){return e.doSearch()}}},[e._v("search")])]},proxy:!0}]),model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),s("layContent",[s("v-tabs",{attrs:{"slider-color":"primary"},on:{change:e.tabClick},model:{value:e.actives,callback:function(t){e.actives=t},expression:"actives"}},[s("v-tab",{key:1},[e._v("\n                正常库\n            ")]),s("v-tab",{key:2},[e._v("\n                异常库\n            ")]),s("v-tab-item",{key:1}),s("v-tab-item",{key:2})],1),s("div",[s("gridTemplate",{ref:"childGridTemplate",attrs:{title:"备件台账",gridModel:e.spareParts,sort:e.sort,initCondition:e.initCondition},on:{editorsReCode:e.editorsReCode,beforeEdit:e.beforeEdit,beforeAdd:e.beforeAdd,beforeEditSubmit:e.beforeEditSubmit,rowDbClick:e.rowDbClick,beforeExcuteDelete:e.beforeExcuteDelete,afterInit:e.afterInit}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{staticClass:"headline",attrs:{xs12:""}},[e._v("基本信息:")]),s("v-flex",{attrs:{xs4:""}},[s("upload-input",{staticStyle:{"margin-top":"60px","margin-left":"50px"},attrs:{btnName:"上传备件图片"},model:{value:e.editAssets.partsImage,callback:function(t){e.$set(e.editAssets,"partsImage",t)},expression:"editAssets.partsImage"}})],1),s("v-flex",{attrs:{xs8:""}},[s("v-layout",[s("v-flex",[s("v-text-field",{attrs:{label:"零件号",rules:[function(e){return!e||/^[\w|-]+$/.test(e)||"只能是数字,字母,下划线"}]},model:{value:e.editAssets.code,callback:function(t){e.$set(e.editAssets,"code",t)},expression:"editAssets.code"}})],1),s("v-flex",[s("v-text-field",{attrs:{label:"备件名称",rules:[function(e){return!!e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                        备件名称 "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.editAssets.name,callback:function(t){e.$set(e.editAssets,"name",t)},expression:"editAssets.name"}})],1)],1),s("v-layout",[s("v-flex",[s("v-text-field",{attrs:{label:"规格型号"},model:{value:e.editAssets.model,callback:function(t){e.$set(e.editAssets,"model",t)},expression:"editAssets.model"}})],1),s("v-flex",[s("v-select",{attrs:{label:"备件类型",items:e.typeList,"item-text":"dname","return-object":""},model:{value:e.editAssets.type,callback:function(t){e.$set(e.editAssets,"type",t)},expression:"editAssets.type"}})],1)],1),s("v-layout",[s("v-flex",[s("v-text-field",{attrs:{label:"长",type:"number",min:"0"},model:{value:e.editAssets.length,callback:function(t){e.$set(e.editAssets,"length",t)},expression:"editAssets.length"}})],1),s("v-flex",[s("v-text-field",{attrs:{label:"宽",type:"number",min:"0"},model:{value:e.editAssets.width,callback:function(t){e.$set(e.editAssets,"width",t)},expression:"editAssets.width"}})],1),s("v-flex",[s("v-text-field",{attrs:{label:"高",type:"number",min:"0"},model:{value:e.editAssets.height,callback:function(t){e.$set(e.editAssets,"height",t)},expression:"editAssets.height"}})],1),s("v-flex",{staticStyle:{"font-size":"12px","min-width":"90px",padding:"0px","line-height":"76px"}},[e._v("(单位：CM)\n                            ")])],1)],1),s("v-flex",{attrs:{xs12:""}},[s("v-layout",[s("v-flex",[s("v-combobox",{attrs:{label:"生产厂商",items:e.manufacturerList,"item-text":"cname","item-value":"id"},model:{value:e.editAssets.manufacturer,callback:function(t){e.$set(e.editAssets,"manufacturer",t)},expression:"editAssets.manufacturer"}})],1),s("v-flex",[s("v-combobox",{attrs:{label:"供应商",items:e.supplierList,"item-text":"cname","item-value":"id"},model:{value:e.editAssets.supplier,callback:function(t){e.$set(e.editAssets,"supplier",t)},expression:"editAssets.supplier"}})],1),s("v-flex",[s("v-radio-group",{attrs:{label:"备件状态",row:""},model:{value:e.editAssets.status,callback:function(t){e.$set(e.editAssets,"status",t)},expression:"editAssets.status"}},e._l(e.statusList,(function(e){return s("v-radio",{key:e.dvalue,attrs:{label:e.dname,value:e}})})),1)],1)],1),s("v-layout",[s("v-flex",{attrs:{xs6:""}},[s("v-text-field",{attrs:{label:"最低库存",type:"number",min:"0",rules:[function(e){return null!=e&&void 0!=e&&e.toString().length>0||"必填项"},function(e){return/^[1-9]\d*$/.test(e)||"最低库存要大于0"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                        最低库存 "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.editAssets.minInventory,callback:function(t){e.$set(e.editAssets,"minInventory",t)},expression:"editAssets.minInventory"}})],1),s("v-flex",{attrs:{xs6:""}},[s("v-text-field",{attrs:{label:"安全库存推荐值",type:"number",min:"0",disabled:""},model:{value:e.editAssets.safeCount,callback:function(t){e.$set(e.editAssets,"safeCount",t)},expression:"editAssets.safeCount"}})],1),s("v-flex",{attrs:{xs6:""}},[s("v-select",{attrs:{label:"单位",items:e.periodUnitList,"item-text":"dname","return-object":""},model:{value:e.editAssets.inventoryUnit,callback:function(t){e.$set(e.editAssets,"inventoryUnit",t)},expression:"editAssets.inventoryUnit"}})],1)],1),s("v-layout",[s("v-flex",{attrs:{xs8:""}},[s("treeView",{ref:"treeView",attrs:{independentCheck:!0,Source:e.equipments,MultipleSelect:!1,label:"适用设备名录",independentSingleCheck:!1,"return-object":""},model:{value:e.editAssets.equipments,callback:function(t){e.$set(e.editAssets,"equipments",t)},expression:"editAssets.equipments"}})],1),s("v-flex",[s("v-radio-group",{attrs:{label:"备件好坏",row:""},model:{value:e.editAssets.gdType,callback:function(t){e.$set(e.editAssets,"gdType",t)},expression:"editAssets.gdType"}},e._l(e.gdTypeList,(function(e){return s("v-radio",{key:e.dvalue,attrs:{label:e.dname,value:e}})})),1)],1)],1),s("v-layout",[s("v-flex",{attrs:{xs12:""}},[s("span",{staticClass:"headline"},[e._v("上传附件:")]),s("v-icon",{on:{click:function(t){return e.addUpload()}}},[e._v("add")]),s("v-icon",{on:{click:function(t){return e.removeUpload()}}},[e._v("remove")])],1)],1),e._l(e.sparePartsDocumentList,(function(t,a){return s("v-layout",{key:a,style:e.selectDocument.includes(t)?"background: #E3F2FD":"",attrs:{row:""},on:{click:function(s){return e.getClickDocument(t,a)}}},[s("fileUploader",{ref:"upload",refInFor:!0,attrs:{label:"上传附件",multiple:!1,fileNames:t.documentViewModel.dname,uploadBase64:!1,userVersion:t},on:{formData:e.getFileData},model:{value:t.documentViewModel,callback:function(s){e.$set(t,"documentViewModel",s)},expression:"doc.documentViewModel"}})],1)}))],2)],1),s("v-divider",{staticStyle:{"border-style":"dashed","border-width":"thin","margin-top":"0px"}}),s("v-flex",{staticClass:"headline"},[e._v("资产信息：")]),s("v-layout",{attrs:{wrap:""}},[s("v-flex",{attrs:{xs4:""}},[s("v-select",{attrs:{label:"ABC类",items:e.abcTypeList,"item-text":"dname","return-object":""},model:{value:e.editAssets.abcType,callback:function(t){e.$set(e.editAssets,"abcType",t)},expression:"editAssets.abcType"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"单价(元)",type:"number",min:"1"},model:{value:e.editAssets.originalValue,callback:function(t){e.$set(e.editAssets,"originalValue",t)},expression:"editAssets.originalValue"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"采购周期(天)",type:"number",rules:[function(e){return null!=e&&void 0!=e&&e.toString().length>0||"必填项"},function(e){return/^[1-9]\d*$/.test(e)||"采购周期要大于0"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                采购周期(天) "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.editAssets.procurementCycle,callback:function(t){e.$set(e.editAssets,"procurementCycle",t)},expression:"editAssets.procurementCycle"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"最小起订量",type:"number",min:"0",rules:[function(e){return null!=e&&void 0!=e&&e.toString().length>0||"必填项"},function(e){return/^[1-9]\d*$/.test(e)||"最小起订量要大于0"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                最小起订量 "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.editAssets.miniOrder,callback:function(t){e.$set(e.editAssets,"miniOrder",t)},expression:"editAssets.miniOrder"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"使用年限(月)",type:"number"},model:{value:e.editAssets.serviceLife,callback:function(t){e.$set(e.editAssets,"serviceLife",t)},expression:"editAssets.serviceLife"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-select",{attrs:{label:"使用频次",items:e.fmrTypeList,"item-text":"dname","return-object":""},model:{value:e.editAssets.fmrType,callback:function(t){e.$set(e.editAssets,"fmrType",t)},expression:"editAssets.fmrType"}})],1)],1),s("v-divider",{staticStyle:{"border-style":"dashed","border-width":"thin"}}),s("v-layout",[s("v-flex",{staticClass:"headline"},[e._v("位置信息：")])],1),s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[s("v-flex",{attrs:{xs11:"",sm11:"",md11:""}},[s("v-btn",{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(t){return e.addRow()}}},[s("v-icon",[e._v("\n                                    add\n                                ")])],1),s("v-btn",{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:e.deleteLocation}},[s("v-icon",[e._v("\n                                    remove\n                                ")])],1)],1)],1)],1),e._l(e.locations,(function(t,a){return s("v-layout",{key:t.id,style:e.selectLocation.includes(t)?"background: #E3F2FD":"",attrs:{wrap:""},on:{click:function(s){return e.getClick(t,a)}}},e._l(e.editPosition,(function(a){return s("v-flex",{key:a.field},["comboboxField"==a.fieldType?s("v-select",{attrs:{items:e.slocationList,label:a.text,"item-text":"sname","item-value":"id",rules:[e.rules.required]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                "+e._s(a.text)+" "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!0),model:{value:t[a.value],callback:function(s){e.$set(t,a.value,s)},expression:"pos[item1.value]"}}):e._e(),"库位类型"==a.text?s("v-text-field",{attrs:{label:"库位类型",disabled:""},model:{value:t[a.value],callback:function(s){e.$set(t,a.value,s)},expression:"pos[item1.value]"}}):e._e(),"库存量"==a.text?s("v-text-field",{attrs:{label:a.text,rules:[function(e){return null!=e&&void 0!=e&&e.toString().length>0||"必填项"},function(e){return/^(0|[1-9][0-9]*)$/.test(e)||"库存量不能小于0"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                "+e._s(a.text)+" "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!0),model:{value:t[a.value],callback:function(s){e.$set(t,a.value,s)},expression:"pos[item1.value]"}}):e._e()],1)})),1)}))],2)],1)],1),s("contentModal",{attrs:{title:"备件详情",IsShow:e.IsShowDetails,isDetails:!0},on:{modalClosed:function(t){return e.modalClosed()}}},[s("v-container",{attrs:{"grid-list-md":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{staticClass:"headline",attrs:{xs12:""}},[e._v("基本信息:")]),s("v-flex",{attrs:{xs4:""}},[s("upload-input",{staticStyle:{"margin-top":"60px","margin-left":"50px"},attrs:{btnName:"上传备件图片",disabled:!0},model:{value:e.sparePartsDetail.partsImage,callback:function(t){e.$set(e.sparePartsDetail,"partsImage",t)},expression:"sparePartsDetail.partsImage"}})],1),s("v-flex",{attrs:{xs8:""}},[s("v-layout",[s("v-flex",[s("v-text-field",{attrs:{label:"零件号",disabled:""},model:{value:e.sparePartsDetail.code,callback:function(t){e.$set(e.sparePartsDetail,"code",t)},expression:"sparePartsDetail.code"}})],1),s("v-flex",[s("v-text-field",{attrs:{label:"备件名称",rules:[function(e){return!!e||"必填项"}],disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    备件名称 "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.sparePartsDetail.name,callback:function(t){e.$set(e.sparePartsDetail,"name",t)},expression:"sparePartsDetail.name"}})],1)],1),s("v-layout",[s("v-flex",[s("v-text-field",{attrs:{label:"规格型号",disabled:""},model:{value:e.sparePartsDetail.model,callback:function(t){e.$set(e.sparePartsDetail,"model",t)},expression:"sparePartsDetail.model"}})],1),s("v-flex",[s("v-select",{attrs:{label:"备件类型",items:e.typeList,"item-text":"dname","return-object":"",disabled:""},model:{value:e.sparePartsDetail.type,callback:function(t){e.$set(e.sparePartsDetail,"type",t)},expression:"sparePartsDetail.type"}})],1)],1),s("v-layout",[s("v-flex",[s("v-text-field",{attrs:{label:"长",type:"number",min:"0",disabled:""},model:{value:e.sparePartsDetail.length,callback:function(t){e.$set(e.sparePartsDetail,"length",t)},expression:"sparePartsDetail.length"}})],1),s("v-flex",[s("v-text-field",{attrs:{label:"宽",type:"number",min:"0",disabled:""},model:{value:e.sparePartsDetail.width,callback:function(t){e.$set(e.sparePartsDetail,"width",t)},expression:"sparePartsDetail.width"}})],1),s("v-flex",[s("v-text-field",{attrs:{label:"高",type:"number",min:"0",disabled:""},model:{value:e.sparePartsDetail.height,callback:function(t){e.$set(e.sparePartsDetail,"height",t)},expression:"sparePartsDetail.height"}})],1),s("v-flex",{staticStyle:{"font-size":"12px","min-width":"90px",padding:"0px","line-height":"76px"}},[e._v("(单位：CM)\n                        ")])],1)],1),s("v-flex",{attrs:{xs12:""}},[s("v-layout",[s("v-flex",[s("v-select",{attrs:{label:"生产厂商",items:e.manufacturerList,"item-text":"cname","item-value":"id",disabled:""},model:{value:e.sparePartsDetail.manufacturer,callback:function(t){e.$set(e.sparePartsDetail,"manufacturer",t)},expression:"sparePartsDetail.manufacturer"}})],1),s("v-flex",[s("v-select",{attrs:{label:"供应商",items:e.supplierList,"item-text":"cname","item-value":"id",disabled:""},model:{value:e.sparePartsDetail.supplier,callback:function(t){e.$set(e.sparePartsDetail,"supplier",t)},expression:"sparePartsDetail.supplier"}})],1),s("v-flex",[s("v-radio-group",{attrs:{label:"备件状态",row:"",disabled:""},model:{value:e.sparePartsDetail.status,callback:function(t){e.$set(e.sparePartsDetail,"status",t)},expression:"sparePartsDetail.status"}},e._l(e.statusList,(function(e){return s("v-radio",{key:e.dvalue,attrs:{label:e.dname,value:e}})})),1)],1)],1),s("v-layout",[s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"最低库存",type:"number",min:"0",disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    最低库存 "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.sparePartsDetail.minInventory,callback:function(t){e.$set(e.sparePartsDetail,"minInventory",t)},expression:"sparePartsDetail.minInventory"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"安全库存推荐值",disabled:""},model:{value:e.sparePartsDetail.safeCount,callback:function(t){e.$set(e.sparePartsDetail,"safeCount",t)},expression:"sparePartsDetail.safeCount"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-select",{attrs:{label:"单位",items:e.periodUnitList,"item-text":"dname","return-object":"",disabled:""},model:{value:e.sparePartsDetail.inventoryUnit,callback:function(t){e.$set(e.sparePartsDetail,"inventoryUnit",t)},expression:"sparePartsDetail.inventoryUnit"}})],1)],1),s("v-layout",[s("v-flex",{attrs:{xs8:""}},[s("v-select",{attrs:{label:"适用设备",items:e.equipmentList,"item-text":"nameAndModel","item-value":"id",multiple:"",disabled:""},model:{value:e.sparePartsDetail.equipments,callback:function(t){e.$set(e.sparePartsDetail,"equipments",t)},expression:"sparePartsDetail.equipments"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-radio-group",{attrs:{label:"备件好坏",row:"",disabled:""},model:{value:e.sparePartsDetail.gdType,callback:function(t){e.$set(e.sparePartsDetail,"gdType",t)},expression:"sparePartsDetail.gdType"}},e._l(e.gdTypeList,(function(e){return s("v-radio",{key:e.dvalue,attrs:{label:e.dname,value:e}})})),1)],1)],1),s("p",{staticClass:"headline"},[e._v("备件附件")]),e._l(e.sparePartsDetail.spareDocumentList,(function(t,a){return s("v-layout",{key:a,attrs:{row:""}},[s("v-flex",{attrs:{xs5:""}},[s("v-text-field",{attrs:{value:t.documentViewModel.dname+t.documentViewModel.newestFileExt,disabled:"",label:"附件"}})],1),s("v-flex",{attrs:{xs5:""}},[s("v-text-field",{attrs:{label:"版本",value:t.userVersion,disabled:""}})],1),s("v-flex",[s("v-btn",{on:{click:function(s){return e.downloadFile(t.documentViewModel)}}},[e._v("下载")])],1)],1)}))],2)],1),s("v-divider",{staticStyle:{"border-style":"dashed","border-width":"thin","margin-top":"0px"}}),s("v-flex",{staticClass:"headline"},[e._v("资产信息：")]),s("v-layout",{attrs:{wrap:""}},[s("v-flex",{attrs:{xs4:""}},[s("v-select",{attrs:{label:"ABC类",rules:[function(e){return"{}"!=JSON.stringify(e)||"必填项"}],items:e.abcTypeList,"item-text":"dname","return-object":"",disabled:""},model:{value:e.sparePartsDetail.abcType,callback:function(t){e.$set(e.sparePartsDetail,"abcType",t)},expression:"sparePartsDetail.abcType"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"备件原值(元)",type:"number",min:"1",disabled:""},model:{value:e.sparePartsDetail.originalValue,callback:function(t){e.$set(e.sparePartsDetail,"originalValue",t)},expression:"sparePartsDetail.originalValue"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"采购周期(天)",disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                采购周期(天) "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.sparePartsDetail.procurementCycle,callback:function(t){e.$set(e.sparePartsDetail,"procurementCycle",t)},expression:"sparePartsDetail.procurementCycle"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"最小起订量",disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                            最小起订量 "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.sparePartsDetail.miniOrder,callback:function(t){e.$set(e.sparePartsDetail,"miniOrder",t)},expression:"sparePartsDetail.miniOrder"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-text-field",{attrs:{label:"使用年限(月)",disabled:""},model:{value:e.sparePartsDetail.serviceLife,callback:function(t){e.$set(e.sparePartsDetail,"serviceLife",t)},expression:"sparePartsDetail.serviceLife"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-select",{attrs:{label:"使用频次",items:e.fmrTypeList,"item-text":"dname","return-object":"",disabled:""},model:{value:e.sparePartsDetail.fmrType,callback:function(t){e.$set(e.sparePartsDetail,"fmrType",t)},expression:"sparePartsDetail.fmrType"}})],1)],1),s("v-layout",{directives:[{name:"show",rawName:"v-show",value:e.locations&&e.locations.length>0,expression:"locations && locations.length>0"}]},[s("v-flex",{staticClass:"headline"},[e._v("位置信息：")])],1),e._l(e.locations,(function(t,a){return s("v-layout",{key:t.id,style:e.selectLocation.includes(t)?"background: #E3F2FD":"",attrs:{wrap:""},on:{click:function(s){return e.getClick(t,a)}}},e._l(e.editPosition,(function(a){return s("v-flex",{key:a.field},["comboboxField"==a.fieldType?s("v-select",{attrs:{items:e.slocationList,label:a.text,"item-text":"sname","item-value":"id",rules:[e.rules.required],disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                            "+e._s(a.text)+" "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!0),model:{value:t[a.value],callback:function(s){e.$set(t,a.value,s)},expression:"pos[item1.value]"}}):e._e(),"库位类型"==a.text?s("v-text-field",{attrs:{label:"库位类型",disabled:""},model:{value:t[a.value],callback:function(s){e.$set(t,a.value,s)},expression:"pos[item1.value]"}}):e._e(),"库存量"==a.text?s("v-text-field",{attrs:{label:a.text,rules:[e.rules.required,function(e){return/^(0|[1-9][0-9]*)$/.test(e)||"只能是正整数"}],disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                            "+e._s(a.text)+" "),s("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!0),model:{value:t[a.value],callback:function(s){e.$set(t,a.value,s)},expression:"pos[item1.value]"}}):e._e()],1)})),1)}))],2)],1),s("contentModal",{attrs:{title:"导入备件台账",IsShow:e.IsShowImport},on:{modalClosed:function(t){return e.modalClosedImport()},modalComfirmed:function(t){return e.ComfirmImport()}}},[s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:e.downloadTemp}},[e._v("下载导入模板")]),s("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("\n                (注:文档内标题标红的列为必填项，请勿输入以下非法字符：~、@、$、^、&、《、》、<、>、￥)\n            ")])],1),s("UploadFile",{ref:"uploadFile",attrs:{label:"导入文件"},on:{formData:e.getFormData},model:{value:e.base64,callback:function(t){e.base64=t},expression:"base64"}})],1)],1)},i=[],l=(s("bada"),s("7cfd"),s("40c5"),s("4634"),s("f19a")),n=s("b9da"),r=s("2c75"),o=s("8333"),d=s("3f83"),c=s("55b3"),u=s("a2a7"),p=s("d685"),f=s("815a"),m=s("d5b3"),v=s("a7fe"),x=s("b27e"),h=s("ef3e"),b=s("a1de"),y=new o["a"]((new r["a"]).positions.model),D=new o["a"](new d["a"]),g={data:function(){var e=this;return{treeValues:[],open:[1],rules:{required:function(e){return!!e||"必填项"}},initCondition:{deleted:!1,locationType:0},spareParts:{},headerBtns:[{disabled:!this.$per("SpareParts","c"),text:"添加",icon:"self_add",click:function(){return e.$refs.childGridTemplate.GridAdd()}},{disabled:!this.$per("SpareParts","u"),text:"编辑",icon:"self_edit",click:function(){return e.$refs.childGridTemplate.GridEdit()}},{disabled:!this.$per("SpareParts","d"),text:"删除",icon:"self_delete",click:function(){return e.$refs.childGridTemplate.GridDelete()}},{disabled:!this.$per("SpareParts","import"),text:"导入",icon:"self_import",click:function(){return e.importSpareParts()}},{disabled:!this.$per("SpareParts","e"),text:"导出",icon:"self_export",click:function(){return e.exportSpareParts()}}],dataList:[{id:0,name:"F类"},{id:1,name:"M类"},{id:2,name:"R类"}],locations:[],editPosition:y.formatGridHeader(),slocationList:[],searchValue:"",IsShowImport:!1,base64:"",sort:!0,IsShowDetails:!1,sparePartsEditors:[],sparePartsDetail:{},directoryList:[],supplierList:[],manufacturerList:[],selectLocation:[],deleteIndex:"",abcTypeList:[],fmrTypeList:[],editAssets:{},editors:[],typeList:[],periodUnitList:[],equipmentList:[],actives:null,inHeaders:[{text:"序号",sortable:!1},{text:"入库时间",sortable:!1},{text:"入库位置",sortable:!1},{text:"入库数量",sortable:!1},{text:"库存量",sortable:!1},{text:"是否超出库龄",sortable:!1}],DataSource1:[],statusList:[],gdTypeList:[],sparePartsDocumentList:[],selectDocument:[],deleteDocumentIndex:""}},components:{UploadInput:x["a"],gridTemplate:n["a"],UploadFile:c["a"],contentModal:u["a"],dataTable:h["a"],treeView:l["a"],fileUploader:b["a"]},mounted:function(){this.spareParts=new r["a"],this.init()},computed:{equipments:function(){var e=[],t=[];if(this.equipmentList.forEach((function(s){void 0==s.eType||null==s.eType||0==s.eType.length?(s.eType="无",e.push(s)):e.push(s),-1==t.indexOf(s.eType)&&(void 0==s.eType||null==s.eType||0==s.eType.length?t.includes("无")||t.push("无"):t.push(s.eType))})),t.forEach((function(t,s){e.push({name:t,id:s+1,parentId:-1,isshow:!1})})),void 0==this.equipmentList||null==this.equipmentList||0==this.equipmentList.length);else{this.equipmentList.forEach((function(e){e.name=e.nameAndModel}));for(var s=0;s<e.length;s++)for(var a=0;a<e.length;a++)if(e[s].eType==e[a].name){e[s].parentId=e[a].id;break}}return e}},methods:{init:function(){var e=this;this.$Server.queryAll((new f["a"]).__name,{},{deleted:"false"}).then((function(t){e.supplierList=t.datas.filter((function(e){return e.ctypeName&&e.ctypeName.indexOf("供应商")>-1||void 0==e.ctypeName||null==e.ctypeName})),e.manufacturerList=t.datas.filter((function(e){return e.ctypeName&&e.ctypeName.indexOf("生产厂商")>-1||void 0==e.ctypeName||null==e.ctypeName}))})),this.$Server.queryAll((new p["a"]).__name).then((function(t){e.equipmentList=t.datas})),this.$Server.queryAll((new v["a"]).__name,{},{dname:"ABC类"}).then((function(t){e.abcTypeList=t.datas})),this.$Server.queryAll((new v["a"]).__name,{},{dname:"使用频次"}).then((function(t){e.fmrTypeList=t.datas})),this.$Server.queryAll((new v["a"]).__name,{},{dname:"备件类型"}).then((function(t){e.typeList=t.datas})),this.$Server.queryAll((new v["a"]).__name,{},{dname:"单位"}).then((function(t){e.periodUnitList=t.datas})),this.$Server.queryAll((new v["a"]).__name,{},{dname:"备件状态"}).then((function(t){e.statusList=t.datas})),this.$Server.queryAll((new v["a"]).__name,{},{dname:"备件好坏"}).then((function(t){e.gdTypeList=t.datas})),this.editAssets={abcType:{},originalValue:"",procurementCycle:"",serviceLife:"",fmrType:{}}},afterInit:function(e){var t=this;0==this.actives&&e.forEach((function(e){e.inventory<e.minInventory&&(e.inventoryStr=t.$Utils.setRedBackground(e.inventoryStr))}))},editorsReCode:function(e){this.editors=e,this.sparePartsEditors=e,this.sparePartsEditors=this.sparePartsEditors.filter((function(e){return!("positions"==e.field)})),this.$refs.childGridTemplate.editors=[]},findLocationInfo:function(e){var t=this;this.locations=[],this.$Server.queryAll(y.getModelName(),{page:"-1",rowsPerPage:"-1"},{sparePartsID:e.id}).then((function(e){t.locations=e.datas.filter((function(e){return 0!==e.inventory}))}),(function(e){return m["a"].alert(e)})),t.slocationList=[],this.$Server.queryAll(D.getModelName()).then((function(e){t.slocationList=e.datas}))},beforeEdit:function(e,t){var s=this;if(this.findLocationInfo(e),this.editAssets=JSON.parse(JSON.stringify(t)),this.editAssets.status&&(this.editAssets.status=this.statusList.find((function(e){return e.dvalue==s.editAssets.status.dvalue}))),this.editAssets.gdType&&(this.editAssets.gdType=this.gdTypeList.find((function(e){return e.dvalue==s.editAssets.gdType.dvalue}))),null!=this.editAssets.document&&(this.editAssets.document.dname=this.editAssets.document.dname+this.editAssets.document.newestFileExt),this.editAssets.supplier){var a=this.supplierList.find((function(e){return e.id===s.editAssets.supplier}));a&&(this.editAssets.supplier=a)}if(this.editAssets.manufacturer){var i=this.manufacturerList.find((function(e){return e.id===s.editAssets.manufacturer}));i&&(this.editAssets.manufacturer=i)}this.sparePartsDocumentList=[],this.editAssets.spareDocumentList&&this.editAssets.spareDocumentList.forEach((function(e){s.sparePartsDocumentList.push(e)}))},beforeAdd:function(e){this.locations=[],this.locations.push({});var t=this;t.slocationList=[],this.$Server.queryAll(D.getModelName()).then((function(e){t.slocationList=e.datas})),this.editAssets={abcType:{},originalValue:"",procurementCycle:"",serviceLife:"",fmrType:{},standardDName:""},this.editAssets.equipments=[],this.editAssets.status=this.statusList.find((function(e){return"启用"==e.dname})),this.editAssets.gdType=this.gdTypeList.find((function(e){return"正常"==e.dname})),this.editAssets.spareDocumentList=[],this.sparePartsDocumentList=[]},beforeEditSubmit:function(e){var t=this;this.editors.forEach((function(s){e[s.field]=t.editAssets[s.field]})),e.miniOrder=this.editAssets.miniOrder,e.safeCount=this.editAssets.safeCount,e.positions=this.locations,e.standardDName=this.editAssets.standardDName,e.version=this.editAssets.version,e.acceptanceFile=this.editAssets.acceptanceFile;var s={dname:"",docuFile:"",newestFileSize:""};e.spareDocumentList=this.sparePartsDocumentList,e.gdType=this.editAssets.gdType,null!=e.document&&e.document.length>0?(""!=e.standardDName&&void 0!=e.standardDName.length?s.dname=e.standardDName+e.document[0].name.substring(e.document[0].name.lastIndexOf(".")):s.dname=e.document[0].name,s.docuFile=e.document[0].data,s.newestFileSize=e.document[0].size,e.document=s):e.document=null,this.editAssets.supplier&&(e.supplier=this.editAssets.supplier.id),this.editAssets.manufacturer&&(e.manufacturer=this.editAssets.manufacturer.id)},beforeExcuteDelete:function(e){e.forEach((function(e){e.inventory=""}))},addRow:function(){this.locations.push({})},getFileData:function(){},addUpload:function(){this.sparePartsDocumentList?this.sparePartsDocumentList.push({documentViewModel:{}}):this.sparePartsDocumentList=[{}]},getClickDocument:function(e,t){this.selectDocument=[],this.selectDocument.push(e),this.deleteDocumentIndex=t},removeUpload:function(){this.selectDocument.length>0?this.sparePartsDocumentList.length>0&&this.sparePartsDocumentList.splice(this.deleteDocumentIndex,1):m["a"].alert("选择一个需要删除的附件")},downloadFile:function(e){if(e&&e.newestFilePath){var t=document.createElement("a");t.href=e.newestFilePath,t.download=e.dname+e.newestFileExt,t.click()}},deleteLocation:function(){var e=this;this.selectLocation.length>0?this.locations.length>1?e.locations.splice(this.deleteIndex,1):m["a"].alert("必须有一个位置信息"):m["a"].alert("选择一个需要删除的位置")},getAcceptData:function(e){var t=this,s=e.get("data");if(s){var a=s.name.substring(s.name.lastIndexOf(".")+1,s.name.length);"doc"!=a&&"docx"!=a&&"ppt"!=a&&"pptx"!=a&&"pdf"!=a&&"xls"!=a&&"xlsx"!=a&&(m["a"].alert("请检查文件格式是否正确"),t.$refs.uploadAcceptFile.clearFile())}},doSearch:function(){var e=this;this.$refs.childGridTemplate.doSearch({nameOrCode:e.searchValue})},clearMessage:function(){this.$refs.childGridTemplate.doSearch({})},exportSpareParts:function(){this.$Server.exportFile("SpareParts","备件台账"+this.$Utils.getLocalFotmatTime())},importSpareParts:function(){this.IsShowImport=!0},modalClosedImport:function(){this.IsShowImport=!1,this.$refs.uploadFile.clearFile()},ComfirmImport:function(){var e=this,t=this.$refs.uploadFile.filename,s={base64:this.base64,fileName:t,fileType:"xls"};null==this.base64||0==this.base64.length?m["a"].alert("请选择导入的文件"):this.$Server.importFile((new r["a"]).__name,s).then((function(t){t.success&&null==t.datas.error?(m["a"].alert("导入成功","success"),e.IsShowImport=!1,e.$refs.uploadFile.clearFile(),e.$refs.childGridTemplate.init()):m["a"].alert(t.datas.error)}),(function(e){return m["a"].alert(e)}))},getFormData:function(e){var t=this,s=e.get("data");if(s){var a=s.name.substring(s.name.lastIndexOf(".")+1,s.name.length);"xls"!=a&&"xlsx"!=a&&(m["a"].alert("请检查文件是否为Excel文件"),t.$refs.uploadFile.clearFile())}},downloadTemp:function(){var e=document.createElement("a");e.href="/imporTemp/spareParts.xls",e.download="备件台账.xls",e.click()},modalClosed:function(){this.IsShowDetails=!1,this.$refs.childGridTemplate.init()},rowDbClick:function(e){var t=this;this.sparePartsDetail=JSON.parse(JSON.stringify(e)),this.findLocationInfo(e),this.sparePartsDetail.gdType&&this.sparePartsDetail.gdType.dname&&(this.sparePartsDetail.gdType=this.gdTypeList.find((function(e){return e.dvalue==t.sparePartsDetail.gdType.dvalue}))),this.sparePartsDetail.status&&this.sparePartsDetail.status.dname&&(this.sparePartsDetail.status=this.statusList.find((function(e){return e.dvalue==t.sparePartsDetail.status.dvalue}))),this.IsShowDetails=!0},getClick:function(e,t){this.selectLocation=[],this.selectLocation.push(e),this.deleteIndex=t},tabClick:function(e){var t=this;t.initCondition.locationType=this.actives,this.$refs.childGridTemplate&&this.$refs.childGridTemplate.doSearch(t.initCondition)},downloadDocument:function(e){console.log(e);var t=document.createElement("a");t.href=e.newestFilePath,t.download=e.dname+e.newestFileExt,t.click()}}},A=g,k=(s("5883"),s("6691")),P=Object(k["a"])(A,a,i,!1,null,"e545ba9c",null);t["default"]=P.exports},eb21:function(e,t,s){}}]);