(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62db736f"],{"341e":function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var i=a("7300"),r=a("5873"),n=a("ddf2"),s=a("80ea"),l=a("ae0a"),d=a("97a3"),c=a("652a"),o=a("1269"),u=a("a7fe"),m=new c["a"],b=function(e){function t(){var e,a;Object(i["a"])(this,t);for(var l=arguments.length,c=new Array(l),o=0;o<l;o++)c[o]=arguments[o];return a=Object(r["a"])(this,(e=Object(n["a"])(t)).call.apply(e,[this].concat(c))),Object(d["a"])(Object(s["a"])(a),"__name","MaintenancePlan"),Object(d["a"])(Object(s["a"])(a),"id",m.charField({require:!1,visible:!1,fieldName:"id",editable:!1})),Object(d["a"])(Object(s["a"])(a),"code",m.charField({require:!1,visible:!0,fieldName:"保养计划编号",maxLength:36,rules:[function(e){return!e||/^[\w|-]+$/.test(e)||"只能是数字,字母,下划线"}]})),Object(d["a"])(Object(s["a"])(a),"name",m.charField({require:!0,visible:!0,fieldName:"保养计划名称",maxLength:36})),Object(d["a"])(Object(s["a"])(a),"isAutoChinese",m.charField({require:!1,visible:!0,fieldName:"生成方式",editable:!1})),Object(d["a"])(Object(s["a"])(a),"constructByChinese",m.charField({require:!1,visible:!0,fieldName:"生成维度",editable:!1})),Object(d["a"])(Object(s["a"])(a),"startDate",m.dateField({require:!0,editable:!0,fieldName:"计划开始时间",visible:!0,menu:"purchase",format:function(e){if(e)return e.substring(0,10)}})),Object(d["a"])(Object(s["a"])(a),"endDate",m.dateField({require:!0,editable:!0,fieldName:"计划结束时间",visible:!0,menu:"purchase",format:function(e){if(e)return e.substring(0,10)}})),Object(d["a"])(Object(s["a"])(a),"actualStartDate",m.dateField({require:!1,fieldName:"实际开始时间",visible:!0,editable:!1,menu:"purchase",format:function(e){if(e)return e.substring(0,10)}})),Object(d["a"])(Object(s["a"])(a),"actualEndDate",m.dateField({require:!1,fieldName:"实际结束时间",visible:!0,editable:!1,menu:"purchase",format:function(e){if(e)return e.substring(0,10)}})),Object(d["a"])(Object(s["a"])(a),"equipmentViewModelList",m.charField({require:!0,visible:!1,fieldName:"设备列表",editable:!1})),Object(d["a"])(Object(s["a"])(a),"generation",m.charField({require:!0,visible:!1,fieldName:"生成方式",editable:!1})),Object(d["a"])(Object(s["a"])(a),"statusName",m.charField({require:!0,visible:!0,fieldName:"状态",editable:!1})),Object(d["a"])(Object(s["a"])(a),"status",m.comboBoxField(u["a"],{require:!0,visible:!1,editable:!1,fieldName:"状态",bindSource:{parms:{dname:"状态"}},format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),a}return Object(l["a"])(t,e),t}(o["a"])},"44af":function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var i=a("7300"),r=a("5873"),n=a("ddf2"),s=a("80ea"),l=a("ae0a"),d=a("97a3"),c=a("652a"),o=a("1269"),u=a("341e"),m=new c["a"],b=function(e){function t(){var e,a;Object(i["a"])(this,t);for(var l=arguments.length,c=new Array(l),o=0;o<l;o++)c[o]=arguments[o];return a=Object(r["a"])(this,(e=Object(n["a"])(t)).call.apply(e,[this].concat(c))),Object(d["a"])(Object(s["a"])(a),"__name","MaintainTask"),Object(d["a"])(Object(s["a"])(a),"code",m.charField({require:!0,fieldName:"保养单编号"})),Object(d["a"])(Object(s["a"])(a),"maintenancePlanId",m.comboBoxField(u["a"],{require:!0,editable:!0,visible:!1,fieldName:"保养计划",bindSource:{text:"name",value:"id",parms:{}}})),Object(d["a"])(Object(s["a"])(a),"planName",m.charField({require:!1,fieldName:"保养计划名称",editable:!1})),Object(d["a"])(Object(s["a"])(a),"ecode",m.charField({require:!1,fieldName:"设备编号",editable:!1})),Object(d["a"])(Object(s["a"])(a),"ename",m.charField({require:!1,fieldName:"设备名称",editable:!1})),Object(d["a"])(Object(s["a"])(a),"eposition",m.charField({require:!1,fieldName:"设备位置",editable:!1})),Object(d["a"])(Object(s["a"])(a),"originalEndDate",m.dateField({fieldName:"原保养时间",editable:!1,visible:!0,format:function(e){if(e)return e.substring(0,10)}})),Object(d["a"])(Object(s["a"])(a),"startTime",m.dateField({fieldName:"保养时间",editable:!1,format:function(e){if(e)return e.substring(0,10)}})),Object(d["a"])(Object(s["a"])(a),"actualStartDate",m.dateField({require:!1,fieldName:"实际保养时间",editable:!1,visible:!0})),Object(d["a"])(Object(s["a"])(a),"actualEndDate",m.dateField({require:!1,fieldName:"实际保养结束时间",editable:!1,visible:!1})),Object(d["a"])(Object(s["a"])(a),"endDate",m.charField({require:!1,fieldName:"保养结束时间",editable:!1,visible:!1})),Object(d["a"])(Object(s["a"])(a),"assignedUser",m.comboBoxField(null,{require:!0,fieldName:"负责人",editable:!0,visible:!1,comboboxSelect:[],text:"uname",value:"id"})),Object(d["a"])(Object(s["a"])(a),"userName",m.charField({require:!1,fieldName:"负责人",editable:!1})),Object(d["a"])(Object(s["a"])(a),"statusName",m.charField({fieldName:"任务状态"})),Object(d["a"])(Object(s["a"])(a),"status",m.comboBoxField(null,{require:!0,fieldName:"任务状态",visible:!1,editable:!1,format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),Object(d["a"])(Object(s["a"])(a),"userList",m.charField({require:!1,visible:!1,editable:!1})),Object(d["a"])(Object(s["a"])(a),"recordList",m.charField({require:!1,visible:!1,editable:!1})),Object(d["a"])(Object(s["a"])(a),"editAssignedUser",m.charField({require:!1,visible:!1})),a}return Object(l["a"])(t,e),t}(o["a"])},"80c8":function(e,t,a){},a504:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var i=a("7300"),r=a("5873"),n=a("ddf2"),s=a("80ea"),l=a("ae0a"),d=a("97a3"),c=a("652a"),o=a("1269"),u=a("2c75"),m=new c["a"],b=function(e){function t(){var e,a;Object(i["a"])(this,t);for(var l=arguments.length,c=new Array(l),o=0;o<l;o++)c[o]=arguments[o];return a=Object(r["a"])(this,(e=Object(n["a"])(t)).call.apply(e,[this].concat(c))),Object(d["a"])(Object(s["a"])(a),"__name","RMaintainStandardSpareParts"),Object(d["a"])(Object(s["a"])(a),"sparePartsId",m.comboBoxField(u["a"],{require:!0,fieldName:"备件"})),Object(d["a"])(Object(s["a"])(a),"model",m.charField({require:!1,fieldName:"规格型号"})),Object(d["a"])(Object(s["a"])(a),"amount",m.numberField("int",{require:!0,visible:!0,fieldName:"数量"})),Object(d["a"])(Object(s["a"])(a),"part",m.charField({require:!1,fieldName:"更换位置"})),Object(d["a"])(Object(s["a"])(a),"id",m.charField({require:!1,fieldName:"id",visible:!1})),Object(d["a"])(Object(s["a"])(a),"maintenancePlanId",m.charField({require:!1,fieldName:"保养计划id",editable:!1})),a}return Object(l["a"])(t,e),t}(o["a"])},b103:function(e,t,a){"use strict";var i=a("80c8"),r=a.n(i);r.a},c27d:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{"max-width":"1100px",persistent:!0,scrollable:""},model:{value:e.IsShow,callback:function(t){e.IsShow=t},expression:"IsShow"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v("分配负责人")])]),a("v-card-text",[e._t("default")],2),a("v-card-actions",{staticClass:"marginbottom"},[a("v-spacer"),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.modalComfirmed()}}},[e._v("一键分配")]),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.modalClosed()}}},[e._v("关闭")])],1)],1)],1)],1)},r=[],n={name:"distributeUser",props:["IsShow"],methods:{modalComfirmed:function(){this.$emit("modalComfirmed")},modalClosed:function(){this.$emit("modalClosed")}}},s=n,l=a("6691"),d=Object(l["a"])(s,i,r,!1,null,"50e75e90",null);t["a"]=d.exports},d1fc:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var i=a("7300"),r=a("5873"),n=a("ddf2"),s=a("80ea"),l=a("ae0a"),d=a("97a3"),c=a("652a"),o=a("1269"),u=a("a504"),m=new c["a"],b=function(e){function t(){var e,a;Object(i["a"])(this,t);for(var l=arguments.length,c=new Array(l),o=0;o<l;o++)c[o]=arguments[o];return a=Object(r["a"])(this,(e=Object(n["a"])(t)).call.apply(e,[this].concat(c))),Object(d["a"])(Object(s["a"])(a),"__name","MaintainStandard"),Object(d["a"])(Object(s["a"])(a),"equipmentId",m.charField({require:!1,visible:!1,fieldName:"设备id"})),Object(d["a"])(Object(s["a"])(a),"code",m.charField({require:!1,visible:!0,fieldName:"设备编号",tableOrder:9})),Object(d["a"])(Object(s["a"])(a),"name",m.charField({require:!1,visible:!0,fieldName:"设备名称",tableOrder:10})),Object(d["a"])(Object(s["a"])(a),"model",m.charField({require:!1,visible:!0,fieldName:"规格型号",tableOrder:20})),Object(d["a"])(Object(s["a"])(a),"position",m.charField({require:!1,visible:!1,fieldName:"设备位置",tableOrder:30})),Object(d["a"])(Object(s["a"])(a),"part",m.charField({require:!0,visible:!1,fieldName:"保养位置",tableOrder:40})),Object(d["a"])(Object(s["a"])(a),"content",m.charField({require:!0,visible:!0,fieldName:"保养内容",tableOrder:50})),Object(d["a"])(Object(s["a"])(a),"purpose",m.charField({require:!0,visible:!1,fieldName:"保养目的"})),Object(d["a"])(Object(s["a"])(a),"purposeChinese",m.charField({require:!0,visible:!0,fieldName:"保养目的",tableOrder:60})),Object(d["a"])(Object(s["a"])(a),"method",m.charField({require:!0,visible:!0,fieldName:"保养方法",tableOrder:70})),Object(d["a"])(Object(s["a"])(a),"materiel",m.charField({require:!1,visible:!0,fieldName:"保养工具物料"})),Object(d["a"])(Object(s["a"])(a),"standard",m.charField({require:!0,visible:!0,fieldName:"标准描述",tableOrder:80})),Object(d["a"])(Object(s["a"])(a),"spendTime",m.numberField("int",{require:!0,visible:!0,fieldName:"标准保养时间(min)",tableOrder:90})),Object(d["a"])(Object(s["a"])(a),"periodData",m.charField({require:!0,visible:!0,fieldName:"保养周期",tableOrder:100})),Object(d["a"])(Object(s["a"])(a),"eqpStatus",m.charField({require:!0,visible:!1,fieldName:"设备状态"})),Object(d["a"])(Object(s["a"])(a),"eqpStatusChinese",m.charField({require:!0,visible:!0,fieldName:"保养时设备状态",tableOrder:110})),Object(d["a"])(Object(s["a"])(a),"dataEqpStatus",m.charField({require:!1,visible:!1,fieldName:"保养目的",format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),Object(d["a"])(Object(s["a"])(a),"datePurpose",m.charField({require:!1,visible:!1,fieldName:"保养目的",format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),Object(d["a"])(Object(s["a"])(a),"period",m.charField({require:!0,visible:!1,fieldName:"保养周期"})),Object(d["a"])(Object(s["a"])(a),"periodUnit",m.charField({require:!0,visible:!1,fieldName:"周期单位"})),Object(d["a"])(Object(s["a"])(a),"lastMaintainTime",m.charField({require:!0,visible:!0,fieldName:"上次保养时间",editable:!1,tableOrder:120,format:function(e){if(e)return e.substring(0,10)}})),Object(d["a"])(Object(s["a"])(a),"nextMaintainTime",m.charField({require:!0,visible:!1,fieldName:"下次保养时间",editable:!1})),Object(d["a"])(Object(s["a"])(a),"description",m.charField({require:!1,visible:!1,fieldName:"备注",editable:!1})),Object(d["a"])(Object(s["a"])(a),"rMaintainStandardSparePartsViewModelList",m.oneToManyField(u["a"],"fff",{editableMode:"grid"})),a}return Object(l["a"])(t,e),t}(o["a"])},fe12:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("layContentHeader",{attrs:{title:"保养工单",buttons:e.headerBtns}},[a("div",{staticStyle:{display:"inline-block"}},[a("v-text-field",{staticStyle:{width:"370px"},attrs:{label:"请输入保养单编号，计划名称或负责人",clearable:"","hide-details":"","single-line":"",primary:"",disabled:e.isActive},on:{"click:clear":e.clearMessage},scopedSlots:e._u([{key:"append-outer",fn:function(){return[a("v-icon",{attrs:{disabled:e.isActive},on:{click:function(t){return e.doSearch()}}},[e._v("search")])]},proxy:!0}]),model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1)]),a("layContent",[a("v-tabs",{attrs:{"slider-color":"primary"},on:{change:e.tabClick}},[a("v-tab",{key:1},[e._v("\n                保养工单\n            ")]),a("v-tab",{key:2},[e._v("\n                我的工单\n            ")]),a("v-tab-item",{key:1}),a("v-tab-item",{key:2},[a("br"),a("v-tabs",{on:{change:e.subTabClick},model:{value:e.activesChild,callback:function(t){e.activesChild=t},expression:"activesChild"}},[a("v-tab",[e._v("\n                            未完成\n                        ")]),a("v-tab",[e._v("\n                            已完成\n                        ")])],1)],1)],1),a("gridTemplate",{ref:"childGridTemplate",attrs:{title:"保养任务",gridModel:e.maintainTask,sort:!0},on:{afterInit:e.afterInit,editorsReCode:e.editorsReCode,beforeEdit:e.beforeEdit,beforeAdd:e.beforeAdd,beforeEditSubmit:e.beforeEditSubmit,rowDbClick:e.rowDbClick}},[a("v-layout",{attrs:{wrap:"",row:""}},[a("v-flex",[a("v-select",{attrs:{label:"保养计划名称",items:e.dataDictSource,"item-text":"name","return-object":"",readonly:1==e.Isupdate},on:{change:function(t){return e.comboboxChange(e.maintainplan)}},model:{value:e.maintainplan,callback:function(t){e.maintainplan=t},expression:"maintainplan"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"保养类型",disabled:""},model:{value:e.maintainplanType,callback:function(t){e.maintainplanType=t},expression:"maintainplanType"}})],1),a("v-flex",[a("v-select",{attrs:{label:"负责人",items:e.users,"item-text":"uname","item-value":"id"},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"设备编号",disabled:""},model:{value:e.equipment.code,callback:function(t){e.$set(e.equipment,"code",t)},expression:"equipment.code"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"设备名称",disabled:""},model:{value:e.equipment.name,callback:function(t){e.$set(e.equipment,"name",t)},expression:"equipment.name"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"规格型号",disabled:""},model:{value:e.equipment.model,callback:function(t){e.$set(e.equipment,"model",t)},expression:"equipment.model"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"设备类型",disabled:""},model:{value:e.equipment.type,callback:function(t){e.$set(e.equipment,"type",t)},expression:"equipment.type"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"设备位置",disabled:""},model:{value:e.equipment.position,callback:function(t){e.$set(e.equipment,"position",t)},expression:"equipment.position"}})],1)],1)],1)],1),a("distribute-user",{attrs:{title:"分配负责人",IsShow:e.IsShow,isDetails:!0},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[a("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,items:e.DataSource,totalDatas:e.totalDatas,hideOperation:!0,hideHeaders:!1,total:e.total},on:{chooseAssignedUser:e.chooseAssignedUser,selectChangeForSave:e.selectChangeForSave}})],1),a("contentModal",{attrs:{title:"保养时间调整",IsShow:e.IsShowTime},on:{modalClosed:function(t){return e.modalClosedTime()},modalComfirmed:function(t){return e.modalComfirmedTime()}}},[a("div",{staticStyle:{padding:"24px"}},[a("v-form",{ref:"form",attrs:{valid:"true","lazy-validation":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{label:"原计划保养日期",disabled:""},model:{value:e.maintainTime.originalEndDate,callback:function(t){e.$set(e.maintainTime,"originalEndDate",t)},expression:"maintainTime.originalEndDate"}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-dialog",{ref:"dialog",attrs:{"return-value":e.maintainTime.startTime,lazy:"","full-width":"",width:"290"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[a("v-text-field",{attrs:{slot:"activator","prepend-icon":"event",readonly:"",maxlength:"10",clearable:"",rules:[function(e){return!!e||"必须填"},function(e){return new Date(e)>=new Date((new Date).toISOString().substring(0,10))||"时间必须在当前时间之后"}],label:"将时间调整至"},slot:"activator",model:{value:e.maintainTime.startTime,callback:function(t){e.$set(e.maintainTime,"startTime",t)},expression:"maintainTime.startTime"}}),a("v-date-picker",{attrs:{locale:"zh-ch",dayFormat:e.dayFormat},on:{change:function(t){e.modal=!1}},model:{value:e.maintainTime.startTime,callback:function(t){e.$set(e.maintainTime,"startTime",t)},expression:"maintainTime.startTime"}})],1)],1)],1)],1)],1)]),a("MaintainRecordEdit",{ref:"MaintainRecordEdit",attrs:{IsShowRecord:e.IsShowRecord,task:e.task,recordHeaders:e.recordHeaders,recordDataSource:e.recordDataSource},on:{recordComfirmed:e.recordComfirmed,recordClosed:e.recordClosed,saveAndClose:e.saveAndClose}}),a(e.currentView,{ref:"componentForm",tag:"component"}),a("MaintainRecordDetail",{attrs:{IsShowDetails:e.IsShowDetails,taskDetail:e.taskDetail,sparesList:e.sparesList},on:{detailClosed:e.detailClosed}}),a("comfirmModal",{attrs:{title:"提示",IsShow:e.IsComfirmCancel,text:"确认取消这条任务"},on:{modalComfirmedClose:function(t){return e.modalComfirmedClose()},modalComfirmed:function(t){return e.confirmCancel()}}})],1)},r=[],n=(a("bada"),a("4634"),a("c041"),a("0b34"),a("a2a7")),s=a("44af"),l=a("7300"),d=a("5873"),c=a("ddf2"),o=a("80ea"),u=a("ae0a"),m=a("97a3"),b=a("652a"),f=a("1269"),h=a("341e"),v=new b["a"],p=function(e){function t(){var e,a;Object(l["a"])(this,t);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return a=Object(d["a"])(this,(e=Object(c["a"])(t)).call.apply(e,[this].concat(r))),Object(m["a"])(Object(o["a"])(a),"__name","MaintainTask"),Object(m["a"])(Object(o["a"])(a),"code",v.charField({require:!0,fieldName:"保养单编号"})),Object(m["a"])(Object(o["a"])(a),"maintenancePlanId",v.comboBoxField(h["a"],{require:!0,editable:!0,visible:!1,fieldName:"保养计划",bindSource:{text:"name",value:"id",parms:{}}})),Object(m["a"])(Object(o["a"])(a),"planName",v.charField({require:!1,fieldName:"保养计划名称",editable:!1})),Object(m["a"])(Object(o["a"])(a),"ecode",v.charField({require:!1,fieldName:"设备编号",editable:!1})),Object(m["a"])(Object(o["a"])(a),"ename",v.charField({require:!1,fieldName:"设备名称",editable:!1})),Object(m["a"])(Object(o["a"])(a),"eposition",v.charField({require:!1,fieldName:"设备位置",editable:!1})),Object(m["a"])(Object(o["a"])(a),"originalEndDate",v.dateField({fieldName:"原保养时间",editable:!1,visible:!0,format:function(e){if(e)return e.substring(0,10)}})),Object(m["a"])(Object(o["a"])(a),"startTime",v.dateField({fieldName:"保养时间",editable:!1,format:function(e){if(e)return e.substring(0,10)}})),Object(m["a"])(Object(o["a"])(a),"actualStartDate",v.dateField({require:!1,fieldName:"实际保养时间",editable:!1,visible:!1})),Object(m["a"])(Object(o["a"])(a),"actualEndDate",v.dateField({require:!1,fieldName:"实际保养结束时间",editable:!1,visible:!1})),Object(m["a"])(Object(o["a"])(a),"endDate",v.charField({require:!1,fieldName:"保养结束时间",editable:!1,visible:!1})),Object(m["a"])(Object(o["a"])(a),"assignedUser",v.comboBoxField(null,{require:!0,fieldName:"负责人",editable:!0,visible:!1,comboboxSelect:[],text:"uname",value:"id"})),Object(m["a"])(Object(o["a"])(a),"userName",v.charField({require:!1,fieldName:"负责人",editable:!1})),Object(m["a"])(Object(o["a"])(a),"statusName",v.charField({fieldName:"任务状态"})),Object(m["a"])(Object(o["a"])(a),"status",v.comboBoxField(null,{require:!0,fieldName:"任务状态",visible:!1,editable:!1,format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),Object(m["a"])(Object(o["a"])(a),"userList",v.charField({require:!1,visible:!1,editable:!1})),Object(m["a"])(Object(o["a"])(a),"recordList",v.charField({require:!1,visible:!1,editable:!1})),Object(m["a"])(Object(o["a"])(a),"editAssignedUser",v.charField({require:!1,visible:!1})),a}return Object(u["a"])(t,e),t}(f["a"]),O=a("b9da"),j=a("8333"),x=a("52d6"),g=(a("f753"),a("d5b3")),S=new b["a"],k=function(e){function t(){var e,a;Object(l["a"])(this,t);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return a=Object(d["a"])(this,(e=Object(c["a"])(t)).call.apply(e,[this].concat(r))),Object(m["a"])(Object(o["a"])(a),"__name","MaintainRecord"),Object(m["a"])(Object(o["a"])(a),"taskId",S.charField({visible:!1,fieldName:"任务ID"})),Object(m["a"])(Object(o["a"])(a),"maintainStandardId",S.charField({require:!1,fieldName:"保养标准编号",editable:!1,inlineEdit:!1,visible:!1})),Object(m["a"])(Object(o["a"])(a),"result",S.boolField({require:!0,fieldName:"保养结果",inlineEdit:!0,boolSelect:["已完成","未完成"],format:function(e){return e?"已完成":"未完成"}})),Object(m["a"])(Object(o["a"])(a),"description",S.charField({require:!1,fieldName:"备注",inlineEdit:!0})),Object(m["a"])(Object(o["a"])(a),"documentID",S.fileField({require:!1,fieldName:"上传附件",visible:!0})),Object(m["a"])(Object(o["a"])(a),"maintainStandardViewMode",S.charField({require:!1,fieldName:"保养标准",editable:!1,visible:!1})),Object(m["a"])(Object(o["a"])(a),"standard",S.charField({require:!1,visible:!1,editable:!1})),Object(m["a"])(Object(o["a"])(a),"sparesList",S.charField({visible:!1,editable:!1})),Object(m["a"])(Object(o["a"])(a),"documentList",S.charField({require:!1,visible:!1,editable:!1})),Object(m["a"])(Object(o["a"])(a),"eqpStatus",S.charField({require:!1,visible:!1,editable:!1,format:function(e){if(null!=e&&null!=e.dname)return e.dname}})),a}return Object(u["a"])(t,e),t}(f["a"]),D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{"max-width":"1300px",persistent:!0,scrollable:""},model:{value:e.IsShowDetails,callback:function(t){e.IsShowDetails=t},expression:"IsShowDetails"}},[a("v-form",{ref:"form",staticStyle:{width:"100%"},attrs:{valid:"true"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v("查看工单详情")])]),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs3:"",light:""}},[a("v-text-field",{attrs:{disabled:"",label:"设备编号"},model:{value:e.taskDetail.ecode,callback:function(t){e.$set(e.taskDetail,"ecode",t)},expression:"taskDetail.ecode"}})],1),a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"设备名称"},model:{value:e.taskDetail.ename,callback:function(t){e.$set(e.taskDetail,"ename",t)},expression:"taskDetail.ename"}})],1),a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"规格型号"},model:{value:e.taskDetail.model,callback:function(t){e.$set(e.taskDetail,"model",t)},expression:"taskDetail.model"}})],1),a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"点巡检位置"},model:{value:e.taskDetail.eposition,callback:function(t){e.$set(e.taskDetail,"eposition",t)},expression:"taskDetail.eposition"}})],1)],1),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{dark:"",xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"保养人"},model:{value:e.taskDetail.userName,callback:function(t){e.$set(e.taskDetail,"userName",t)},expression:"taskDetail.userName"}})],1),a("v-flex",{attrs:{dark:"",xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"保养开始时间"},model:{value:e.taskDetail.actualStartDate,callback:function(t){e.$set(e.taskDetail,"actualStartDate",t)},expression:"taskDetail.actualStartDate"}})],1),a("v-flex",{attrs:{dark:"",xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"保养结束时间"},model:{value:e.taskDetail.actualEndDate,callback:function(t){e.$set(e.taskDetail,"actualEndDate",t)},expression:"taskDetail.actualEndDate"}})],1)],1),a("v-layout",{attrs:{xs12:""}},[a("v-flex",{staticStyle:{"font-size":"16px","font-weight":"bold"},attrs:{xs12:""}},[e._v("保养内容")])],1),a("v-layout",[a("v-flex",{attrs:{xs12:""}},[a("SimpleDataTable",{attrs:{items:e.standardList,headers:e.headers,hideHeaders:!1,formatFields:e.formatFields},on:{downloadFile:e.downloadFile}})],1)],1),a("v-layout",{attrs:{xs12:""}},[a("v-flex",{staticStyle:{"font-size":"16px","font-weight":"bold"},attrs:{xs12:""}},[e._v("更换备件")])],1),a("v-layout",[a("v-flex",{attrs:{xs12:""}},[a("SimpleDataTable",{attrs:{items:e.sparesList,headers:e.spareHeaders,hideHeaders:!1}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.detailComfirmed()}}},[e._v("关闭")])],1)],1)],1)],1)],1)},F=[],T=a("ef3e"),w=new b["a"],N=(f["a"],a("d1fc")),q=a("a504"),I=(new j["a"](new q["a"]),new j["a"](new N["a"])),C={components:{SimpleDataTable:T["a"]},data:function(){return{source:[],headers:[{text:"保养内容",value:"content",align:"center",sortable:!1},{text:"保养目的",value:"datePurpose",align:"center",sortable:!1},{text:"保养位置",value:"part",align:"center",sortable:!1},{text:"标准保养时间",value:"spendTimes",align:"center",sortable:!1},{text:"保养周期",value:"periodData",align:"center",sortable:!1},{text:"保养方法",value:"method",align:"center",sortable:!1},{text:"保养设备状态",value:"dataEqpStatus",align:"center",sortable:!1},{text:"标准描述",value:"standard",align:"center",sortable:!1},{text:"是否异常",value:"hasException",align:"center",sortable:!1},{text:"备注",value:"description",align:"center",sortable:!1},{text:"附件",value:"fileName",align:"center",sortable:!1,isFile:!0}],spareHeaders:[{text:"保养内容",value:"content",align:"center",sortable:!1},{text:"备件名称",value:"name",align:"center",sortable:!1},{text:"规格型号",value:"model",align:"center",sortable:!1},{text:"数量",value:"amount",align:"center",sortable:!1},{text:"更换位置",value:"part",align:"center",sortable:!1},{text:"存放位置",value:"address",align:"center",sortable:!1}],formatFields:I.getFormatFields()}},mounted:function(){},computed:{standardList:function(){var e=[];return null!=this.taskDetail&&null!=this.taskDetail.id&&this.taskDetail.recordList.forEach((function(t){null!=t.standard&&null!=t.standard.id&&(null!=t.standard.spendTime&&(t.standard.spendTimes=t.standard.spendTime+"min"),void 0!=t.hasException&&null!=t.hasException&&(t.standard.hasException=0==t.hasException?"否":"是"),t.description&&(t.standard.description=t.description),t.standard.fileName=t.fileName,t.standard.documentList=t.documentList,t.standard.description=t.description,e.push(t.standard))})),e}},methods:{init:function(){var e=this;null==this.taskDetail||null==this.taskDetail.id||""==this.taskDetail.id||this.$Server.queryAll((new k).__name,{},{taskid:this.taskDetail.id}).then((function(t){e.source=t.datas}))},detailComfirmed:function(){this.$emit("detailClosed")},downloadFile:function(e){e.documentList.forEach((function(e){var t=document.createElement("a");t.href=e.newestFilePath,t.download=e.dname,t.click()}))}},props:["IsShowDetails","taskDetail","sparesList"]},y=C,$=a("6691"),E=Object($["a"])(y,D,F,!1,null,null,null),_=E.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{"max-width":"1400px",persistent:!0,scrollable:""},model:{value:e.IsShowRecord,callback:function(t){e.IsShowRecord=t},expression:"IsShowRecord"}},[a("v-form",{ref:"form",staticStyle:{width:"100%"},attrs:{valid:"true"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v("保养记录")])]),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":"",light:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{dark:"",xs2:""}},[a("v-text-field",{attrs:{disabled:"",label:"设备编号"},model:{value:e.task.ecode,callback:function(t){e.$set(e.task,"ecode",t)},expression:"task.ecode"}})],1),a("v-flex",{attrs:{dark:"",xs2:""}},[a("v-text-field",{attrs:{disabled:"",label:"设备名称"},model:{value:e.task.ename,callback:function(t){e.$set(e.task,"ename",t)},expression:"task.ename"}})],1)],1),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{dark:"",xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"保养人"},model:{value:e.task.userName,callback:function(t){e.$set(e.task,"userName",t)},expression:"task.userName"}})],1),a("v-flex",{attrs:{dark:"",xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"保养开始时间"},model:{value:e.task.actualStartDate,callback:function(t){e.$set(e.task,"actualStartDate",t)},expression:"task.actualStartDate"}})],1),a("v-flex",{attrs:{dark:"",xs3:""}},[a("v-text-field",{attrs:{disabled:"",label:"保养结束时间"},model:{value:e.task.actualEndDate,callback:function(t){e.$set(e.task,"actualEndDate",t)},expression:"task.actualEndDate"}})],1)],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",light:""}},[a("p",[e._v("支持上传：文档：doc,docx,xls,xlsx,ppt,pptx,pdf"),a("span",{staticStyle:{"margin-left":"20px","margin-right":"20px"}},[e._v("图片：png，gif，jpg，bmp，jpeg")]),e._v(" 视频：mp4")])])],1),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("mergeTable",{ref:"childDataTable",attrs:{headers:e.recordHeaders,items:e.recordDataSource,hideOperation:!0,hideHeaders:!1,fieldName:e.fieldName,formatFields:e.formatFields},on:{getFormData:e.getFormData}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.recordComplete()}}},[e._v("自动赋值")]),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"warning"},on:{click:e.saveAndClose}},[e._v("暂存并关闭")]),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"success"},on:{click:function(t){return e.recordComfirmed()}}},[e._v("完成")]),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.recordClosed()}}},[e._v("取消")])],1)],1)],1)],1)],1)},L=[],A=(a("7cfd"),new j["a"](new k)),U={data:function(){return{fieldName:"standard.part",formatFields:A.getFormatFields()}},components:{mergeTable:x["a"]},methods:{recordComplete:function(){this.recordDataSource.forEach((function(e){null==e.hasException&&(e.hasException=0)}))},recordComfirmed:function(){var e=0;this.recordDataSource.forEach((function(t){null==t.hasException&&(e=1)})),0==e?(this.recordDataSource.forEach((function(e){e.documentList=[],null!=e.documentID&&e.documentID.length>0&&(e.documentList=[],e.documentID.forEach((function(t){var a={dname:"",docuFile:"",newestFileSize:""};a.dname=t.name,a.docuFile=t.data,a.newestFileSize=t.size,e.documentList.push(a)})))})),this.$emit("recordComfirmed",this.recordDataSource)):g["a"].alert("请填写完表单再提交,是否异常为必填项")},clearFile:function(){this.$refs.childDataTable.clearFile()},recordClosed:function(){this.$refs.childDataTable.clearFile(),this.recordDataSource.forEach((function(e){e.documentID=[]})),this.$emit("recordClosed")},saveAndClose:function(){this.recordDataSource.forEach((function(e){e.documentList=[],null!=e.documentID&&e.documentID.length>0&&(e.documentList=[],e.documentID.forEach((function(t){var a={dname:"",docuFile:"",newestFileSize:""};a.dname=t.name,a.docuFile=t.data,a.newestFileSize=t.size,e.documentList.push(a)})))})),this.$emit("saveAndClose",this.recordDataSource)},getFormData:function(){}},props:["task","recordHeaders","IsShowRecord","recordDataSource"]},R=U,G=(a("b103"),Object($["a"])(R,M,L,!1,null,"3d041850",null)),B=G.exports,P=a("23f5"),V=a("c27d"),z=new j["a"](new s["a"]),H={data:function(){var e=this;return{total:0,isFirstChoose:!1,headerBtns:[{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/MaintenanceRecord"==e.pvalue&&"分配负责人"==e.pname}))),text:"分配负责人",icon:"self_chargeperson",click:function(){return e.chooseAssignedUser(1,10)}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/MaintenanceRecord"==e.pvalue&&"保养时间调整"==e.pname}))),text:"保养时间调整",icon:"self_adjustment",click:function(){return e.adjustTime()}},{disabled:!0,text:"执行",icon:"self_execute",click:function(){return e.excuteMaintain()}},{disabled:!0,text:"取消执行",icon:"self_cancel",click:function(){return e.cancelTask()}}],headerBtns1:[{disabled:!0,text:"分配负责人",icon:"self_chargeperson",click:function(){return e.chooseAssignedUser(1,10)}},{disabled:!0,text:"保养时间调整",icon:"self_adjustment",click:function(){return e.adjustTime()}},{disabled:!this.$per("MaintenanceRecord","exe"),text:"执行",icon:"self_execute",click:function(){return e.excuteMaintain()}},{disabled:!this.$per("MaintenanceRecord","cancel"),text:"取消执行",icon:"self_cancel",click:function(){return e.cancelTask()}}],headerBtns2:[{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/MaintenanceRecord"==e.pvalue&&"分配负责人"==e.pname}))),text:"分配负责人",icon:"self_chargeperson",click:function(){return e.chooseAssignedUser(1,10)}},{disabled:!(-1!=JSON.parse(sessionStorage.getItem("permission")).findIndex((function(e){return"/api/MaintenanceRecord"==e.pvalue&&"保养时间调整"==e.pname}))),text:"保养时间调整",icon:"self_adjustment",click:function(){return e.adjustTime()}},{disabled:!0,text:"执行",icon:"self_execute",click:function(){return e.excuteMaintain()}},{disabled:!0,text:"取消执行",icon:"self_cancel",click:function(){return e.cancelTask()}}],result:[],maintainTask:{},equipment:{},dataDictSource:[],maintainplan:[],users:[],user:[],maintainplanType:"",Isupdate:!1,currentView:"",IsShow:!1,selectUsers:[],select:[],headers:[{text:"保养单编号",value:"code",sortable:!1,align:"center"},{text:"设备编号",value:"ecode",align:"center",sortable:!1},{text:"设备名称",value:"ename",sortable:!1,align:"center"},{text:"设备位置",value:"eposition",sortable:!1,align:"center"},{text:"分配人员",value:"assignedUser",sortable:!1,fieldType:"comboboxField",IsMultiple:!1,align:"center",comboboxSelect:"userList",itemtext:"uname",itemvalue:"id"}],recordHeaders:[{align:"center",inlineEdit:!1,sortable:!1,text:"保养位置",value:"standard.part"},{align:"center",inlineEdit:!1,sortable:!1,text:"保养内容",value:"standard.content"},{align:"center",inlineEdit:!1,sortable:!1,text:"保养目的",value:"standard.purposeChinese"},{align:"center",inlineEdit:!1,sortable:!1,text:"保养方法",value:"standard.method"},{align:"center",inlineEdit:!1,sortable:!1,text:"保养标准",value:"standard.standard"},{align:"center",inlineEdit:!1,sortable:!1,text:"保养设备状态",value:"eqpStatus"},{align:"center",inlineEdit:!0,sortable:!1,text:"是否异常",value:"hasException",fieldType:"boolField",boolSelectField:[{dname:"是",dvalue:1},{dname:"否",dvalue:0}]},{align:"center",inlineEdit:!0,sortable:!1,text:"备注",value:"description",fieldType:"chatField"},{align:"center",inlineEdit:!0,sortable:!1,text:"附件",value:"documentID",fieldType:"fileField",textValue:"fileName"}],DataSource:[],totalDatas:0,maintainTaskList:[],IsShowTime:!1,maintainTime:{},modal:!1,fieldName:"standard.part",IsShowRecord:!1,recordDataSource:[],task:{},IsShowDetails:!1,taskDetail:{},searchValue:"",sparesList:[],IsComfirmCancel:!1,activesChild:0,isActive:!1}},components:{DistributeUser:V["a"],gridTemplate:O["a"],contentModal:n["a"],dataTable:x["a"],mergeTable:x["a"],MaintainRecordDetail:_,MaintainRecordEdit:B,comfirmModal:P["a"]},mounted:function(){this.maintainTask=new s["a"],this.initialize()},methods:{dayFormat:function(e){return e?new Date(e.replace(/-/g,"/")).getDate():""},afterInit:function(e){var t=this;e.forEach((function(e){e.status&&"未开始"==e.status.dname&&(e.statusName=t.$Utils.setStart(e.status.dname)),e.status&&"进行中"==e.status.dname&&(e.statusName=t.$Utils.setRed(e.status.dname)),e.status&&"按时完成"==e.status.dname&&(e.statusName=t.$Utils.setSuccess(e.status.dname)),e.status&&"超期完成"==e.status.dname&&(e.statusName=t.$Utils.setWarn(e.status.dname))})),this.maintainTaskList=e},initialize:function(){var e=this;this.$Server.queryAll(z.getModelName()).then((function(t){e.dataDictSource=t.datas}))},editorsReCode:function(e){e=e.filter((function(e){return e.field&&"maintenancePlanId"!=e.field&&"maintenanceType"!=e.field&&"assignedUser"!=e.field})),this.$refs.childGridTemplate.editors=e},beforeEdit:function(e,t){this.Isupdate=!0;var a=t.maintenancePlanId;this.maintainplan=this.dataDictSource.find((function(e){return e.id==a})),this.maintainplanType=this.maintainplan.maintenanceType,this.equipment=this.maintainplan.equipmentViewModel,this.users=this.maintainplan.users,this.user=t.assignedUser},beforeAdd:function(e){this.Isupdate=!1,this.maintainplan=[],this.maintainplanType="",this.user=[],this.equipment=[]},beforeEditSubmit:function(){this.$refs.childGridTemplate.editedItem.maintenancePlanId=this.maintainplan.id,this.$refs.childGridTemplate.editedItem.assignedUser=this.user},chooseAssignedUser:function(e,t){if(this.isFirstChoose){var a=this;this.$Server.queryAll(z.getModelName(),{page:e,rowsPerPage:t},{chooseUser:"sssssss"}).then((function(e){a.total=e.page.total,a.DataSource=e.datas,0==a.DataSource.length?g["a"].alert("负责人分配已完成"):a.IsShow=!0}))}else this.isFirstChoose=!0},selectChangeForSave:function(e){var t=sessionStorage.getItem("userId");e.editAssignedUser=t,this.$Server.batchUpdate(z.getModelName(),[e]).then((function(e){e.success||g["a"].alert("分配负责人失败")}),(function(e){return g["a"].alert(e)}))},comboboxChange:function(e){this.users=[],this.equipment=e.equipmentViewModel,this.users=e.users,this.maintainplanType=e.maintenanceType},excuteMaintain:function(){var e=this;this.$refs.MaintainRecordEdit.clearFile();var t=sessionStorage.getItem("userId");if(1==this.$refs.childGridTemplate.getCheckItems().length){var a=this.$refs.childGridTemplate.getCheckItems();if(a[0].assignedUser!=t)g["a"].alert("这条工单的负责人不是你");else if("未开始"==a[0].status.dname||"已取消"==a[0].status.dname){var i={maintainTaskId:a[0].id};this.findByID(a[0].id),this.$Server.addOrUpdate((new k).__name,i,!1).then((function(t){e.task=a[0],t.success&&(e.IsShowRecord=!0,e.$refs.childGridTemplate.init(),e.findByID(a[0].id))}))}else"进行中"==a[0].status.dname?(this.IsShowRecord=!0,this.task=a[0],this.findByID(a[0].id)):g["a"].alert("工单已经完成")}else g["a"].alert("请选择一个任务执行")},modalClosed:function(){this.IsShow=!1,this.$refs.childGridTemplate.init()},findByID:function(e){var t=this;this.$Server.queryAll(z.getModelName(),{},{id:e}).then((function(e){e.datas.length>0&&(t.task=e.datas[0],t.recordDataSource=t.task.recordList,t.recordDataSource.forEach((function(e){void 0!=e.hasException&&null!=e.hasException&&(e.hasException=0==e.hasException?0:1)})))}))},modalComfirmed:function(){var e=this,t=[],a=sessionStorage.getItem("userId");t.push({editAssignedUser:a,code:"一键分配保养人员"}),this.$Server.batchUpdate(z.getModelName(),t).then((function(t){if(t.success){var a=e.$refs.childDataTable.getPagination();e.chooseAssignedUser(a.page,a.rowsPerPage),g["a"].alert("分配负责人成功","success")}}),(function(e){g["a"].alert("分配负责人失败")}))},adjustTime:function(){this.$refs.form.resetValidation();sessionStorage.getItem("userId");if(1==this.$refs.childGridTemplate.getCheckItems().length){var e=this.$refs.childGridTemplate.getCheckItems()[0];if("超期完成"==e.status.dname||"按时完成"==e.status.dname)g["a"].alert("已经完成的任务不能调整时间");else if("进行中"==e.status.dname)g["a"].alert("任务正在进行");else{this.IsShowTime=!0;var t=this.$refs.childGridTemplate.getCheckItems()[0],a=t.actualEndDate,i=t.actualStartDate,r=t.assignedUser,n=t.code,s=t.createdTime,l=t.creator,d=t.ecode,c=t.editAssignedUser,o=t.ename,u=t.endDate,m=t.endTime,b=t.eposition,f=t.equipmentID,h=t.id,v=t.maintenancePlanId,p=t.model,O=t.modifiedTime,j=t.modifier,x=t.originalEndDate,S=t.planName,k=t.recordList,D=t.startTime,F=t.status,T=t.userList,w=t.userName,N=t.workShopName;this.maintainTime={actualEndDate:a,actualStartDate:i,assignedUser:r,code:n,createdTime:s,creator:l,ecode:d,editAssignedUser:c,ename:o,endDate:u,endTime:m,eposition:b,equipmentID:f,id:h,maintenancePlanId:v,model:p,modifiedTime:O,modifier:j,originalEndDate:x,planName:S,recordList:k,startTime:D,status:F,userList:T,userName:w,workShopName:N},this.maintainTime.originalEndDate&&(this.maintainTime.originalEndDate=this.maintainTime.originalEndDate.substring(0,10)),this.maintainTime.startTime=""}}else g["a"].alert("选择需要修改保养时间的保养任务")},modalClosedTime:function(){this.IsShowTime=!1},modalComfirmedTime:function(){var e=this;if(this.$refs.form.validate()){var t=this.dateDiff(this.maintainTime.originalEndDate,this.maintainTime.startTime),a=new Date(this.maintainTime.endTime);a.setDate(a.getDate()+t);var i=a.toISOString().substring(0,10);this.maintainTime.endTime=i,this.$Server.batchDelete(z.getModelName(),[this.maintainTime]).then((function(t){t.success&&(e.IsShowTime=!1,g["a"].alert("保养日期调整成功","success"),e.$refs.childGridTemplate.init())}))}},modalClosedRecord:function(){g["a"].alert("保养期间不能关闭")},recordComfirmed:function(e){var t=this;this.task.recordList=e,this.$Server.addOrUpdate(z.getModelName(),this.task,!0).then((function(e){e.success&&(t.$refs.MaintainRecordEdit.clearFile(),t.IsShowRecord=!1,t.$refs.childGridTemplate.init(),g["a"].alert("任务执行成功","success"))}))},saveAndClose:function(e){var t=this;this.$Server.batchUpdate((new k).__name,e).then((function(e){e.success&&(g["a"].alert("保存成功","success"),t.$refs.MaintainRecordEdit.clearFile(),t.IsShowRecord=!1)}))},recordClosed:function(){this.IsShowRecord=!1},rowDbClick:function(e){var t=this;this.IsShowDetails=!0;var a=[];this.$Server.queryAll((new k).__name,{},{taskid:e.id}).then((function(e){e.datas&&e.datas.forEach((function(e){e.sparesList&&e.sparesList.length>0&&(a=a.concat(e.sparesList))})),t.sparesList=a})),this.taskDetail=e},detailClosed:function(){this.IsShowDetails=!1},cancelTask:function(){var e=this.$refs.childGridTemplate.getCheckItems();if(e.length>0){var t=e[0],a=sessionStorage.getItem("userId");t.assignedUser!=a?g["a"].alert("你不是工单的执行人，不能取消执行工单"):"进行中"!=t.status.dname?g["a"].alert("工单不在进行中，不能取消执行工单"):this.IsComfirmCancel=!0}},modalComfirmedClose:function(){this.IsComfirmCancel=!1},confirmCancel:function(){var e=this,t=this.$refs.childGridTemplate.getCheckItems();this.$Server.batchSave(z.getModelName(),t).then((function(a){if(a.success){e.$refs.childGridTemplate.init(),g["a"].alert("保养任务取消成功","success");var i=e.$refs.childGridTemplate.DataSource.filter((function(e){return e.id==t[0].id}));e.$refs.childGridTemplate.getCheckItems()[0].status=i[0].status,e.IsComfirmCancel=!1}else g["a"].alert("保养任务取消失败","error")}),(function(e){return g["a"].alert("保养任务取消失败","error")}))},doSearch:function(){var e=this;this.$refs.childGridTemplate.doSearch({searchfx:e.searchValue})},clearMessage:function(){this.$refs.childGridTemplate.doSearch({})},dateDiff:function(e,t){var a=new Date(e),i=new Date(t);return Math.ceil((i-a)/1e3/60/60/24)},tabClick:function(e){if(this.$refs.childGridTemplate)if(1==e){this.isActive=!0,this.searchValue="",this.headerBtns=this.headerBtns1,this.activesChild=0;var t=sessionStorage.getItem("userId");this.$refs.childGridTemplate.doSearch({userId:t,status:"未完成"}),this.maintainTask=new p}else this.isActive=!1,this.headerBtns=this.headerBtns2,this.$refs.childGridTemplate.doSearch({}),this.maintainTask=new s["a"]},subTabClick:function(e){var t=sessionStorage.getItem("userId");this.$refs.childGridTemplate&&(1==e?(this.$refs.childGridTemplate.doSearch({userId:t,status:"已完成"}),this.maintainTask=new s["a"]):(this.$refs.childGridTemplate.doSearch({userId:t,status:"未完成"}),this.maintainTask=new p))}}},J=H,W=Object($["a"])(J,i,r,!1,null,null,null);t["default"]=W.exports}}]);