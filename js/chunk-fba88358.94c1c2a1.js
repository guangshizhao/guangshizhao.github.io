(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fba88358"],{"3f3c":function(e,t,i){},"5a53":function(e,t,i){},"61a3":function(e,t,i){"use strict";var a=i("6644"),r=i.n(a);r.a},"65d0":function(e,t){e.exports="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QONaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YmEyZDAzNzEtZDYyMS04YjRhLWE2MmQtMmQ4MjlmMzRlN2FjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk1QzdBMDIwNDE2NTExRTk4Q0U4QkM1NjY5MThFMjhFIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk1QzdBMDFGNDE2NTExRTk4Q0U4QkM1NjY5MThFMjhFIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjliZTMyNjFiLTdlZTgtZWM0Yi1iMWE5LWZmOTcyN2JjMzEwYyIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmUzMWNkNTZmLTMwMDYtMTFlOS05NzNhLTgwNWYyYTM1ZDM3YiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAYEBAQFBAYFBQYJBgUGCQsIBgYICwwKCgsKCgwQDAwMDAwMEAwODxAPDgwTExQUExMcGxsbHB8fHx8fHx8fHx8BBwcHDQwNGBAQGBoVERUaHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fH//AABEIAGQAZAMBEQACEQEDEQH/xABzAAEBAAEFAAAAAAAAAAAAAAAABgUBAgQHCAEBAAAAAAAAAAAAAAAAAAAAABAAAQMCBAMDCAsAAAAAAAAAAAECAwQFESESBjETB7N0NkFRYXGj01UXgdEiMlLSI5MUFRYRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/APQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADiXO62+10jqyvmbBTtVEV7sVzXgiIiKqr6gMH8y9k/EvYz+7AfMvZPxL2M/uwOTbt9bUuNXHR0le19RKuEbHRyx6l8yK9rUxAzwAAAAAAAAABC9YvDNN31nZSgSF2TYf+JplolT+80x6sNXM5mXO5mOWnjh9GAEYBlNreJrR32n7VoHogAAAAAAAAAAhesXhmm76zspQIuw9Orndtvz3RruXKudBA7LnI37yqq8MeDfqApNn9M6eSyzzXqJWVdazTAxUwfA3ij8F4PVUx9WXlUCOoLRWWjfFut9W3CWGup0RycHNWVulzfQqAd9gAAAAAAAAAEv1E2/cL5YWU1AjX1EM7Z0jcqN1IjXMVEVcEx+3jmBHxW7rFFGyKPmMjYiNYxstKiI1EwRETUBv/hdZvxS/vUv5gNbdtTf9fuO2118b+nRTRyrPJJC5UbG9H6U5Sq5cVTIDtQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/9k="},6644:function(e,t,i){},"731b":function(e,t,i){},"7c37":function(e,t,i){"use strict";var a=i("a802"),r=i.n(a);r.a},"7daf":function(e,t,i){},9041:function(e,t,i){"use strict";var a=i("731b"),r=i.n(a);r.a},"920d":function(e,t,i){"use strict";var a=i("5a53"),r=i.n(a);r.a},"92c2":function(e,t,i){"use strict";var a=i("7daf"),r=i.n(a);r.a},9692:function(e,t,i){"use strict";var a=i("3f3c"),r=i.n(a);r.a},a078:function(e,t,i){"use strict";var a=i("e0d8"),r=i.n(a);r.a},a6e0:function(e,t,i){},a802:function(e,t,i){},b885:function(e,t,i){"use strict";var a=i("a6e0"),r=i.n(a);r.a},ce8c:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"}},[i("v-tabs",{staticClass:"selftabs",staticStyle:{height:"100%"},attrs:{"slider-color":"primary"},model:{value:e.actives,callback:function(t){e.actives=t},expression:"actives"}},[i("v-tab",{key:1},[e._v("\n                    工厂组织架构管理\n                ")]),i("v-tab",{key:2},[e._v("\n                    TPM组织架构管理\n                ")]),i("v-tab",{key:3},[e._v("\n                    工厂产线工位架构\n                ")]),i("v-tab-item",{key:1,staticStyle:{height:"100%"}},[i("organization")],1),i("v-tab-item",{key:2,staticStyle:{height:"100%"}},[i("tpmOrganization")],1),i("v-tab-item",{key:3,staticStyle:{height:"100%"}},[i("Forganization")],1)],1)],1)},r=[],n=i("1e17"),o=i("07c5"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"},attrs:{id:"outContainer"}},[i("div",{attrs:{id:"innerContainer"}},[i("layContentHeader",{attrs:{title:"工厂组织管理",buttons:e.headerBtns,fontsize:"16px"}}),i("layContent",[i("v-layout",[i("layContentLeft",{attrs:{title:"架构目录",id:"layoutLeft"}},[i("div",{staticStyle:{height:"calc(100% - 63px)"}},[i("treeView",{ref:"childTreeView1",attrs:{Source:e.treeItems,radio:!0,id:"cus_treeView"},on:{afterSelectChange:e.selectChanged}})],1)]),i("layContentRight",[i("v-container",{staticStyle:{padding:"20px"}},[i("v-card",{staticStyle:{"margin-left":"50px"},attrs:{flat:""}},[i("v-form",{ref:"",attrs:{xs12:"",sm3:"",md3:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},e._l(e.editors,(function(t){return i("v-flex",{key:t.field,attrs:{xs12:"",sm3:"",md3:""}},["charField"==t.fieldType?i("div",["description"==t.field?i("v-textarea",{attrs:{disabled:"",label:t.fieldName},model:{value:e.editOrganiz[t.field],callback:function(i){e.$set(e.editOrganiz,t.field,i)},expression:"editOrganiz[editor.field]"}}):i("v-text-field",{attrs:{disabled:"",label:t.fieldName},model:{value:e.editOrganiz[t.field],callback:function(i){e.$set(e.editOrganiz,t.field,i)},expression:"editOrganiz[editor.field]"}})],1):e._e()])})),1)],1)],1)],1)],1)],1),i("contentModal",{attrs:{title:"添加组织架构",IsShow:e.IsShowAdd},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[i("v-container",{staticStyle:{padding:"24px"},attrs:{"grid-list-md":""}},[i("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-layout",{attrs:{wrap:""}},e._l(e.editors,(function(t){return i("v-flex",{key:t.field,attrs:{xs12:"",sm6:"",md6:""}},["charField"==t.fieldType?i("div",["oname"==t.field?i("v-text-field",{attrs:{label:t.fieldName,disabled:t.readonly,rules:[e.rules.required,function(e){return(e||"").length<=t.maxLength||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                    "+e._s(t.fieldName)+" "),i("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!0),model:{value:e.addOrganiz[t.field],callback:function(i){e.$set(e.addOrganiz,t.field,i)},expression:"addOrganiz[editor.field]"}}):"orgCode"==t.field?i("v-text-field",{attrs:{label:t.fieldName,disabled:t.readonly,rules:[function(e){return!e||/^[0-9a-zA-Z]+$/.test(e)||"只能填写英文字母和数字"}]},model:{value:e.addOrganiz[t.field],callback:function(i){e.$set(e.addOrganiz,t.field,i)},expression:"addOrganiz[editor.field]"}}):i("v-text-field",{attrs:{label:t.fieldName,disabled:t.readonly},model:{value:e.addOrganiz[t.field],callback:function(i){e.$set(e.addOrganiz,t.field,i)},expression:"addOrganiz[editor.field]"}})],1):e._e()])})),1)],1)],1)],1),i("contentModal",{attrs:{title:"编辑组织架构",IsShow:e.IsShowEdit},on:{modalClosed:function(t){return e.modalClosedEdit()},modalComfirmed:function(t){return e.addOrUpdate()}}},[i("v-container",{staticStyle:{padding:"24px"},attrs:{"grid-list-md":""}},[i("v-form",{ref:"form1",attrs:{valid:"true"}},[i("v-layout",{attrs:{wrap:""}},e._l(e.editors,(function(t){return i("v-flex",{key:t.field,attrs:{xs12:"",sm6:"",md6:""}},["charField"==t.fieldType?i("div",["orgCode"==t.field?i("v-text-field",{attrs:{label:t.fieldName},model:{value:e.modifyOrgnization[t.field],callback:function(i){e.$set(e.modifyOrgnization,t.field,i)},expression:"modifyOrgnization[editor.field]"}}):i("v-text-field",{attrs:{label:t.fieldName,disabled:t.readonly,rules:[function(e){return!t.require||!!e||"必填项"},function(e){return(e||"").length<=t.maxLength||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                    "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:e.modifyOrgnization[t.field],callback:function(i){e.$set(e.modifyOrgnization,t.field,i)},expression:"modifyOrgnization[editor.field]"}})],1):e._e()])})),1)],1)],1)],1),i("contentModal",{attrs:{title:"导入组织架构",IsShow:e.IsShowImport},on:{modalClosed:function(t){return e.modalClosedImport()},modalComfirmed:function(t){return e.ComfirmImport()}}},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:e.downloadTemp}},[e._v("下载导入模板")]),i("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("\n          (注:文档内标题标红的列为必填项，请勿输入以下非法字符：~、@、$、^、&、《、》、<、>、￥)\n        ")])],1),i("UploadFile",{ref:"uploadFile",attrs:{label:"导入文件"},on:{formData:e.getFormData},model:{value:e.base64,callback:function(t){e.base64=t},expression:"base64"}})],1),i("comfirmModal",{attrs:{title:"提示",IsShow:e.IsComfirmShow,text:e.deleteMessage},on:{modalComfirmedClose:function(t){return e.modalComfirmedClose()},modalComfirmed:function(t){return e.cofirmDelete()}}})],1)])},l=[],d=(i("7cfd"),i("bada"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"selfvuetree",staticStyle:{margin:"0px 0px 0px 20px"}},[i("v-tree",{ref:"childTreeView",attrs:{data:e.treeValues,radio:!0},on:{"node-select":e.selectChanged},model:{value:e.treeValues,callback:function(t){e.treeValues=t},expression:"treeValues"}})],1)}),c=[],u=i("3596"),f={data:function(){return{treeValues:[]}},watch:{Source:{handler:function(e,t){this.treeValues=this.toTree(e)},deep:!0}},methods:{selectChanged:function(e){var t=[];if(e){t.push(e.id);var i={};this.$emit("afterSelectChange",i,t)}},treeObj:function(e){var t={};for(var i in e){var a=e[i];null!=a&&(t[i]="object"===Object(u["a"])(a)?arguments.callee(a):a)}return t["children"]=[],t},setTree:function(e){for(var t=e,i=[],a=this,r=0;r<t.length;r++)""!==t[r].parentId&&null!==t[r].parentId&&"-1"!==t[r].parentId||(i.push(a.treeObj(t[r])),t.splice(r,1),r--);function n(e){if(0!==t.length)for(var i=0;i<e.length;i++){for(var r=0;r<t.length;r++)if(e[i].id===t[r].parentId){var o=a.treeObj(t[r]);e[i].children.push(o),t.splice(r,1),r--}n(e[i].children)}}return n(i),i},toTree:function(e){for(var t=[],i=0;i<e.length;i++){var a={};a.id=e[i].id,a.title=e[i].name,a.parentId=e[i].parentId,a.expanded=!0,a.createdTime=e[i].createdTime,a.description=e[i].description,a.modifiedTime=e[i].modifiedTime,a.oname=e[i].oname,a.name=e[i].name,a.orgCode=e[i].orgCode,a.parentName=e[i].parentName,a.rootNode=e[i].rootNode,t.push(a)}var r=this.setTree(t);return r},setActiveVaules:function(){this.$refs.childTreeView.nodeSelected({})}},props:["Source"]},m=f,p=i("6691"),h=Object(p["a"])(m,d,c,!1,null,null,null),g=h.exports,v=i("a2a7"),y=i("23f5"),x=i("55b3"),b=i("8907"),S=i("adf0"),A=i("20d3"),z=i("d9f7"),F=i("7300"),I=i("5873"),w=i("ddf2"),k=i("80ea"),O=i("ae0a"),C=i("97a3"),_=i("652a"),T=i("1269"),U=new _["a"],$=function(e){function t(){var e,i;Object(F["a"])(this,t);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return i=Object(I["a"])(this,(e=Object(w["a"])(t)).call.apply(e,[this].concat(r))),Object(C["a"])(Object(k["a"])(i),"__name","UserOrganization"),Object(C["a"])(Object(k["a"])(i),"userId",U.charField()),Object(C["a"])(Object(k["a"])(i),"orgId",U.charField()),Object(C["a"])(Object(k["a"])(i),"jobNumber",U.charField()),Object(C["a"])(Object(k["a"])(i),"userStatus",U.charField()),i}return Object(O["a"])(t,e),t}(T["a"]),N=i("8333"),L=i("d5b3"),E=new N["a"](new A["a"]),M=(new N["a"](new $),{data:function(){var e=this;return{editors:E.getEditFields(),addEditors:[],valid:!0,rules:{required:function(e){return!!e||"必填项"}},IsComfirmShow:!1,treeItems:[],actives:null,editOrganiz:{},addOrganiz:{},totalDatas:0,IsShowAdd:!1,headerBtns:[{disabled:!this.$per("Organization","c"),text:"添加",icon:"self_add",click:function(){return e.GridAdd()}},{disabled:!this.$per("Organization","u"),text:"编辑",icon:"self_edit",click:function(){return e.GridEdit()}},{disabled:!this.$per("Organization","d"),text:"删除",icon:"self_delete",click:function(){return e.deleteItems()}},{disabled:!this.$per("Organization","import"),text:"导入",icon:"self_import",click:function(){return e.importOrganiz()}},{disabled:!this.$per("Organization","e"),text:"导出",icon:"self_export",click:function(){return e.exportOrganization()}}],items:[],deleteMessage:"",IsShowImport:!1,fileName:"",file:"",base64:"",IsShowEdit:!1,modifyOrgnization:{},isAddOrUpdate:!0}},components:{treeView:g,contentModal:v["a"],comfirmModal:y["a"],layContent:n["a"],layContentHeader:o["a"],layContentLeft:b["a"],layContentRight:S["a"],UploadFile:x["a"]},mounted:function(){this.editOrganiz={},this.addEditors=this.editors.filter((function(e){return e.field&&"orgCode"!=e.field}));var e=this;this.init(),document.addEventListener("click",(function(t){var i=document.getElementById("cus_treeView"),a=document.getElementById("layoutLeft");i&&!i.contains(t.target)&&a&&a.contains(t.target)&&(e.$refs.childTreeView1.setActiveVaules(),e.$refs.form1.resetValidation(),e.editOrganiz={})})),document.addEventListener("click",(function(t){var i=document.getElementById("outContainer"),a=document.getElementById("innerContainer");i&&i.contains(t.target)&&a&&!a.contains(t.target)&&(e.$refs.childTreeView1.setActiveVaules(),e.$refs.form1.resetValidation(),e.editOrganiz={})}))},methods:{init:function(){var e=this;this.$Server.queryAll(E.getModelName()).then((function(t){e.treeItems=t.datas,e.totalDatas=t.page.total}),(function(e){return L["a"].alert(e)}))},selectChanged:function(e,t){var i,a=this;if(a.items=t,a.treeItems.length>0&&null!=t[0]){i=a.treeItems.find((function(e){return e.id==t}));var r=i,n=r.id,o=r.modifier,s=r.orgCode,l=r.oname,d=r.parentId,c=r.description,u=r.parentName,f=r.rootNode,m=r.level;a.editOrganiz={id:n,modifier:o,orgCode:s,oname:l,parentId:d,description:c,parentName:u,rootNode:f,level:m}}},GridEdit:function(){var e=this.editOrganiz,t=e.id,i=e.modifier,a=e.orgCode,r=e.oname,n=e.parentId,o=e.description,s=e.parentName,l=e.rootNode,d=e.level;this.modifyOrgnization={id:t,modifier:i,orgCode:a,oname:r,parentId:n,description:o,parentName:s,rootNode:l,level:d},null!=this.modifyOrgnization.id?this.IsShowEdit=!0:L["a"].alert("请选择一个节点")},modalClosed:function(){this.IsShow=!1,this.IsShowAdd=!1,this.$refs.form.resetValidation(),this.select=[]},modalClosedEdit:function(){this.IsShowEdit=!1},deleteItems:function(){var e=this;null!=this.editOrganiz.id?(e.deleteMessage="是否删除选中项？",e.IsComfirmShow=!0):L["a"].alert("请选择需要删除的节点")},GridAdd:function(){this.IsShowAdd=!0,this.$refs.form.resetValidation(),this.addOrganiz={},null!=this.editOrganiz.id?(this.addOrganiz.parentId=this.editOrganiz.id,this.addOrganiz.parentName=this.editOrganiz.oname,this.addOrganiz.rootNode=this.editOrganiz.rootNode,this.addOrganiz.level=this.editOrganiz.level+1):this.addOrganiz.level=1},addOrUpdate:function(){var e=this;this.$refs.form1.validate()?null!=e.modifyOrgnization.id?1==e.isAddOrUpdate&&(this.isAddOrUpdate=!1,this.$Server.addOrUpdate(E.getModelName(),e.modifyOrgnization,!0).then((function(t){e.isAddOrUpdate=!0,e.validName="",t.success&&(e.IsShowEdit=!1,L["a"].alert("修改成功","success"),e.init(),e.$refs.childTreeView1.setActiveVaules(),e.editOrganiz={})}),(function(t){e.isAddOrUpdate=!0,L["a"].alert(t)}))):L["a"].alert("请选中修改的数据"):L["a"].alert("格式不正确")},modalComfirmed:function(){var e=this;this.$refs.form.validate()?this.isAddOrUpdate&&(this.isAddOrUpdate=!1,this.$Server.addOrUpdate(E.getModelName(),e.addOrganiz,!1).then((function(t){e.isAddOrUpdate=!0,e.IsShowAdd=!1,t.success&&(e.$refs.form1.reset(),e.$refs.form.reset(),e.init(),e.$refs.childTreeView1.setActiveVaules(),e.editOrganiz={})}),(function(t){e.isAddOrUpdate=!0,L["a"].alert(t)}))):L["a"].alert("验证不通过")},modalComfirmedClose:function(){this.IsComfirmShow=!1},cofirmDelete:function(){var e=this;e.IsComfirmShow=!1,e.$Server.delete(E.getModelName(),e.editOrganiz).then((function(t){t.success&&(e.IsComfirmShow=!1,e.init(),e.editOrganiz={},e.$refs.form.reset(),e.$refs.form1.reset(),e.items=[],e.DataSource=[])}),(function(e){return L["a"].alert(e)}))},importOrganiz:function(){this.IsShowImport=!0},exportOrganization:function(){this.$Server.exportFile(E.getModelName(),"组织架构"+this.$Utils.getLocalFotmatTime())},ComfirmImport:function(){var e=this,t=this.$refs.uploadFile.filename,i={base64:this.base64,fileName:t,fileType:"xls"};null==this.base64||0==this.base64.length?L["a"].alert("请选择导入的文件"):this.$Server.importFile(E.getModelName(),i).then((function(t){t.success&&null==t.datas.error?(L["a"].alert("导入成功","success"),e.$refs.uploadFile.clearFile(),e.IsShowImport=!1,e.init()):L["a"].alert(t.datas.error)}),(function(e){return L["a"].alert(e)}))},getFormData:function(e){var t=this,i=e.get("data");if(i){var a=i.name.substring(i.name.lastIndexOf(".")+1,i.name.length);"xls"!=a&&"xlsx"!=a&&(L["a"].alert("请检查文件是否为Excel文件"),t.$refs.uploadFile.clearFile())}},modalClosedImport:function(){this.IsShowImport=!1,this.$refs.uploadFile.clearFile()},downloadTemp:function(){var e=document.createElement("a");e.href="/imporTemp/organization.xls",e.download="工厂组织架构.xls",e.click()}}}),j=M,q=(i("9692"),i("a078"),Object(p["a"])(j,s,l,!1,null,"2860935c",null)),V=q.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"},attrs:{id:"outDiv"}},[a("div",{attrs:{id:"innerDiv"}},[a("layContentHeader",{attrs:{title:"工厂产线工位架构",buttons:e.headerBtns,fontsize:"16px"}}),a("layContent",[a("v-layout",[a("layContentLeft",{attrs:{title:"工厂产线工位架构",id:"layoutLeft02"}},[a("div",{staticStyle:{height:"calc(100% - 63px)"}},[a("treeView",{ref:"childTreeView2",attrs:{Source:e.treeItems,id:"statreeView"},on:{afterSelectChange:e.selectChanged}})],1)]),a("layContentRight",[a("v-container",{staticStyle:{padding:"20px"},attrs:{id:"containerdiv","grid-list-md":""}},[a("v-form",{staticStyle:{"padding-left":"50px"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs3:"",id:"baseMessage"}},[a("v-text-field",{attrs:{label:"上级组织",disabled:""},model:{value:e.editForganiz.parentName,callback:function(t){e.$set(e.editForganiz,"parentName",t)},expression:"editForganiz.parentName"}}),a("v-select",{attrs:{items:e.nodeTypes,label:"节点类型","item-text":"dname","return-object":"",disabled:""},model:{value:e.editForganiz.orgType,callback:function(t){e.$set(e.editForganiz,"orgType",t)},expression:"editForganiz.orgType"}}),a("v-text-field",{attrs:{label:"编号",disabled:""},model:{value:e.editForganiz.fcode,callback:function(t){e.$set(e.editForganiz,"fcode",t)},expression:"editForganiz.fcode"}}),a("v-text-field",{attrs:{label:"名称",disabled:""},model:{value:e.editForganiz.fname,callback:function(t){e.$set(e.editForganiz,"fname",t)},expression:"editForganiz.fname"}}),a("v-textarea",{attrs:{label:"描述",disabled:""},model:{value:e.editForganiz.description,callback:function(t){e.$set(e.editForganiz,"description",t)},expression:"editForganiz.description"}})],1),a("v-flex",{attrs:{xs1:""}}),a("v-flex",{attrs:{id:"baseMessage1",xs3:""}},[e.IsWorkshop?a("v-flex",[a("v-layout",[a("v-flex",{attrs:{xs4:""}},[a("p",{staticStyle:{"margin-top":"25px"}},[e._v("车间大小：")])]),a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{label:"长",disabled:""},model:{value:e.editForganiz.shopLength,callback:function(t){e.$set(e.editForganiz,"shopLength",t)},expression:"editForganiz.shopLength"}})],1),a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{label:"宽",disabled:""},model:{value:e.editForganiz.shopWidth,callback:function(t){e.$set(e.editForganiz,"shopWidth",t)},expression:"editForganiz.shopWidth"}})],1)],1),a("v-layout",{staticStyle:{"margin-top":"-15px","font-size":"12px"}},[a("p",[e._v("(单位：m)")])]),a("v-img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:""!=e.editForganiz.workShopImage||e.editForganiz.workShopImage?e.editForganiz.workShopImage:i("65d0")}})],1):e._e(),e.IsStation?a("v-flex",[a("v-select",{attrs:{items:e.stationTypes,label:"工位类型","item-text":"dname","return-object":"",disabled:""},model:{value:e.editForganiz.stationType,callback:function(t){e.$set(e.editForganiz,"stationType",t)},expression:"editForganiz.stationType"}}),e.IsEquipment?a("v-flex",[a("v-select",{attrs:{label:"设备",items:e.equipments,"item-text":"codeName","return-object":"",multiple:"",disabled:""},model:{value:e.editForganiz.equipmentViewModels,callback:function(t){e.$set(e.editForganiz,"equipmentViewModels",t)},expression:"editForganiz.equipmentViewModels"}}),a("v-text-field",{attrs:{label:"X坐标",disabled:""},model:{value:e.editForganiz.xPoint,callback:function(t){e.$set(e.editForganiz,"xPoint",t)},expression:"editForganiz.xPoint"}}),a("v-text-field",{attrs:{label:"Y坐标",disabled:""},model:{value:e.editForganiz.yPoint,callback:function(t){e.$set(e.editForganiz,"yPoint",t)},expression:"editForganiz.yPoint"}})],1):e._e(),a("v-select",{attrs:{items:e.preStations,label:"前置工位","item-text":"fname","item-value":"id",disabled:""},model:{value:e.editForganiz.preStation,callback:function(t){e.$set(e.editForganiz,"preStation",t)},expression:"editForganiz.preStation"}})],1):e._e()],1)],1)],1)],1)],1)],1)],1),a("contentModal",{attrs:{title:"添加工厂产线工位架构",IsShow:e.IsShowAdd},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[a("v-container",{staticStyle:{padding:"24px"},attrs:{"grid-list-md":""}},[a("v-form",{ref:"form1",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.IsAddStation?a("v-layout",{staticStyle:{"padding-right":"30px"},attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",[e._v("上级组织："+e._s(e.addForganiz.parentName))])],1)],1),a("v-flex",{attrs:{xs12:""}},[a("v-layout",[a("v-flex",[a("v-select",{attrs:{items:e.addnodeTypes,label:"节点类型","item-text":"dname","return-object":"",rules:[function(e){return e&&!!e||""==e||"必填项"}]},on:{change:function(t){return e.judgeType()}},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                        节点类型 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,1898555546),model:{value:e.addForganiz.orgType,callback:function(t){e.$set(e.addForganiz,"orgType",t)},expression:"addForganiz.orgType"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"编号",rules:[function(e){return!e||/^[0-9a-zA-Z]+$/.test(e)||"只能填写英文字母和数字"}]},model:{value:e.addForganiz.fcode,callback:function(t){e.$set(e.addForganiz,"fcode",t)},expression:"addForganiz.fcode"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"名称",rules:[function(e){return!!e||"必填项"},function(e){return(e||"").length<=100||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                        名称 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,3599027052),model:{value:e.addForganiz.fname,callback:function(t){e.$set(e.addForganiz,"fname",t)},expression:"addForganiz.fname"}})],1)],1)],1),a("v-flex",[a("v-layout",[a("v-flex",[a("v-textarea",{attrs:{label:"描述"},model:{value:e.addForganiz.description,callback:function(t){e.$set(e.addForganiz,"description",t)},expression:"addForganiz.description"}})],1)],1)],1),a("v-flex",{attrs:{xs12:""}},[a("v-layout",[a("v-flex",{attrs:{xs3:""}},[a("v-select",{attrs:{items:e.addPreStations,label:"前置工位","item-text":"fname","item-value":"id"},model:{value:e.addForganiz.preStation,callback:function(t){e.$set(e.addForganiz,"preStation",t)},expression:"addForganiz.preStation"}})],1),a("v-flex",{attrs:{xs3:""}},[a("v-select",{attrs:{items:e.stationTypes,label:"工位类型","return-object":"","item-text":"dname",rules:[function(e){return e&&!!e||""==e||"必填项"}]},on:{change:function(t){return e.changeStation()}},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                            工位类型 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,1537202473),model:{value:e.addForganiz.stationType,callback:function(t){e.$set(e.addForganiz,"stationType",t)},expression:"addForganiz.stationType"}})],1),e.IsAddEquipment?a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{label:"x坐标",rules:[e.rules.required,function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于0的数字，最多两位小数"},function(t){return t<=e.editForganiz.workShopLength||"不能超过车间长度"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                            x坐标(0-"+e._s(e.editForganiz.workShopLength)+") "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,2353488548),model:{value:e.addForganiz.xPoint,callback:function(t){e.$set(e.addForganiz,"xPoint",t)},expression:"addForganiz.xPoint"}})],1):e._e(),e.IsAddEquipment?a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{label:"y坐标(0-100)",rules:[e.rules.required,function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于0的数字，最多两位小数"},function(t){return t<=e.editForganiz.workShopWidth||"不能超过车间长度"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                            y坐标(0-"+e._s(e.editForganiz.workShopWidth)+") "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,183964255),model:{value:e.addForganiz.yPoint,callback:function(t){e.$set(e.addForganiz,"yPoint",t)},expression:"addForganiz.yPoint"}})],1):e._e()],1)],1)],1):e.IsAddWorkShop?a("v-layout",[a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{label:"上级组织",disabled:!0},model:{value:e.addForganiz.parentName,callback:function(t){e.$set(e.addForganiz,"parentName",t)},expression:"addForganiz.parentName"}}),a("v-select",{attrs:{items:e.addnodeTypes,label:"节点类型","item-text":"dname","return-object":"",rules:[function(e){return e&&!!e||""==e||"必填项"}]},on:{change:function(t){return e.judgeType()}},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    节点类型 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.addForganiz.orgType,callback:function(t){e.$set(e.addForganiz,"orgType",t)},expression:"addForganiz.orgType"}}),a("v-text-field",{attrs:{label:"编号",rules:[function(e){return!e||/^[0-9a-zA-Z]+$/.test(e)||"只能填写英文字母和数字"}]},model:{value:e.addForganiz.fcode,callback:function(t){e.$set(e.addForganiz,"fcode",t)},expression:"addForganiz.fcode"}}),a("v-text-field",{attrs:{label:"名称",rules:[e.rules.required,function(e){return(e||"").length<=100||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    名称 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.addForganiz.fname,callback:function(t){e.$set(e.addForganiz,"fname",t)},expression:"addForganiz.fname"}}),a("v-textarea",{attrs:{label:"描述"},model:{value:e.addForganiz.description,callback:function(t){e.$set(e.addForganiz,"description",t)},expression:"addForganiz.description"}})],1),a("v-flex",{attrs:{xs1:""}}),a("v-flex",{attrs:{xs5:""}},[a("v-layout",[a("v-flex",{attrs:{xs4:""}},[a("p",{staticStyle:{"margin-top":"25px"}},[e._v("车间大小：")])]),a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{label:"长",rules:[e.rules.required,function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于或等于0的数字,最多两位小数"}],type:"number"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                            长 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.addForganiz.shopLength,callback:function(t){e.$set(e.addForganiz,"shopLength",t)},expression:"addForganiz.shopLength"}})],1),a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{label:"宽",rules:[e.rules.required,function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于或等于0的数字,最多两位小数"}],type:"number"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                            宽 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.addForganiz.shopWidth,callback:function(t){e.$set(e.addForganiz,"shopWidth",t)},expression:"addForganiz.shopWidth"}})],1)],1),a("v-layout",{staticStyle:{"margin-top":"-15px","font-size":"12px"}},[a("p",{staticStyle:{"margin-left":"5px"}},[e._v("(请填写实际大小，单位：m)")])]),a("uploadInput",{ref:"addFileData",attrs:{btnName:"上传车间图片"},model:{value:e.addForganiz.workShopImage,callback:function(t){e.$set(e.addForganiz,"workShopImage",t)},expression:"addForganiz.workShopImage"}})],1)],1):a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"上级组织",disabled:!0},model:{value:e.addForganiz.parentName,callback:function(t){e.$set(e.addForganiz,"parentName",t)},expression:"addForganiz.parentName"}}),a("v-select",{attrs:{items:e.addnodeTypes,label:"节点类型","item-text":"dname","return-object":"",rules:[function(e){return e&&!!e||""==e||"必填项"}]},on:{change:function(t){return e.judgeType()}},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    节点类型 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.addForganiz.orgType,callback:function(t){e.$set(e.addForganiz,"orgType",t)},expression:"addForganiz.orgType"}}),a("v-text-field",{attrs:{label:"编号",rules:[function(e){return!e||/^[0-9a-zA-Z]+$/.test(e)||"只能填写英文字母和数字"}]},model:{value:e.addForganiz.fcode,callback:function(t){e.$set(e.addForganiz,"fcode",t)},expression:"addForganiz.fcode"}}),a("v-text-field",{attrs:{label:"名称",rules:[e.rules.required,function(e){return(e||"").length<=100||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    名称 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.addForganiz.fname,callback:function(t){e.$set(e.addForganiz,"fname",t)},expression:"addForganiz.fname"}}),a("v-textarea",{attrs:{label:"描述"},model:{value:e.addForganiz.description,callback:function(t){e.$set(e.addForganiz,"description",t)},expression:"addForganiz.description"}})],1)],1)],1)],1)],1),a("contentModal",{attrs:{title:"编辑工厂产线工位架构",IsShow:e.IsShowEdit},on:{modalClosed:function(t){return e.modalClosedEdit()},modalComfirmed:function(t){return e.UpdateForganiz()}}},[a("v-container",{staticStyle:{"padding-left":"50px"},attrs:{"grid-list-md":""}},[a("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.IsStation?a("v-layout",{staticStyle:{"padding-right":"30px"},attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",[e._v("上级组织："+e._s(e.modifyForganiz.parentName))])],1)],1),a("v-flex",{attrs:{xs12:""}},[a("v-layout",[a("v-flex",[a("v-select",{attrs:{items:e.nodeTypes,label:"节点类型","item-text":"dname","return-object":"",disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                        节点类型 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,1898555546),model:{value:e.modifyForganiz.orgType,callback:function(t){e.$set(e.modifyForganiz,"orgType",t)},expression:"modifyForganiz.orgType"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"编号",rules:[function(e){return!e||/^[0-9a-zA-Z]+$/.test(e)||"只能填写英文字母和数字"}]},model:{value:e.modifyForganiz.fcode,callback:function(t){e.$set(e.modifyForganiz,"fcode",t)},expression:"modifyForganiz.fcode"}})],1),a("v-flex",[a("v-text-field",{attrs:{label:"名称",rules:[function(e){return!!e||"必填项"},function(e){return(e||"").length<=100||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                        名称 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,3599027052),model:{value:e.modifyForganiz.fname,callback:function(t){e.$set(e.modifyForganiz,"fname",t)},expression:"modifyForganiz.fname"}})],1)],1)],1),a("v-flex",[a("v-layout",[a("v-flex",[a("v-textarea",{attrs:{label:"描述"},model:{value:e.modifyForganiz.description,callback:function(t){e.$set(e.modifyForganiz,"description",t)},expression:"modifyForganiz.description"}})],1)],1)],1),a("v-flex",{attrs:{xs12:""}},[a("v-layout",[a("v-flex",{attrs:{xs3:""}},[a("v-select",{attrs:{items:e.preStations,label:"前置工位","item-text":"fname","item-value":"id"},model:{value:e.modifyForganiz.preStation,callback:function(t){e.$set(e.modifyForganiz,"preStation",t)},expression:"modifyForganiz.preStation"}})],1),a("v-flex",{attrs:{xs3:""}},[a("v-select",{attrs:{items:e.stationTypes,label:"工位类型","item-text":"dname","return-object":"",rules:[function(e){return e&&!!e||""==e||"必填"}]},on:{change:e.editStationType},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                            工位类型 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,1537202473),model:{value:e.modifyForganiz.stationType,callback:function(t){e.$set(e.modifyForganiz,"stationType",t)},expression:"modifyForganiz.stationType"}})],1),e.modifyStation?a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{label:"X坐标",rules:[e.rules.required,function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于0的数字，最多两位小数"},function(t){return t<=e.modifyForganiz.workShopLength||"不能超过车间长度"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                        X坐标(0-"+e._s(e.modifyForganiz.workShopLength)+") "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,3136767848),model:{value:e.modifyForganiz.xPoint,callback:function(t){e.$set(e.modifyForganiz,"xPoint",t)},expression:"modifyForganiz.xPoint"}})],1):e._e(),e.modifyStation?a("v-flex",{attrs:{xs3:""}},[a("v-text-field",{attrs:{label:"Y坐标",rules:[e.rules.required,function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于0的数字，最多两位小数"},function(t){return t<=e.modifyForganiz.workShopWidth||"不能超过车间宽度"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                        Y坐标(0-"+e._s(e.modifyForganiz.workShopWidth)+")"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,1850914451),model:{value:e.modifyForganiz.yPoint,callback:function(t){e.$set(e.modifyForganiz,"yPoint",t)},expression:"modifyForganiz.yPoint"}})],1):e._e()],1)],1)],1):e.IsWorkshop?a("v-layout",[a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{label:"上级组织",disabled:""},model:{value:e.editForganiz.parentName,callback:function(t){e.$set(e.editForganiz,"parentName",t)},expression:"editForganiz.parentName"}}),a("v-select",{attrs:{items:e.nodeTypes,label:"节点类型","item-text":"dname","return-object":"",disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    节点类型"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.modifyForganiz.orgType,callback:function(t){e.$set(e.modifyForganiz,"orgType",t)},expression:"modifyForganiz.orgType"}}),a("v-text-field",{attrs:{label:"编号",rules:[function(e){return!e||/^[0-9a-zA-Z]+$/.test(e)||"只能填写英文字母和数字"}]},model:{value:e.modifyForganiz.fcode,callback:function(t){e.$set(e.modifyForganiz,"fcode",t)},expression:"modifyForganiz.fcode"}}),a("v-text-field",{attrs:{label:"名称",rules:[e.rules.required,function(e){return(e||"").length<=100||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    名称"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.modifyForganiz.fname,callback:function(t){e.$set(e.modifyForganiz,"fname",t)},expression:"modifyForganiz.fname"}}),a("v-textarea",{attrs:{label:"描述"},model:{value:e.modifyForganiz.description,callback:function(t){e.$set(e.modifyForganiz,"description",t)},expression:"modifyForganiz.description"}})],1),a("v-flex",{attrs:{xs1:""}}),e.IsWorkshop?a("v-flex",[a("v-layout",[a("v-flex",{attrs:{xs3:""}},[a("p",{staticStyle:{"margin-top":"25px"}},[e._v("车间大小：")])]),a("v-flex",{attrs:{xs2:""}},[a("v-text-field",{attrs:{label:"长",rules:[e.rules.required,function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于或等于0的数字,最多两位小数"}],type:"number"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                            长"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,2123188942),model:{value:e.modifyForganiz.shopLength,callback:function(t){e.$set(e.modifyForganiz,"shopLength",t)},expression:"modifyForganiz.shopLength"}})],1),a("v-flex",{attrs:{xs2:""}},[a("v-text-field",{attrs:{label:"宽",rules:[e.rules.required,function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于或等于0的数字,最多两位小数"}],type:"number"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                            宽 "),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!1,2464059468),model:{value:e.modifyForganiz.shopWidth,callback:function(t){e.$set(e.modifyForganiz,"shopWidth",t)},expression:"modifyForganiz.shopWidth"}})],1)],1),a("v-layout",{staticStyle:{"margin-top":"-15px","font-size":"12px"}},[a("p",{staticStyle:{"margin-left":"5px"}},[e._v("(请填写实际大小，单位：m)")])]),a("uploadInput",{attrs:{btnName:"上传车间图片"},model:{value:e.modifyForganiz.workShopImage,callback:function(t){e.$set(e.modifyForganiz,"workShopImage",t)},expression:"modifyForganiz.workShopImage"}})],1):e._e()],1):a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs11:""}},[a("v-text-field",{attrs:{label:"上级组织",disabled:""},model:{value:e.editForganiz.parentName,callback:function(t){e.$set(e.editForganiz,"parentName",t)},expression:"editForganiz.parentName"}}),a("v-select",{attrs:{items:e.nodeTypes,label:"节点类型","item-text":"dname","return-object":"",disabled:""},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    节点类型"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.modifyForganiz.orgType,callback:function(t){e.$set(e.modifyForganiz,"orgType",t)},expression:"modifyForganiz.orgType"}}),a("v-text-field",{attrs:{label:"编号"},model:{value:e.modifyForganiz.fcode,callback:function(t){e.$set(e.modifyForganiz,"fcode",t)},expression:"modifyForganiz.fcode"}}),a("v-text-field",{attrs:{label:"名称",rules:[e.rules.required,function(e){return(e||"").length<=100||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                                    名称"),a("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.modifyForganiz.fname,callback:function(t){e.$set(e.modifyForganiz,"fname",t)},expression:"modifyForganiz.fname"}}),a("v-textarea",{attrs:{label:"描述"},model:{value:e.modifyForganiz.description,callback:function(t){e.$set(e.modifyForganiz,"description",t)},expression:"modifyForganiz.description"}})],1)],1)],1)],1)],1),a("contentModal",{attrs:{title:"导入工厂产线组织",IsShow:e.IsShowImport},on:{modalClosed:function(t){return e.modalClosedImport()},modalComfirmed:function(t){return e.ComfirmImport()}}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:e.downloadTemp}},[e._v("下载导入模板")]),a("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("\n                    (注:文档内标题标红的列为必填项，请勿输入以下非法字符：~、@、$、^、&、《、》、<、>、￥)\n                ")])],1),a("UploadFile",{ref:"uploadFile",attrs:{label:"导入文件"},on:{formData:e.getFormData},model:{value:e.base64,callback:function(t){e.base64=t},expression:"base64"}})],1),a("comfirmModal",{attrs:{title:"提示",IsShow:e.IsComfirmShow,text:"是否确定删除所选项？"},on:{modalComfirmedClose:function(t){return e.modalComfirmedClose()},modalComfirmed:function(t){return e.cofirmDelete()}}})],1)])},P=[],W=i("4027"),B=i("b27e"),Y=i("9ee5"),G=i("a7fe"),H=new N["a"](new W["a"]),R=(new N["a"](new z["a"]),new N["a"](new Y["a"])),Z={data:function(){var e=this;return{headers:[{text:"工号",align:"center",value:"jobNumber",sortable:!1},{text:"姓名",align:"center",value:"uname",sortable:!1}],file:"",valid:!0,select:[],items:[],treeItems:[],totalDatas:0,defaultOrganiz:[],editForganiz:{},addForganiz:{},preStations:[],headerBtns:[{disabled:!this.$per("Forganization","c"),text:"添加",icon:"self_add",click:function(){return e.GridAdd()}},{disabled:!this.$per("Forganization","u"),text:"编辑",icon:"self_edit",click:function(){return e.GridEdit()}},{disabled:!this.$per("Forganization","d"),text:"删除",icon:"self_delete",click:function(){return e.deleteItems()}},{disabled:!this.$per("Forganization","import"),text:"导入",icon:"self_import",click:function(){return e.importForganization()}},{disabled:!this.$per("Forganization","e"),text:"导出",icon:"self_export",click:function(){return e.exportForganization()}}],IsShowAdd:!1,cannotEdit:!1,nodeTypes:[],stationTypes:[],IsComfirmShow:!1,types:[],addPreStations:[],selectItems:[],IsShowImport:!1,fileName:"",IsShowAddUser:!1,search:"",IsUpdate:!0,equipments:[],IsWorkshop:!1,IsStation:!1,IsEquipment:!1,object:{},addnodeTypes:[],equipmentList:[],base64:"",IsShowEdit:!1,modifyForganiz:{},selectName1:"",IsAddStation:!1,IsAddWorkShop:!1,IsAddEquipment:!1,modifyStation:!1,rules:{required:function(e){return!!e||"必填须"},length:function(e){return/^(\d|[1-9]\d+)(\.\d{0,2})?$/.test(e)||"只能是大于0的数字，可以有两位小数"},maxLength:function(t){return t>=e.modifyForganiz.workShopLength||"只能是大于0的数字，可以有两位小数"}},storeTypeList:[],isAddOrUpdate:!0}},mounted:function(){this.editForganiz={},this.init();var e=this;this.editForganiz={id:null,createdTime:null,fcode:null,fname:null,parentId:null,description:null,orgType:null,xPoint:null,yPoint:null,stationType:null,workShopImage:null,preStation:null,oparentName:null,equipmentViewModels:null,users:null,workshop:null,shopLength:null,shopWidth:null,workShopLength:null,workShopWidth:null,stype:null},this.object={id:null,createdTime:null,fcode:null,fname:null,parentId:null,description:null,orgType:null,xPoint:null,yPoint:null,stationType:null,workShopImage:null,preStation:null,oparentName:null,equipmentViewModels:null,users:null,workshop:null,shopLength:null,shopWidth:null,workShopLength:null,workShopWidth:null,stype:null},document.addEventListener("click",(function(t){var i=document.getElementById("statreeView"),a=document.getElementById("layoutLeft02");i&&!i.contains(t.target)&&a&&a.contains(t.target)&&(e.$refs.childTreeView2.setActiveVaules(),e.editForganiz={},e.nodeTypes=e.types,e.IsWorkshop=!1,e.IsStation=!1,e.IsEquipment=!1)})),document.addEventListener("click",(function(t){var i=document.getElementById("outDiv"),a=document.getElementById("innerDiv");i&&i.contains(t.target)&&a&&!a.contains(t.target)&&(e.$refs.childTreeView2.setActiveVaules(),e.editForganiz={},e.nodeTypes=e.types,e.IsWorkshop=!1,e.IsStation=!1,e.IsEquipment=!1)}))},components:{treeView:g,contentModal:v["a"],comfirmModal:y["a"],uploadInput:B["a"],layContent:n["a"],layContentHeader:o["a"],layContentLeft:b["a"],layContentRight:S["a"],UploadFile:x["a"]},methods:{init:function(){var e=this;this.$Server.queryAll((new G["a"]).__name,{},{dname:"工厂产线工位架构类型"}).then((function(t){e.types=t.datas})),this.$Server.queryAll((new G["a"]).__name,{},{dname:"工位类型"}).then((function(t){e.stationTypes=t.datas})),this.$Server.queryAll((new G["a"]).__name,{},{dname:"库位类型"}).then((function(t){e.storeTypeList=t.datas})),this.$Server.queryAll(H.getModelName()).then((function(t){e.treeItems=t.datas,e.totalDatas=t.page.total}),(function(e){return L["a"].alert(e)}))},GridAdd:function(){var e=this;this.IsUpdate=!1,this.IsAddWorkShop=!1,this.IsAddStation=!1,this.IsAddEquipment=!1,this.addForganiz=this.object,this.$refs.form1.resetValidation(),null!=this.editForganiz.id?(this.addForganiz.level=this.editForganiz.level+1,"工位"==this.editForganiz.orgType.dname||"设备库位"==this.editForganiz.orgType.dname?L["a"].alert("不能在末位节点下面添加节点"):"工厂"==this.editForganiz.orgType.dname?(this.IsShowAdd=!0,this.addnodeTypes=this.types.filter((function(e){return"车间"==e.dname||"设备仓库"==e.dname})),this.addForganiz.parentId=this.editForganiz.id,this.addForganiz.parentName=this.editForganiz.fname,this.addForganiz.workShopImage=""):(this.IsShowAdd=!0,this.addForganiz=this.object,this.addForganiz.parentId=this.editForganiz.id,this.addForganiz.parentName=this.editForganiz.fname,this.queryEquipment({forgEquipment:"equipment"}),"车间"==this.editForganiz.orgType.dname?(this.addnodeTypes=this.types.filter((function(e){return"车间"!=e.dname&&"工厂"!=e.dname&&"工位"!=e.dname&&"设备仓库"!=e.dname&&"设备库位"!=e.dname})),this.addForganiz.workshop=this.editForganiz.id):"设备仓库"==this.editForganiz.orgType.dname?(this.addnodeTypes=this.types.filter((function(e){return"设备库位"==e.dname})),this.addForganiz.orgType=this.addnodeTypes[0],this.addForganiz.workshop=this.editForganiz.workshop):"产线"==this.editForganiz.orgType.dname?(this.addnodeTypes=this.types.filter((function(e){return"工位"==e.dname})),this.addForganiz.workshop=this.editForganiz.workshop,this.addForganiz.workShopLength=this.editForganiz.workShopLength,this.addForganiz.workShopWidth=this.editForganiz.workShopWidth,this.addForganiz.orgType=this.addnodeTypes[0],this.judgeType()):(this.addnodeTypes=this.types.filter((function(t){return t.dvalue>e.editForganiz.orgType.dvalue&&"工位"!=t.dname&&"设备库位"!=t.dname})),this.addForganiz.workshop=this.editForganiz.workshop))):(this.IsShowAdd=!0,this.addForganiz=this.object,this.addnodeTypes=this.types.filter((function(e){return"工厂"==e.dname})),this.editForganiz.orgType="",this.addForganiz.orgType=this.addnodeTypes[0],this.addForganiz.level=1)},modalComfirmed:function(){var e=this;e.IsUpdate=!0,this.$refs.form1.validate()&&1==e.isAddOrUpdate&&(this.isAddOrUpdate=!1,this.$Server.addOrUpdate(H.getModelName(),e.addForganiz,!1).then((function(t){e.isAddOrUpdate=!0,t.success&&(e.$refs.form1.reset(),e.IsShowAdd=!1,e.addForganiz=e.object,e.init(),e.IsAddWorkShop=!1,e.IsAddStation=!1,e.IsAddEquipment=!1,e.$refs.childTreeView2.setActiveVaules(),e.editForganiz={})}),(function(t){e.isAddOrUpdate=!0,L["a"].alert(t)})))},deleteItems:function(){null!=this.editForganiz.id?this.IsComfirmShow=!0:L["a"].alert("请先选择需要删除的节点")},modalComfirmedClose:function(){this.IsComfirmShow=!1},cofirmDelete:function(){var e=this;this.editForganiz.id;this.$Server.delete(H.getModelName(),this.editForganiz).then((function(t){t.success&&(e.IsComfirmShow=!1,e.init(),e.editForganiz={},e.$refs.form.reset(),e.selectItems=[],e.$refs.childTreeView2.activeValue=[],e.nodeTypes=e.types)}),(function(t){e.IsComfirmShow=!1,L["a"].alert(t)}))},selectChanged:function(e,t){var i,a=this,r=this;if(r.treeItems.length>0&&null!=t[0]){i=r.treeItems.find((function(e){return e.id==t}));var n=i,o=n.id,s=n.createdTime,l=n.fcode,d=n.fname,c=n.parentId,u=n.description,f=n.orgType,m=n.xPoint,p=n.yPoint,h=n.stationType,g=n.workShopImage,v=n.preStation,y=n.parentName,x=n.equipmentViewModels,b=n.users,S=n.workshop,A=n.shopLength,z=n.shopWidth,F=n.workShopLength,I=n.workShopWidth,w=n.level,k=n.stype;this.editForganiz={id:o,createdTime:s,fcode:l,fname:d,parentId:c,description:u,orgType:f,xPoint:m,yPoint:p,stationType:h,preStation:v,workShopImage:g,parentName:y,equipmentViewModels:x,users:b,workshop:S,shopLength:A,shopWidth:z,workShopLength:F,workShopWidth:I,level:w,stype:k},this.selectItems=[],this.nodeTypes=this.types,this.selectItems.push(this.editForganiz),"车间"==this.editForganiz.orgType.dname?(this.IsWorkshop=!0,this.IsStation=!1,this.IsEquipment=!1):"设备仓库"==this.editForganiz.orgType.dname?this.editForganiz.stype&&(this.editForganiz.stype=this.storeTypeList.find((function(e){return e.dvalue==a.editForganiz.stype.dvalue})),this.IsWorkshop=!1,this.IsStation=!1,this.IsEquipment=!1):"工位"==this.editForganiz.orgType.dname?(this.IsStation=!0,this.IsWorkshop=!1,this.IsEquipment=!1,this.modifyStation=!1,"设备工位"==this.editForganiz.stationType.dname&&(this.IsEquipment=!0,this.modifyStation=!0,r.queryEquipment({forgID:this.editForganiz.id,deleted:!1})),r.queryPreStations({parentId:r.editForganiz.parentId,id:r.editForganiz.id})):(this.IsStation=!1,this.IsWorkshop=!1,this.IsEquipment=!1)}},GridEdit:function(){var e=this.editForganiz,t=e.id,i=e.createdTime,a=e.fcode,r=e.fname,n=e.parentId,o=e.description,s=e.orgType,l=e.xPoint,d=e.yPoint,c=e.stationType,u=e.workShopImage,f=e.preStation,m=e.parentName,p=e.equipmentViewModels,h=e.users,g=e.workshop,v=e.shopLength,y=e.shopWidth,x=e.workShopLength,b=e.workShopWidth,S=e.level,A=e.stype;this.modifyForganiz={id:t,createdTime:i,fcode:a,fname:r,parentId:n,description:o,orgType:s,xPoint:l,yPoint:d,stationType:c,workShopImage:u,preStation:f,parentName:m,equipmentViewModels:p,users:h,workshop:g,shopLength:v,shopWidth:y,workShopLength:x,workShopWidth:b,level:S,stype:A},null!=this.modifyForganiz.id?(this.$refs.form.resetValidation(),this.IsShowEdit=!0,this.modifyStation=this.IsEquipment,this.modifyForganiz.stationType=this.editForganiz.stationType,this.modifyForganiz.equipmentViewModels=this.editForganiz.equipmentViewModels):L["a"].alert("请选择一个节点")},modalClosedEdit:function(){this.IsShowEdit=!1,this.IsAddStation=!1,this.IsAddWorkShop=!1},queryPreStations:function(e){var t=this;this.$Server.queryAll(H.getModelName(),{},e).then((function(e){t.preStations=e.datas}),(function(e){return L["a"].alert(e)}))},queryEquipment:function(e){var t=this;this.$Server.queryAll(R.getModelName(),{},e).then((function(e){if(t.equipments=e.datas,t.selectItems.length>0){var i=[];t.editForganiz.equipmentViewModels.map((function(e){var a=t.equipments.find((function(t){return t.id==e.id}));i.push(a)})),t.editForganiz.equipmentViewModels=i,t.modifyForganiz.equipmentViewModels=i}}))},UpdateForganiz:function(){var e=this;e.selectItems=[],e.selectItems.push(e.modifyForganiz),this.$refs.form.validate()&&(null!=e.modifyForganiz.id?1==e.isAddOrUpdate&&(this.isAddOrUpdate=!1,this.$Server.addOrUpdate(H.getModelName(),e.modifyForganiz,!0).then((function(t){e.isAddOrUpdate=!0,t.success&&(L["a"].alert("修改成功","success"),e.IsShowEdit=!1,e.init(),e.IsEquipment=e.modifyStation,e.modifyStation=!1,e.$refs.childTreeView2.setActiveVaules(),e.editForganiz={})}),(function(t){e.isAddOrUpdate=!0,L["a"].alert(t)}))):L["a"].alert("请选择修改的数据"))},modalClosed:function(){this.IsShowAdd=!1,this.IsShowImport=!1,this.fileName="",this.IsUpdate=!0,this.$refs.form1.reset()},judgeType:function(){var e=this;if("车间"==this.addForganiz.orgType.dname)this.IsAddWorkShop=!0,this.IsAddStation=!1,this.IsAddEquipment=!1;else if("工位"==this.addForganiz.orgType.dname)this.IsAddStation=!0,this.IsAddWorkShop=!1,this.IsAddEquipment=!1;else if(this.IsAddStation=!1,this.IsAddWorkShop=!1,this.IsAddEquipment=!1,"设备仓库"==this.addForganiz.orgType.dname){var t=this.storeTypeList.find((function(e){return"正常"==e.dname}));this.addForganiz.stype=t}null!=this.editForganiz.id?this.$Server.queryAll(H.getModelName(),{},{parentId:e.addForganiz.parentId}).then((function(t){e.addPreStations=t.datas}),(function(e){return L["a"].alert(e)})):this.$Server.queryAll(H.getModelName(),{},{parentId:"-1"}).then((function(t){e.addPreStations=t.datas}),(function(e){return L["a"].alert(e)}))},changeStation:function(){"设备工位"==this.addForganiz.stationType.dname?(this.IsAddWorkShop=!1,this.IsAddEquipment=!0):(this.IsAddWorkShop=!1,this.IsAddEquipment=!1,this.addForganiz.xPoint="",this.addForganiz.yPoint="",this.addForganiz.equipmentViewModels=[])},exportForganization:function(){this.$Server.exportFile(H.getModelName(),"工厂产线组织架构"+this.$Utils.getLocalFotmatTime())},importForganization:function(){this.IsShowImport=!0},changeFile:function(e){this.file=e.target.files[0],this.fileName=this.file.name},ComfirmImport:function(){var e=this,t=this.$refs.uploadFile.filename,i={base64:this.base64,fileName:t,fileType:"xls"};null==this.base64||0==this.base64.length?L["a"].alert("请选择导入的文件"):this.$Server.importFile(H.getModelName(),i).then((function(t){t.success&&null==t.datas.error?(L["a"].alert("导入成功","success"),e.$refs.uploadFile.clearFile(),e.IsShowImport=!1,e.init()):L["a"].alert(t.datas.error)}),(function(e){return L["a"].alert(e)}))},getFormData:function(){},uploadFile:function(){var e=this.$refs.importFile;e.click()},editStationType:function(){"设备工位"==this.modifyForganiz.stationType.dname?this.modifyStation=!0:(this.modifyStation=!1,this.modifyForganiz.equipmentViewModels=[])},downloadTemp:function(){var e=document.createElement("a");e.href="/imporTemp/Forganization.xls",e.download="工厂产线架构.xls",e.click()},modalClosedImport:function(){this.IsShowImport=!1,this.$refs.uploadFile.clearFile()}}},Q=Z,X=(i("61a3"),i("920d"),Object(p["a"])(Q,D,P,!1,null,"4e6333a7",null)),J=X.exports,K=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"},attrs:{id:"outContainer1"}},[i("div",{attrs:{id:"innerContainer1"}},[i("layContentHeader",{attrs:{title:"TPM组织管理",buttons:e.headerBtns,fontsize:"16px"}}),i("layContent",[i("v-layout",[i("layContentLeft",{attrs:{title:"架构目录",id:"layoutLeft01"}},[i("div",{staticStyle:{height:"calc(100% - 63px)"}},[i("treeView",{ref:"childTreeView",attrs:{Source:e.treeItems,radio:!0,id:"tpmtreeView"},on:{afterSelectChange:e.selectChanged}})],1)]),i("layContentRight",[i("v-container",{staticStyle:{padding:"20px"}},[i("v-tabs",{attrs:{"slider-color":"primary"},model:{value:e.actives,callback:function(t){e.actives=t},expression:"actives"}},[i("v-tab",{key:1},[e._v("\n                基础信息\n              ")]),i("v-tab",{key:2},[e._v("\n                人员信息\n              ")]),i("v-tab-item",{key:1},[i("div",{staticStyle:{"padding-left":"10px"}},[i("v-card",{staticStyle:{"padding-left":"50px"},attrs:{flat:""}},[i("v-form",{ref:"",attrs:{xs12:"",sm3:"",md3:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},e._l(e.editors,(function(t){return i("v-flex",{key:t.field,attrs:{xs12:"",sm3:"",md3:""}},["charField"==t.fieldType?i("div",["description"==t.field?i("v-textarea",{attrs:{disabled:"",label:t.fieldName},model:{value:e.editOrganiz[t.field],callback:function(i){e.$set(e.editOrganiz,t.field,i)},expression:"editOrganiz[editor.field]"}}):i("v-text-field",{attrs:{disabled:"",label:t.fieldName},model:{value:e.editOrganiz[t.field],callback:function(i){e.$set(e.editOrganiz,t.field,i)},expression:"editOrganiz[editor.field]"}})],1):e._e()])})),1)],1)],1)]),i("v-tab-item",{key:2},[i("v-container",{staticStyle:{padding:"20px"}},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"btnClass",attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(t){return e.addUser()}}},a),[i("v-icon",[e._v("\n                          add\n                        ")])],1)]}}])},[i("span",[e._v("新增人员")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"btnClass",attrs:{fab:"",light:"",small:"",color:"primary"},on:{click:function(t){return e.updateUserItem()}}},a),[i("v-icon",[e._v("\n                          edit\n                        ")])],1)]}}])},[i("span",[e._v("编辑人员")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"btnClass",attrs:{fab:"",light:"",small:"",color:"primary"},on:{click:function(t){return e.deleteUserItem()}}},a),[i("v-icon",[e._v("\n                          remove\n                        ")])],1)]}}])},[i("span",[e._v("删除人员")])]),i("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,DataSource:e.DataSource,totalDatas:e.totalDatas,hideOperation:!0,formatFields:e.formatFields,total:e.total},on:{initialize:e.findUsersByOrgId}})],1)],1)],1)],1)],1)],1)],1),i("contentModal",{attrs:{title:"添加TPM组织架构",IsShow:e.IsShowAdd},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[i("v-container",{staticStyle:{padding:"24px"},attrs:{"grid-list-md":""}},[i("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-layout",{attrs:{wrap:""}},e._l(e.editors,(function(t){return i("v-flex",{key:t.field,attrs:{xs12:"",sm6:"",md6:""}},["charField"==t.fieldType?i("div",["oname"==t.field?i("v-text-field",{attrs:{label:t.fieldName,disabled:t.readonly,rules:[e.rules.required,function(e){return(e||"").length<=100||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                    "+e._s(t.fieldName)+" "),i("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}],null,!0),model:{value:e.addOrganiz[t.field],callback:function(i){e.$set(e.addOrganiz,t.field,i)},expression:"addOrganiz[editor.field]"}}):i("v-text-field",{attrs:{label:t.fieldName,rules:[function(e){return!e||/^[A-Za-z0-9]+$/.test(e)||"只能填写英文字母和数字"}],disabled:t.readonly},model:{value:e.addOrganiz[t.field],callback:function(i){e.$set(e.addOrganiz,t.field,i)},expression:"addOrganiz[editor.field]"}})],1):e._e()])})),1)],1)],1)],1),i("contentModal",{attrs:{title:"编辑TPM组织架构",IsShow:e.IsShowEdit},on:{modalClosed:function(t){return e.modalClosedEdit()},modalComfirmed:function(t){return e.addOrUpdate()}}},[i("v-container",{staticStyle:{padding:"24px"},attrs:{"grid-list-md":""}},[i("v-form",{ref:"form1",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-layout",{attrs:{wrap:""}},e._l(e.editors,(function(t){return i("v-flex",{key:t.field,attrs:{xs12:"",sm6:"",md6:""}},["charField"==t.fieldType?i("div",["orgCode"==t.field?i("v-text-field",{attrs:{label:t.fieldName},model:{value:e.modifyOrgnization[t.field],callback:function(i){e.$set(e.modifyOrgnization,t.field,i)},expression:"modifyOrgnization[editor.field]"}}):i("v-text-field",{attrs:{label:t.fieldName,disabled:t.readonly,rules:[function(e){return!t.require||!!e||"必填项"},function(e){return(e||"").length<=t.maxLength||"超出最大长度！"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                    "+e._s(t.fieldName)+" "),t.require?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]},proxy:!0}],null,!0),model:{value:e.modifyOrgnization[t.field],callback:function(i){e.$set(e.modifyOrgnization,t.field,i)},expression:"modifyOrgnization[editor.field]"}})],1):e._e()])})),1)],1)],1)],1),i("TpmUserAdd",{ref:"tpmUserAdd",attrs:{IsShowTpmUser:e.IsShow,tpmUserList:e.DataSource,orgId:e.editOrganiz.id},on:{tpmSkillClose:e.tpmUserClosed,tpmUserComfirmed:e.tpmUserComfirmed}}),i("TpmUserEdit",{ref:"tpmUserEdit",attrs:{IsShowEdit:e.IsShowUserEdit,tpmUsers:e.upUserItem},on:{updateSkillClose:e.updateSkillClose,updateUserComfirmed:e.updateUserComfirmed}}),i("contentModal",{attrs:{title:"导入TPM组织架构",IsShow:e.IsShowImport},on:{modalClosed:function(t){return e.modalClosedImport()},modalComfirmed:function(t){return e.ComfirmImport()}}},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:e.downloadTemp}},[e._v("下载导入模板")]),i("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("\n          (注:文档内标题标红的列为必填项，请勿输入以下非法字符：~、@、$、^、&、《、》、<、>、￥)\n        ")])],1),i("UploadFile",{ref:"uploadFile",attrs:{label:"导入文件"},on:{formData:e.getFormData},model:{value:e.base64,callback:function(t){e.base64=t},expression:"base64"}})],1),i("comfirmModal",{attrs:{title:"提示",IsShow:e.IsComfirmShow,text:e.deleteMessage},on:{modalComfirmedClose:function(t){return e.modalComfirmedClose()},modalComfirmed:function(t){return e.cofirmDelete()}}}),i("comfirmModal",{attrs:{title:"提示",IsShow:e.IsComfirmShowUser,text:"是否确定删除所选项？"},on:{modalComfirmedClose:function(t){return e.modalComfirmedClose()},modalComfirmed:function(t){return e.cofirmDeleteUser()}}})],1)])},ee=[],te=(i("4634"),i("f05f")),ie=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-dialog",{attrs:{"max-width":"800px",persistent:!0,scrollable:""},model:{value:e.IsShowTpmUser,callback:function(t){e.IsShowTpmUser=t},expression:"IsShowTpmUser"}},[i("v-card",[i("v-card-title",{staticClass:"primary"},[i("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v("添加人员信息")])]),i("v-card-text",{staticStyle:{padding:"0px 30px"}},[i("v-flex",[i("span",{staticStyle:{"font-size":"16px","margin-top":"20px",display:"inline-block"}},[e._v("\n                        人员：\n                    ")]),i("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"btnClass",attrs:{fab:"",light:"",small:"",color:"primary"},on:{click:e.showAddUser}},a),[i("v-icon",[e._v("add")])],1)]}}])},[i("span",[e._v("添加人员")])])],1),i("v-layout",{attrs:{row:""}},[i("v-flex",{staticStyle:{padding:"10px"}},[i("div",{staticClass:"text-xs-left"},e._l(e.tpmUsers,(function(t){return i("v-chip",{key:t.id},[e._v(e._s(t.name))])})),1)])],1),i("v-form",{ref:"tpmform",staticStyle:{width:"100%"},attrs:{valid:"true","lazy-validation":""}},[i("v-container",{staticStyle:{padding:"0"},attrs:{"grid-list-md":"","text-md-center":""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs6:""}},[i("v-select",{attrs:{label:"负责范围工厂",items:e.orgListFactory,"item-text":"fname","return-object":""},model:{value:e.forgFactory,callback:function(t){e.forgFactory=t},expression:"forgFactory"}})],1),i("v-flex",{attrs:{xs6:""}},[i("treeCombo",{attrs:{itemName:"oname",label:"负责范围",Source:e.childMenu,independentCheck:!0},model:{value:e.forgList,callback:function(t){e.forgList=t},expression:"forgList"}})],1),i("v-flex",{attrs:{xs12:""}},[i("v-select",{attrs:{label:"TPM职能",items:e.tpmSkills,"item-text":"dname","item-value":"dvalue",multiple:"",clearable:"",rules:[function(e){return!!e||"必填项"}]},model:{value:e.skillList,callback:function(t){e.skillList=t},expression:"skillList"}})],1)],1)],1)],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.tpmSkillComfirmed()}}},[e._v("确定")]),i("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.tpmSkillClose()}}},[e._v("取消")])],1)],1)],1),i("tpmUser",{ref:"tpmUsersAdd",attrs:{IsShowAddUser:e.IsShowAddUser,tpmUserList:e.tpmUserList},on:{tpmUserComfirmed:e.tpmUserComfirmed,tpmUserClosed:e.tpmUserClosed}})],1)},ae=[],re=i("f19a"),ne=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-dialog",{attrs:{width:"830px",persistent:!0,scrollable:""},model:{value:e.IsShowAddUser,callback:function(t){e.IsShowAddUser=t},expression:"IsShowAddUser"}},[i("v-form",{ref:"form",staticStyle:{width:"100%"},attrs:{valid:"true"}},[i("v-card",[i("v-card-title",{staticClass:"primary"},[i("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v("添加人员")])]),i("v-card-text",{staticStyle:{height:"500px"}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{staticStyle:{"border-right":"1px silver dashed",padding:"10px"},attrs:{xs6:""}},[i("div",{staticStyle:{"margin-bottom":"10px","margin-left":"10px"}},[i("v-text-field",{attrs:{clearable:"","hide-details":"","single-line":"",primary:"",label:"请输入工号或姓名"},on:{"click:clear":e.clearMessage},scopedSlots:e._u([{key:"append-outer",fn:function(){return[i("v-icon",{on:{click:function(t){return e.doSearch()}}},[e._v("search")])]},proxy:!0}]),model:{value:e.searchfx,callback:function(t){e.searchfx=t},expression:"searchfx"}})],1),0==e.isSearch?i("v-tabs",{staticClass:"selftabs",attrs:{"slider-color":"primary"},model:{value:e.activeValue,callback:function(t){e.activeValue=t},expression:"activeValue"}},[i("v-tab",{key:1},[e._v("\n                                    组织\n                                ")]),i("v-tab",{key:2},[e._v("\n                                    岗位\n                                ")]),i("v-tab-item",{key:1},[i("div",{staticStyle:{"max-width":"370px",padding:"10px 0px"}},[i("treeView",{ref:"childTreeView",attrs:{Source:e.treeItems,radio:!0},on:{afterSelectChange:e.selectChanged}})],1)]),i("v-tab-item",{key:2},[i("div",{staticStyle:{"max-width":"370px",padding:"10px 0px"}},[i("treeView",{ref:"childTreeView",attrs:{Source:e.positionItems,radio:!0},on:{afterSelectChange:e.selectPosition}})],1)])],1):i("v-data-table",{staticClass:"elevation-1",attrs:{"hide-actions":"",items:e.userSource,headers:e.headers},scopedSlots:e._u([{key:"items",fn:function(t){return[i("td",{staticClass:"text-xs-center"},[i("span",{staticStyle:{"font-size":"16px"}},[e._v(e._s(t.item.name))]),i("span",{staticStyle:{"margin-left":"20px","margin-top":"10px"},on:{click:function(i){return e.addUser(t.item,t.index)}}},[i("v-icon",{staticStyle:{"font-size":"18px"}},[e._v("add")])],1)])]}}])})],1),i("v-flex",{staticStyle:{padding:"10px"},attrs:{xs6:""}},[i("div",{staticStyle:{"margin-bottom":"20px","font-size":"16px","font-weight":"bold"}},[e._v("已选中人员")]),i("v-data-table",{staticClass:"elevation-1",attrs:{"hide-actions":"",items:e.selectUserSource,headers:e.headers},scopedSlots:e._u([{key:"items",fn:function(t){return[i("td",{staticClass:"text-xs-center"},[i("span",{staticStyle:{"font-size":"16px"}},[e._v(e._s(t.item.name))]),i("span",{staticStyle:{"margin-left":"20px","margin-top":"10px",cursor:"pointer"},on:{click:function(i){return e.removeUser(t.item,t.index)}}},[i("v-icon",{staticStyle:{"font-size":"18px"}},[e._v("clear")])],1)])]}}])})],1)],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.tpmUserComfirmed()}}},[e._v("确定")]),i("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.tpmUserClosed()}}},[e._v("取消")])],1)],1)],1)],1),i("v-dialog",{attrs:{width:"500"},model:{value:e.IsShow,callback:function(t){e.IsShow=t},expression:"IsShow"}},[i("v-card",[i("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v("\n                提示\n            ")]),i("v-card-text",[e._v("\n                "+e._s(e.message)+"\n            ")]),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){return e.modalComfirmed()}}},[e._v("\n                    是\n                ")]),i("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){return e.modalComfirmedClose()}}},[e._v("\n                    否\n                ")])],1)],1)],1)],1)},oe=[],se=i("1e0e"),le=i("0909"),de={data:function(){return{activeValue:null,treeItems:[],positionItems:[],userSource:[],headers:[{text:"工号(姓名)",align:"center",sortable:!1,value:"name"}],searchfx:"",isSearch:!1,selectUserSource:[],IsShow:!1,message:"",activeItem:{},orgUserList:[],IsPosition:!1}},components:{treeView:se["a"]},props:["IsShowAddUser","orgId","data","tpmUserList"],mounted:function(){this.initialize()},methods:{initialize:function(){var e=this;this.$Server.queryAll((new A["a"]).__name).then((function(t){e.treeItems=t.datas})),this.$Server.queryAll((new le["a"]).__name).then((function(t){e.positionItems=t.datas}))},tpmUserClosed:function(){this.$emit("tpmUserClosed")},tpmUserComfirmed:function(){this.$emit("tpmUserComfirmed",this.selectUserSource)},selectChanged:function(e,t){t.loginName?this.selectUserSource.filter((function(e){return e.id==t.id})).length>0||(this.tpmUserList.filter((function(e){return e.userId==t.id})).length>0?L["a"].alert("该TPM组织架构下已经存在该人员"):this.selectUserSource.push(t)):(this.IsShow=!0,this.message="确认添加该组织下的所有人员？",this.activeItem=t,this.IsPosition=!1)},selectPosition:function(e,t){t.loginName?this.selectUserSource.filter((function(e){return e.id==t.id})).length>0||(this.tpmUserList.filter((function(e){return e.userId==t.id})).length>0?L["a"].alert("该TPM组织架构下已经存在该人员"):this.selectUserSource.push(t)):(this.IsShow=!0,this.IsPosition=!0,this.activeItem=t,this.message="确认添加该岗位下的所有人员？")},removeUser:function(e,t){this.selectUserSource.splice(t,1)},addUser:function(e,t){this.selectUserSource.filter((function(t){return t.id==e.id})).length>0||(this.tpmUserList.filter((function(t){return t.userId==e.id})).length>0?L["a"].alert("该TPM组织架构下已经存在该人员"):this.selectUserSource.push(e))},doSearch:function(){var e=this;this.isSearch=!0,this.$Server.queryAll((new z["a"]).__name,{},{like:this.searchfx}).then((function(t){e.userSource=t.datas}))},clearMessage:function(){this.isSearch=!1,this.initialize()},modalComfirmed:function(){var e=this;1==this.IsPosition?this.$Server.queryAll((new z["a"]).__name,{},{positionId:this.activeItem.id}).then((function(t){e.orgUserList=t.datas,e.orgUserList.forEach((function(t){e.selectUserSource.filter((function(e){return e.id==t.id})).length>0||e.tpmUserList.filter((function(e){return e.userId==t.id})).length>0||e.selectUserSource.push(t)}))})):this.$Server.queryAll((new z["a"]).__name,{},{orgId:this.activeItem.id}).then((function(t){e.orgUserList=t.datas,e.orgUserList.forEach((function(t){e.selectUserSource.filter((function(e){return e.id==t.id})).length>0||e.tpmUserList.filter((function(e){return e.userId==t.id})).length>0||e.selectUserSource.push(t)}))})),this.IsShow=!1},modalComfirmedClose:function(){this.IsShow=!1},clearSelectUser:function(){this.selectUserSource=[],this.isSearch=!1,this.searchfx="",this.initialize()}}},ce=de,ue=Object(p["a"])(ce,ne,oe,!1,null,"5c21eb18",null),fe=ue.exports,me={name:"tpmUserAdd",data:function(){return{headers:[{text:"工号(姓名)",align:"center",sortable:!1,value:"name"}],IsShowAddUser:!1,tpmSkills:[],tpmUsers:[],orgListAll:[],orgList:[],orgListFactory:[],childMenu:[],forgList:[],forgFactory:[],skillList:[]}},components:{tpmUser:fe,treeCombo:re["a"]},watch:{forgFactory:{handler:function(e,t){var i=this;i.childMenu=[],i.forgList=[],i.treeMenuList(i.orgListAll,e.id,i.childMenu),i.childMenu.push(e)},deep:!0}},mounted:function(){var e=this;this.$Server.queryAll((new G["a"]).__name,{},{dname:"TPM职能"}).then((function(t){e.tpmSkills=t.datas})),this.$Server.queryAll((new W["a"]).__name,{},{notStation:"notStation"}).then((function(t){e.orgListFactory=t.datas.filter((function(e){return 1==e.level})),e.orgListAll=t.datas}))},methods:{findForganization:function(){var e=this;this.$Server.queryAll((new W["a"]).__name,{},{notStation:"notStation"}).then((function(t){e.orgListFactory=t.datas.filter((function(e){return 1==e.level})),e.orgListAll=t.datas}))},treeMenuList:function(e,t,i){var a=this;e.forEach((function(r){r.parentId===t&&(a.treeMenuList(e,r.id,i),i.push(r))}))},showAddUser:function(){this.IsShowAddUser=!0},tpmUserComfirmed:function(e){this.tpmUsers=e,this.IsShowAddUser=!1},tpmUserClosed:function(){this.IsShowAddUser=!1},tpmSkillClose:function(){this.forgFactory=[],this.forgList=[],this.childMenu=[],this.$emit("tpmSkillClose")},tpmSkillComfirmed:function(){var e=this,t=this;if(this.tpmUsers.length>0){this.forgList.push(this.forgFactory.id);var i=[];this.forgList=t.$Utils.unique1(this.forgList),this.forgList.length>0&&this.skillList.length>0?(this.tpmUsers.forEach((function(t){i.push({userId:t.id,tpmOrgId:e.orgId,skillList:e.skillList,forgIds:e.forgList})})),this.$emit("tpmUserComfirmed",i),this.forgFactory=[],this.forgList=[],this.childMenu=[]):L["a"].alert("TPM职能和负责范围为必填项")}else L["a"].alert("请选择人员")},clearTpmUsers:function(){this.tpmUsers=[],this.$refs.tpmUsersAdd.clearSelectUser(),this.skillList=[]}},props:["IsShowTpmUser","tpmUserList","orgId"]},pe=me,he=Object(p["a"])(pe,ie,ae,!1,null,"9bda9bfe",null),ge=he.exports,ve=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-dialog",{attrs:{"max-width":"600px",persistent:!0,scrollable:""},model:{value:e.IsShowEdit,callback:function(t){e.IsShowEdit=t},expression:"IsShowEdit"}},[i("v-card",[i("v-card-title",{staticClass:"primary"},[i("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[e._v("编辑人员信息")])]),i("v-card-text",[i("v-layout",{attrs:{row:""}},[i("v-flex",{staticStyle:{"border-right":"1px silver dashed",padding:"10px"}},[i("div",{staticClass:"text-xs-left"},[e._v("\n                            工号（姓名）："),i("v-chip",[e._v(e._s(e.tpmUser.name))])],1)])],1),i("v-form",{ref:"tpmform",staticStyle:{width:"100%"},attrs:{valid:"true","lazy-validation":""}},[i("v-container",{staticStyle:{padding:"0"},attrs:{"grid-list-md":"","text-md-center":""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs6:""}},[i("v-select",{attrs:{label:"负责范围工厂",items:e.orgListFactory,"item-text":"fname","return-object":""},model:{value:e.forgFactory,callback:function(t){e.forgFactory=t},expression:"forgFactory"}})],1),i("v-flex",{attrs:{xs6:""}},[i("treeCombo",{attrs:{itemName:"oname",label:"负责范围",Source:e.childMenu2,independentCheck:!0},model:{value:e.forgList,callback:function(t){e.forgList=t},expression:"forgList"}})],1),i("v-flex",{attrs:{xs12:""}},[i("v-select",{attrs:{label:"TPM职能",items:e.tpmSkills,"item-text":"dname","item-value":"dvalue",multiple:"",clearable:"",rules:[function(e){return!!e||"必填项"}]},model:{value:e.skillList,callback:function(t){e.skillList=t},expression:"skillList"}})],1)],1)],1)],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(t){return e.updateUserComfirmed()}}},[e._v("确定")]),i("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.updateSkillClose()}}},[e._v("取消")])],1)],1)],1)],1)},ye=[],xe={name:"tpmUserEdit",data:function(){return{tpmSkills:[],orgList:[],headers:[{text:"工号(姓名)",align:"center",sortable:!1,value:"name"}],orgListAll:[],orgListFactory:[],childMenu2:[],forgList:[],forgFactory:[],skillList:[]}},components:{treeCombo:re["a"]},watch:{tpmUser:{handler:function(e,t){for(var i=this,a=this,r=function(t){if(a.forgFactory=i.orgListFactory.filter((function(i){return i.id==e.forgIds[t]})),a.forgFactory.length>0&&a.forgFactory!=[])return a.forgFactory=a.forgFactory[0],"break"},n=0;n<e.forgIds.length;n++){var o=r(n);if("break"===o)break}this.skillList=this.tpmUser.skillList,this.forgList=this.tpmUser.forgIds},deep:!0},forgFactory:{handler:function(e,t){var i=this;i.childMenu2=[],0==i.forgList.filter((function(e){return e==i.forgFactory.id})).length&&(i.forgList=[]),i.treeMenuList(i.orgListAll,this.forgFactory.id,i.childMenu2),i.childMenu2.push(this.forgFactory)},deep:!0}},mounted:function(){this.init()},computed:{tpmUser:function(){return this.tpmUsers&&this.tpmUsers.length>0?this.tpmUsers[0]:{}}},methods:{init:function(){var e=this;this.$Server.queryAll((new G["a"]).__name,{},{dname:"TPM职能"}).then((function(t){e.tpmSkills=t.datas})),this.$Server.queryAll((new W["a"]).__name).then((function(t){e.orgListFactory=t.datas.filter((function(e){return 1==e.level})),e.orgListAll=t.datas}))},findForganization:function(){var e=this;this.$Server.queryAll((new W["a"]).__name).then((function(t){e.orgListFactory=t.datas.filter((function(e){return 1==e.level})),e.orgListAll=t.datas}))},treeMenuList:function(e,t,i){var a=this;e.forEach((function(r){r.parentId===t&&(a.treeMenuList(e,r.id,i),i.push(r))}))},updateSkillClose:function(){this.$emit("updateSkillClose")},updateUserComfirmed:function(){this.tpmUser.forgIds.length>0&&this.tpmUser.skillList.length>0?(this.tpmUser.skillList=this.skillList,this.forgList.push(this.forgFactory.id),this.forgList=this.$Utils.unique1(this.forgList),this.tpmUser.forgIds=this.forgList,this.$emit("updateUserComfirmed",[this.tpmUser])):L["a"].alert("TPM职能和负责范围为必填项")}},props:["IsShowEdit","tpmUsers"]},be=xe,Se=Object(p["a"])(be,ve,ye,!1,null,"c27d9dda",null),Ae=Se.exports,ze=i("d9e9"),Fe=new _["a"],Ie=function(e){function t(){var e,i;Object(F["a"])(this,t);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return i=Object(I["a"])(this,(e=Object(w["a"])(t)).call.apply(e,[this].concat(r))),Object(C["a"])(Object(k["a"])(i),"__name","UserTpmOrganization"),Object(C["a"])(Object(k["a"])(i),"userId",Fe.charField({visible:!1})),Object(C["a"])(Object(k["a"])(i),"tpmOrgId",Fe.charField({visible:!1})),Object(C["a"])(Object(k["a"])(i),"jobNumber",Fe.charField({fieldName:"工号"})),Object(C["a"])(Object(k["a"])(i),"uname",Fe.charField({fieldName:"姓名"})),Object(C["a"])(Object(k["a"])(i),"status",Fe.charField({fieldName:"状态"})),Object(C["a"])(Object(k["a"])(i),"forgNames",Fe.charField({fieldName:"负责范围"})),Object(C["a"])(Object(k["a"])(i),"skillNames",Fe.charField({fieldName:"TPM职能"})),i}return Object(O["a"])(t,e),t}(T["a"]),we=new N["a"](new ze["a"]),ke=new N["a"](new Ie),Oe={data:function(){var e=this;return{tpmSkills:[],editors:we.getEditFields(),addEditors:[],valid:!0,rules:{required:function(e){return!!e||"必填项"}},select:[],IsComfirmShow:!1,treeItems:[],actives:null,editOrganiz:{},addOrganiz:{},headers:ke.formatGridHeader(),formatFields:ke.getFormatFields(),DataSource:[],totalDatas:0,total:1,selectUsers:[],IsShow:!1,userOrganiz:[],IsComfirmShowUser:!1,IsShowAdd:!1,headerBtns:[{disabled:!this.$per("TpmOrganization","c"),text:"添加",icon:"self_add",click:function(){return e.GridAdd()}},{disabled:!this.$per("TpmOrganization","u"),text:"编辑",icon:"self_edit",click:function(){return e.GridEdit()}},{disabled:!this.$per("TpmOrganization","d"),text:"删除",icon:"self_delete",click:function(){return e.deleteItems()}},{disabled:!this.$per("TpmOrganization","import"),text:"导入",icon:"self_import",click:function(){return e.importOrganiz()}},{disabled:!this.$per("TpmOrganization","e"),text:"导出",icon:"self_export",click:function(){return e.exportOrganization()}}],items:[],deleteMessage:"",IsShowImport:!1,fileName:"",file:"",base64:"",IsShowEdit:!1,modifyOrgnization:{},orgId:"",data:[],forganizaList:[],IsShowUserEdit:!1,upUserItem:[],isAddOrUpdate:!0}},components:{treeView:g,dataTable:te["a"],contentModal:v["a"],comfirmModal:y["a"],layContent:n["a"],layContentHeader:o["a"],layContentLeft:b["a"],layContentRight:S["a"],UploadFile:x["a"],TpmUserAdd:ge,TpmUserEdit:Ae},mounted:function(){this.editOrganiz={},this.addEditors=this.editors.filter((function(e){return e.field&&"orgCode"!=e.field}));var e=this;this.init(),document.addEventListener("click",(function(t){var i=document.getElementById("tpmtreeView"),a=document.getElementById("layoutLeft01");i&&!i.contains(t.target)&&a&&a.contains(t.target)&&(e.$refs.childTreeView.setActiveVaules(),e.$refs.form1.resetValidation(),e.editOrganiz={},e.DataSource=[])})),document.addEventListener("click",(function(t){var i=document.getElementById("outContainer1"),a=document.getElementById("innerContainer1");i&&i.contains(t.target)&&a&&!a.contains(t.target)&&(e.$refs.childTreeView.setActiveVaules(),e.$refs.form1.resetValidation(),e.editOrganiz={},e.DataSource=[])}))},methods:{init:function(){var e=this;this.$Server.queryAll(we.getModelName()).then((function(t){e.treeItems=t.datas,e.totalDatas=t.page.total}),(function(e){return L["a"].alert(e)})),this.$Server.queryAll((new G["a"]).__name,{},{dname:"TPM职能"}).then((function(t){e.tpmSkills=t.datas})),this.$Server.queryAll((new W["a"]).__name,{},{notStation:"33333333"}).then((function(t){e.forganizaList=t.datas}))},findUsersByOrgId:function(e){var t=this;e&&e.page||(e=t.$refs.childDataTable.getPagination()),t.DataSource=[],this.$Server.queryAll(ke.getModelName(),{page:e.page,rowsPerPage:e.rowsPerPage},{tpmOrgId:t.editOrganiz.id}).then((function(e){t.DataSource=e.datas,null!=t.DataSource&&t.DataSource.forEach((function(e){null!=e.userStatus?e.status=e.userStatus.dname:e.status="",null!=e.skillList&&e.skillList.forEach((function(t,i){e.skillList[i]=parseInt(t)}))})),t.DataSource.length>0?(t.totalDatas=e.page.total,t.total=e.page.total):(t.totalDatas=1,t.total=1)}))},selectChanged:function(e,t){var i,a=this;if(a.items=t,a.treeItems.length>0&&null!=t[0]){i=a.treeItems.find((function(e){return e.id==t}));var r=i,n=r.id,o=r.modifier,s=r.orgCode,l=r.oname,d=r.parentId,c=r.description,u=r.parentName,f=r.rootNode,m=r.level;a.editOrganiz={id:n,modifier:o,orgCode:s,oname:l,parentId:d,description:c,parentName:u,rootNode:f,level:m},a.findUsersByOrgId()}},GridEdit:function(){var e=this.editOrganiz,t=e.id,i=e.modifier,a=e.orgCode,r=e.oname,n=e.parentId,o=e.description,s=e.parentName,l=e.rootNode,d=e.level;this.modifyOrgnization={id:t,modifier:i,orgCode:a,oname:r,parentId:n,description:o,parentName:s,rootNode:l,level:d},null!=this.modifyOrgnization.id?this.IsShowEdit=!0:L["a"].alert("请选择一个节点")},modalClosedEdit:function(){this.IsShowEdit=!1},deleteItems:function(){var e=this;null!=this.editOrganiz.id?(e.DataSource.length>0?e.deleteMessage="该节点下面有人员信息，是否删除节点":e.deleteMessage="是否删除选中项",e.IsComfirmShow=!0):L["a"].alert("请选择需要删除的节点")},GridAdd:function(){this.IsShowAdd=!0,this.$refs.form.resetValidation(),this.addOrganiz={},null!=this.editOrganiz.id?(this.addOrganiz.parentId=this.editOrganiz.id,this.addOrganiz.parentName=this.editOrganiz.oname,this.addOrganiz.rootNode=this.editOrganiz.rootNode,this.addOrganiz.level=this.editOrganiz.level+1):this.addOrganiz.level=1},addOrUpdate:function(){var e=this;this.$refs.form1.validate()?null!=e.modifyOrgnization.id?1==this.isAddOrUpdate&&(this.isAddOrUpdate=!1,this.$Server.addOrUpdate(we.getModelName(),e.modifyOrgnization,!0).then((function(t){e.isAddOrUpdate=!0,e.validName="",t.success&&(e.IsShowEdit=!1,L["a"].alert("修改成功","success"),e.init(),e.$refs.childTreeView.setActiveVaules(),e.editOrganiz={},e.DataSource=[])}),(function(t){e.isAddOrUpdate=!0,L["a"].alert(t)}))):L["a"].alert("请选中修改的数据"):L["a"].alert("格式不正确")},addUser:function(){var e=this;null!=e.editOrganiz.id?(this.IsShow=!0,this.orgId=this.editOrganiz.id,this.$refs.tpmUserAdd.findForganization()):L["a"].alert("请选择一个组织架构")},modalComfirmed:function(){var e=this;this.$refs.form.validate()&&1==this.isAddOrUpdate&&(this.isAddOrUpdate=!1,this.$Server.addOrUpdate(we.getModelName(),e.addOrganiz,!1).then((function(t){e.isAddOrUpdate=!0,e.IsShowAdd=!1,t.success&&(e.$refs.form1.reset(),e.$refs.form.reset(),e.init(),e.$refs.childTreeView.setActiveVaules(),e.editOrganiz={},e.DataSource=[])}),(function(t){e.isAddOrUpdate=!0,L["a"].alert(t)})))},modalClosed:function(){this.IsShowAdd=!1,this.$refs.form.resetValidation(),this.select=[]},modalComfirmedClose:function(){this.IsComfirmShow=!1,this.IsComfirmShowUser=!1},cofirmDelete:function(){var e=this;e.IsComfirmShow=!1,e.$Server.delete(we.getModelName(),e.editOrganiz).then((function(t){t.success&&(e.IsComfirmShow=!1,e.init(),e.editOrganiz={},e.$refs.form.reset(),e.$refs.form1.reset(),e.items=[],e.DataSource=[])}),(function(e){return L["a"].alert(e)}))},deleteUserItem:function(){this.$refs.childDataTable.getCheckItems().length>0?this.IsComfirmShowUser=!0:L["a"].alert("选择要删除的项")},cofirmDeleteUser:function(){var e=this,t=this.$refs.childDataTable.getCheckItems();this.$Server.batchDelete(ke.getModelName(),t).then((function(t){t.success&&(e.IsComfirmShowUser=!1,e.findUsersByOrgId())}))},importOrganiz:function(){this.IsShowImport=!0,this.$refs.uploadFile.clearFile()},exportOrganization:function(){this.$Server.exportFile(we.getModelName(),"TPM组织管理"+this.$Utils.getLocalFotmatTime())},ComfirmImport:function(){var e=this,t=this.$refs.uploadFile.filename,i={base64:this.base64,fileName:t,fileType:"xls"};null==this.base64||0==this.base64.length?L["a"].alert("请选择导入的文件"):this.$Server.importFile(we.getModelName(),i).then((function(t){e.init(),t.success&&null==t.datas.error?(L["a"].alert("导入成功","success"),e.$refs.uploadFile.clearFile(),e.IsShowImport=!1):L["a"].alert(t.datas.error)}),(function(e){return L["a"].alert(e)}))},getFormData:function(e){var t=this,i=e.get("data");if(i){var a=i.name.substring(i.name.lastIndexOf(".")+1,i.name.length);"xls"!=a&&"xlsx"!=a&&(L["a"].alert("请检查文件是否为Excel文件"),t.$refs.uploadFile.clearFile())}},modalClosedImport:function(){this.IsShowImport=!1,this.$refs.uploadFile.clearFile()},downloadTemp:function(){var e=document.createElement("a");e.href="/imporTemp/tpmOrganization.xls",e.download="TPM组织架构.xls",e.click()},tpmUserComfirmed:function(e){var t=this;this.$Server.batchSave(ke.getModelName(),e).then((function(e){e.success&&(t.IsShow=!1,t.findUsersByOrgId(),t.select=[],t.$refs.tpmUserAdd.clearTpmUsers())}),(function(e){return L["a"].alert(e)}))},tpmUserClosed:function(){this.IsShow=!1,this.$refs.tpmUserAdd.clearTpmUsers()},updateSkillClose:function(){this.IsShowUserEdit=!1},updateUserComfirmed:function(e){var t=this;this.$Server.batchUpdate(ke.getModelName(),e).then((function(e){e.success?(t.findUsersByOrgId(),L["a"].alert("保存成功","success"),t.IsShowUserEdit=!1):L["a"].alert("保存失败","error")}))},updateUserItem:function(){if(this.$refs.childDataTable.getCheckItems().length>0){var e=[];this.$refs.childDataTable.getCheckItems().forEach((function(t){var i=Object.assign({},t);e.push(i)})),this.upUserItem=e,this.$refs.tpmUserEdit.findForganization(),this.IsShowUserEdit=!0}else L["a"].alert("请选择一行数据")}}},Ce=Oe,_e=(i("9041"),i("7c37"),i("b885"),Object(p["a"])(Ce,K,ee,!1,null,"47a1f4ac",null)),Te=_e.exports,Ue={name:"organizational",components:{organization:V,Forganization:J,tpmOrganization:Te},data:function(){return{actives:null}}},$e=Ue,Ne=(i("92c2"),Object(p["a"])($e,a,r,!1,null,null,null));t["default"]=Ne.exports},d9e9:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var a=i("7300"),r=i("5873"),n=i("ddf2"),o=i("80ea"),s=i("ae0a"),l=i("97a3"),d=i("652a"),c=i("1269"),u=new d["a"],f=function(e){function t(){var e,i;Object(a["a"])(this,t);for(var s=arguments.length,d=new Array(s),c=0;c<s;c++)d[c]=arguments[c];return i=Object(r["a"])(this,(e=Object(n["a"])(t)).call.apply(e,[this].concat(d))),Object(l["a"])(Object(o["a"])(i),"__name","TpmOrganization"),Object(l["a"])(Object(o["a"])(i),"orgCode",u.charField({require:!0,fieldName:"编号"})),Object(l["a"])(Object(o["a"])(i),"oname",u.charField({require:!0,fieldName:"名称"})),Object(l["a"])(Object(o["a"])(i),"parentId",u.charField({require:!1,fieldName:"上级组织",editable:!1})),Object(l["a"])(Object(o["a"])(i),"parentName",u.charField({require:!1,fieldName:"上级组织",readonly:!0})),Object(l["a"])(Object(o["a"])(i),"description",u.charField({require:!1,fieldName:"描述"})),Object(l["a"])(Object(o["a"])(i),"orgType",u.charField({require:!1,fieldName:"组织类型",editable:!1})),Object(l["a"])(Object(o["a"])(i),"rootNode",u.charField({require:!1,fieldName:"根节点",editable:!1,visible:!1})),Object(l["a"])(Object(o["a"])(i),"level",u.charField({require:!1,visible:!1,fieldName:"级别",editable:!1})),i}return Object(s["a"])(t,e),t}(c["a"])},e0d8:function(e,t,i){}}]);