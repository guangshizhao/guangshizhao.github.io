(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-326976a8"],{"30ff":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("layContentHeader",{attrs:{title:"保养标准",buttons:t.headerBtns}},[a("v-text-field",{staticStyle:{width:"280px"},attrs:{label:"请输入设备编号、设备名称",clearable:"","hide-details":"","single-line":"",primary:""},on:{"click:clear":t.clearMessage},scopedSlots:t._u([{key:"append-outer",fn:function(){return[a("v-icon",{on:{click:function(e){return t.doSearch()}}},[t._v("search")])]},proxy:!0}]),model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),a("layContent",[a("gridTemplate",{ref:"childGridTemplate",attrs:{title:"保养标准",gridModel:t.MaintainStandard,initCondition:t.initCondition,sort:!0,IsCenter:!0,id:"selfgrid"},on:{editorsReCode:t.editorsReCode,beforeEdit:t.beforeEdit,beforeAdd:t.beforeAdd,beforeEditSubmit:t.beforeEditSubmit,rowDbClick:t.rowDbClick}})],1),a("contentModal",{attrs:{title:"导入保养标准",IsShow:t.IsShowImport},on:{modalClosed:function(e){return t.modalClosedImport()},modalComfirmed:function(e){return t.ComfirmImport()}}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:t.downloadTemp}},[t._v("下载导入模板")]),a("div",{staticStyle:{color:"red","font-size":"12px"}},[t._v("\n                (注:文档内标题标红的列为必填项，请勿输入以下非法字符：~、@、$、^、&、《、》、<、>、￥)\n            ")])],1),a("UploadFile",{ref:"uploadFile",attrs:{label:"导入文件"},on:{formData:t.getFormData},model:{value:t.base64,callback:function(e){t.base64=e},expression:"base64"}})],1),a("importBackModal",{attrs:{title:"保养标准",IsShow:t.importBackShow,importbackModal:t.allChangeList,headers:t.headers},on:{importBackModalComfirmed:function(e){return t.importBackModalComfirmed()},importBackModalClosed:function(e){return t.importBackModalClosed()}}}),a("MaintainStandardAdd",{ref:"MaintainStandardAdd",attrs:{IsShow:t.IsShowAdd},on:{maintainStandardAddClosed:function(e){return t.maintainStandardAddClosed()},maintainStandardAddComfirmed:function(e){return t.maintainStandardAddComfirmed()},maintainStandardAddSuccess:function(e){return t.maintainStandardAddSuccess()}}}),a("MaintainStandardUpdate",{attrs:{IsShow:t.IsShowUpdate,updateData:t.updateData},on:{maintainStandardUpdateClosed:function(e){return t.maintainStandardUpdateClosed()},maintainStandardUpdateComfirmed:function(e){return t.maintainStandardUpdateComfirmed()},maintainStandardUpdateSuccess:function(e){return t.maintainStandardUpdateSuccess()}}})],1)},n=[],r=(a("7cfd"),a("4634"),a("b9da")),s=a("d1fc"),l=a("55b3"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":"1000px",persistent:!0,scrollable:""},model:{value:t.IsShow,callback:function(e){t.IsShow=e},expression:"IsShow"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[t._v(t._s(t.title))])]),a("v-card-text",[a("addEquipmentModal",{attrs:{initCondition:t.initCondition,isClear:t.isClear},on:{equipmentType:t.getEquipmentType,equipmentPosition:t.getEquipmentPosition,equipment:t.getEquipment}}),a("br"),a("v-form",{ref:"form",attrs:{"lazy-validation":""}},[a("v-container",{staticStyle:{padding:"0"},attrs:{"grid-list-md":"","text-md-center":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-text-field",{attrs:{label:"保养位置"},model:{value:t.part,callback:function(e){t.part=e},expression:"part"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-text-field",{attrs:{label:"保养内容",rules:[t.rules.required]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                                    保养内容"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-select",{attrs:{label:"保养目的",items:t.purposeData,"item-text":"dname","item-value":"dvalue"},model:{value:t.purpose,callback:function(e){t.purpose=e},expression:"purpose"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}}),a("v-flex",{attrs:{xs12:"",sm12:""}},[a("v-textarea",{attrs:{label:"保养方法",rules:[t.rules.required]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                                    保养方法"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.method,callback:function(e){t.method=e},expression:"method"}})],1),a("v-flex",{attrs:{xs12:"",sm12:""}},[a("v-textarea",{attrs:{label:"保养工具物料"},model:{value:t.materiel,callback:function(e){t.materiel=e},expression:"materiel"}})],1),a("v-flex",{attrs:{xs12:"",sm12:""}},[a("v-textarea",{attrs:{label:"标准描述",rules:[t.rules.required]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                                    标准描述"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.standard,callback:function(e){t.standard=e},expression:"standard"}})],1),a("v-flex",{attrs:{xs12:"",sm12:""}},[a("v-textarea",{attrs:{label:"备注"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-text-field",{attrs:{label:"保养标准时间",type:"number",suffix:"min",rules:[function(t){return!!t||"必须是数字."},function(t){return!t||/^(0|[1-9][0-9]*)$/.test(t)||"只能是正整数"}]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                                    保养标准时间"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.spendTime,callback:function(e){t.spendTime=e},expression:"spendTime"}})],1),a("v-flex",{attrs:{xs6:"",sm3:""}},[a("v-text-field",{attrs:{label:"保养周期",type:"number",rules:[function(t){return!!t||"必须是数字."},function(t){return!t||/^(0|[1-9][0-9]*)$/.test(t)||"只能是正整数"}]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                                    保养周期"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.period,callback:function(e){t.period=e},expression:"period"}})],1),a("v-flex",{attrs:{xs6:"",sm3:""}},[a("v-select",{attrs:{label:"保养周期单位",items:t.periodUnitData,"item-text":"dname","item-value":"dvalue",rules:[t.rules.selectRe]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                                    保养周期单位"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.periodUnit,callback:function(e){t.periodUnit=e},expression:"periodUnit"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-radio-group",{attrs:{label:"保养设备状态",row:""},model:{value:t.eqpStatus,callback:function(e){t.eqpStatus=e},expression:"eqpStatus"}},t._l(t.eqpStatusData,(function(t){return a("v-radio",{key:t.dvalue,attrs:{label:t.dname,value:t.dvalue}})})),1)],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-dialog",{ref:"dialog",attrs:{"return-value":t.lastMaintainTime,"full-width":"",width:"290"},model:{value:t.lastMaintainTimeModal,callback:function(e){t.lastMaintainTimeModal=e},expression:"lastMaintainTimeModal"}},[a("v-text-field",{attrs:{slot:"activator","prepend-icon":"event",readonly:"",maxlength:"10",label:"上次保养时间"},slot:"activator",model:{value:t.lastMaintainTime,callback:function(e){t.lastMaintainTime=e},expression:"lastMaintainTime"}}),a("v-date-picker",{attrs:{locale:"zh-cn",dayFormat:t.dayFormat},on:{change:function(e){t.lastMaintainTimeModal=!1}},model:{value:t.lastMaintainTime,callback:function(e){t.lastMaintainTime=e},expression:"lastMaintainTime"}})],1)],1)],1)],1),a("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t._v("\n                    更换备件\n                    "),a("v-btn",{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){return t.addRowSpareParts()}}},[a("v-icon",[t._v("\n                            add\n                        ")])],1),a("v-btn",{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){return t.deleteSpareparts(t.delPos,t.delIndex)}}},[a("v-icon",[t._v("\n                            remove\n                        ")])],1)],1),a("v-container",{attrs:{id:"box"}},t._l(t.spareParts,(function(e,i){return a("v-layout",{key:e.field,staticClass:"box-child",attrs:{"data-pos":e.id,wrap:"",row:"","align-center":"","justify-space-around":""}},t._l(t.editSpares,(function(i){return a("v-flex",{key:i.field,attrs:{xs3:""}},["备件"==i.text?a("v-select",{attrs:{items:t.sparePartsList,label:i.text,"item-text":"codeName","item-value":"id"},model:{value:e[i.value],callback:function(a){t.$set(e,i.value,a)},expression:"pos[item.value]"}}):t._e(),"规格型号"==i.text?a("v-text-field",{attrs:{label:i.text,disabled:""},model:{value:e[i.value],callback:function(a){t.$set(e,i.value,a)},expression:"pos[item.value]"}}):t._e(),"数量"==i.text?a("v-text-field",{attrs:{label:i.text,rules:[function(t){return!t||/^(0|[1-9][0-9]*)$/.test(t)||"只能是正整数"}],type:"number"},model:{value:e[i.value],callback:function(a){t.$set(e,i.value,a)},expression:"pos[item.value]"}}):t._e(),"更换位置"==i.text?a("v-text-field",{attrs:{label:i.text,required:""},model:{value:e[i.value],callback:function(a){t.$set(e,i.value,a)},expression:"pos[item.value]"}}):t._e()],1)})),1)})),1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(e){return t.maintainStandardAdd()}}},[t._v("继续添加")]),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(e){return t.maintainStandardAddComfirmed()}}},[t._v("确定")]),a("v-btn",{attrs:{color:"primary"},on:{click:function(e){return t.maintainStandardAddClosed()}}},[t._v("取消")])],1)],1)],1)},o=[],c=(a("cc1d"),a("c041"),a("fa2f")),u=a("8333"),p=a("a7fe"),m=a("2c75"),f=a("d5b3"),v=new u["a"]((new s["a"]).rMaintainStandardSparePartsViewModelList.model),b={name:"maintainStandardAdd",data:function(){return{title:"添加保养标准",equipmentPosition:"",initCondition:{deleted:!1,eStatus:[0,1,2,4,5]},equipmentType:"",equipmentViewModelList:[],part:"",content:"",standard:"",spendTime:"",method:"",eqpStatus:1,purpose:"",description:"",period:"",periodUnit:"",materiel:"",rMaintainStandardSparePartsViewModelList:[],periodUnitData:[],eqpStatusData:[],purposeData:[],submitData:{},isClear:!1,spareParts:[],sparePartsList:[],lastMaintainTime:(new Date).toISOString().substr(0,10),editSpares:v.formatGridHeader(),type:"",rules:{required:function(t){return!!t||"必填项."},min:function(t){return t.length>=8||"Min 8 characters"},selectRe:function(t){return!!/^(0)$/.test(t)||!!t||"必填项"}},isAdd:!0,lastMaintainTimeModal:!1,delIndex:0,delPos:{}}},mounted:function(){var t=this;this.init(),$("#box").on("click",".box-child",(function(){t.delIndex=$(this).index(),t.delPos.id=$(this).attr("data-pos"),$(".box-child").removeClass("box-active"),$(this).addClass("box-active")}))},watch:{spareParts:{handler:function(t,e){var a=this;t.forEach((function(t,e){var i=a.sparePartsList.filter((function(e){return e.id==t.sparePartsId}));i.length>0&&(a.spareParts[e].model=i[0].model)}));var i=a.spareParts.filter((function(t){return void 0==t["sparePartsId"]})),n=a.spareParts.filter((function(t){return void 0!=t["sparePartsId"]})),r=a.filterByName(n,"sparePartsId");r.length+i.length!==t.length&&(a.delIndex=0,a.delPos.id="",$(".box-child").removeClass("box-active"),f["a"].alert("不能选重复的数据！","warning"),a.spareParts=r)},deep:!0}},methods:{init:function(){var t=this;t.equipmentPosition="",t.equipmentType="",t.equipmentViewModelList=[],t.part="",t.description="",t.content="",t.standard="",t.spendTime="",t.delIndex=0,t.method="",t.eqpStatus=0,t.purpose="",t.materiel="",t.period="",t.periodUnit="",t.isClear=!1,t.lastMaintainTime=(new Date).toISOString().substr(0,10),t.spareParts=[],t.rMaintainStandardSparePartsViewModelList=[],t.periodUnitData=[],t.eqpStatusData=[],t.$Server.queryAll((new p["a"]).__name,null,{type:19}).then((function(e){t.periodUnitData=e.datas})),t.$Server.queryAll((new p["a"]).__name,null,{type:22}).then((function(e){t.eqpStatusData=e.datas})),t.$Server.queryAll((new m["a"]).__name,null,{deleted:!1}).then((function(e){t.sparePartsList=e.datas})),t.$Server.queryAll((new p["a"]).__name,null,{type:21}).then((function(e){t.purposeData=e.datas})),t.editSpares=this.editSpares.filter((function(t){return!("maintenancePlanId"==t.value)&&!("id"==t.value)})),t.spareParts.push({})},dayFormat:function(t){return t?new Date(t.replace(/-/g,"/")).getDate():""},getEquipment:function(t){this.equipmentViewModelList=t},filterByName:function(t,e){for(var a=[],i=0;i<t.length;i++){var n=t[i];if(0==i)a.push(n);else{var r=a.filter((function(t){return t[e]==n[e]}));0==r.length&&a.push(n)}}return a},getEquipmentPosition:function(t){this.equipmentPosition=t},getEquipmentType:function(t){this.equipmentType=t},maintainStandardAdd:function(){var t=this;0!==this.equipmentViewModelList.length||""!==this.equipmentPosition&&void 0!==this.equipmentPosition||""!==this.equipmentType&&void 0!==this.equipmentType?this.$refs.form.validate()?t.submitDatas((function(){t.initMStander()})):f["a"].alert("请填写必填项"):f["a"].alert("请选择设备的方式","warning")},maintainStandardAddComfirmed:function(){var t=this;0!==this.equipmentViewModelList.length||""!==this.equipmentPosition&&void 0!==this.equipmentPosition||""!==this.equipmentType&&void 0!==this.equipmentType?this.$refs.form.validate()?t.submitDatas((function(){t.isClear=!0,t.$refs.form.resetValidation(),t.$emit("maintainStandardAddComfirmed"),t.$refs.form.resetValidation(),setTimeout((function(){t.init()}),1e3)})):f["a"].alert("请填写必填项"):f["a"].alert("请选择设备的方式")},maintainStandardAddClosed:function(){var t=this;this.isClear=!0,this.$emit("maintainStandardAddClosed"),t.$refs.form.resetValidation(),setTimeout((function(){t.init()}),200)},addRowSpareParts:function(){var t=this;t.spareParts.push({})},initMStander:function(){var t=this;t.part="",t.content="",t.standard="",t.spendTime="",t.materiel="",t.description="",t.method="",t.eqpStatus=0,t.purpose="",t.period="",t.periodUnit="",t.lastMaintainTime=(new Date).toISOString().substr(0,10),t.rMaintainStandardSparePartsViewModelList=[],t.spareParts=[],t.spareParts.push({}),setTimeout((function(){t.$refs.form.resetValidation()}),1e3)},deleteSpareparts:function(t,e){var a=this;a.spareParts.splice(e,1)},submitDatas:function(t){var e=this;e.submitData.equipmentPosition=e.equipmentPosition,e.submitData.equipmentType=e.equipmentType,e.submitData.equipmentViewModelList=e.equipmentViewModelList,e.submitData.part=e.part,e.submitData.content=e.content,e.submitData.standard=e.standard,e.submitData.spendTime=e.spendTime,e.submitData.description=e.description,e.submitData.method=e.method,e.submitData.eqpStatus=e.eqpStatus,e.submitData.materiel=e.materiel,e.submitData.purpose=e.purpose,e.submitData.lastMaintainTime=e.lastMaintainTime,e.submitData.period=e.period,e.submitData.periodUnit=e.periodUnit,e.submitData.rMaintainStandardSparePartsViewModelList=e.spareParts,e.isAdd&&(e.isAdd=!1,e.$Server.addOrUpdate("MaintainStandard",e.submitData,!1).then((function(a){a.success&&(f["a"].alert("新增成功","success"),e.isAdd=!0,e.$emit("maintainStandardAddSuccess"),t())}),(function(t){e.isAdd=!0,f["a"].alert(t.toString())})))}},components:{addEquipmentModal:c["a"]},props:["IsShow"]},h=b,S=(a("e650"),a("6691")),x=Object(S["a"])(h,d,o,!1,null,null,null),D=x.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":"1000px",persistent:!0,scrollable:""},model:{value:t.IsShow,callback:function(e){t.IsShow=e},expression:"IsShow"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("span",{staticClass:"headline",staticStyle:{color:"#fff"}},[t._v(t._s(t.title))])]),a("v-card-text",[a("v-container",{staticStyle:{padding:"0"},attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm3:""}},[a("label",[t._v("设备编号：")]),t._v(t._s(t.updateData.code)+"\n          ")]),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("label",[t._v("设备名称：")]),t._v(t._s(t.updateData.name)+"\n          ")]),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("label",[t._v("规格型号：")]),t._v(t._s(t.updateData.model)+"\n          ")]),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("label",[t._v("设备位置：")]),t._v(t._s(t.updateData.position)+"\n          ")])],1)],1),a("br"),a("v-form",{ref:"form1",attrs:{"lazy-validation":""}},[a("v-container",{staticStyle:{padding:"0"},attrs:{"grid-list-md":"","text-md-center":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-text-field",{attrs:{label:"保养位置"},model:{value:t.updateData.part,callback:function(e){t.$set(t.updateData,"part",e)},expression:"updateData.part"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-text-field",{attrs:{label:"保养内容",rules:[t.rules.required]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                  保养内容"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.updateData.content,callback:function(e){t.$set(t.updateData,"content",e)},expression:"updateData.content"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-select",{attrs:{label:"保养目的",items:t.purposeData,"item-text":"dname","item-value":"dvalue"},model:{value:t.updateData.purpose,callback:function(e){t.$set(t.updateData,"purpose",e)},expression:"updateData.purpose"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}}),a("v-flex",{attrs:{xs12:"",sm12:""}},[a("v-textarea",{attrs:{label:"保养方法",rules:[t.rules.required]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                  保养方法"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.updateData.method,callback:function(e){t.$set(t.updateData,"method",e)},expression:"updateData.method"}})],1),a("v-flex",{attrs:{xs12:"",sm12:""}},[a("v-textarea",{attrs:{label:"保养工具物料"},model:{value:t.updateData.materiel,callback:function(e){t.$set(t.updateData,"materiel",e)},expression:"updateData.materiel"}})],1),a("v-flex",{attrs:{xs12:"",sm12:""}},[a("v-textarea",{attrs:{label:"标准描述",rules:[t.rules.required]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                  标准描述"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.updateData.standard,callback:function(e){t.$set(t.updateData,"standard",e)},expression:"updateData.standard"}})],1),a("v-flex",{attrs:{xs12:"",sm12:""}},[a("v-textarea",{attrs:{label:"备注"},model:{value:t.updateData.description,callback:function(e){t.$set(t.updateData,"description",e)},expression:"updateData.description"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-text-field",{attrs:{label:"保养标准时间",type:"number",suffix:"min",rules:[function(t){return!!t||"必须是数字."},function(t){return!t||/^(0|[1-9][0-9]*)$/.test(t)||"只能是正整数"}]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                  保养标准时间"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.updateData.spendTime,callback:function(e){t.$set(t.updateData,"spendTime",e)},expression:"updateData.spendTime"}})],1),a("v-flex",{attrs:{xs6:"",sm3:""}},[a("v-text-field",{attrs:{label:"保养周期",rules:[function(t){return!!t||"必须是数字."},function(t){return!t||/^(0|[1-9][0-9]*)$/.test(t)||"只能是正整数"}],type:"number"},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                  保养周期"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.updateData.period,callback:function(e){t.$set(t.updateData,"period",e)},expression:"updateData.period"}})],1),a("v-flex",{attrs:{xs6:"",sm3:""}},[a("v-select",{attrs:{label:"保养周期单位",items:t.periodUnitData,"item-text":"dname","item-value":"dvalue",rules:[t.rules.selectRe]},scopedSlots:t._u([{key:"label",fn:function(){return[t._v("\n                  保养周期单位"),a("span",{staticStyle:{color:"red"}},[t._v("*")])]},proxy:!0}]),model:{value:t.updateData.periodUnit,callback:function(e){t.$set(t.updateData,"periodUnit",e)},expression:"updateData.periodUnit"}})],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-radio-group",{attrs:{label:"保养标准设备状态",row:""},model:{value:t.updateData.eqpStatus,callback:function(e){t.$set(t.updateData,"eqpStatus",e)},expression:"updateData.eqpStatus"}},t._l(t.eqpStatusData,(function(t){return a("v-radio",{key:t.dvalue,attrs:{label:t.dname,value:t.dvalue,"prepend-inner-icon":"star"}})})),1)],1),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-dialog",{ref:"dialog",attrs:{disabled:t.isDisabled,"return-value":t.updateData.lastMaintainTime,"full-width":"",width:"290"},model:{value:t.uDLastMaintainTimeModal,callback:function(e){t.uDLastMaintainTimeModal=e},expression:"uDLastMaintainTimeModal"}},[a("v-text-field",{attrs:{slot:"activator","prepend-icon":"event",readonly:"",disabled:t.isDisabled,maxlength:"10",label:"上次保养时间"},slot:"activator",model:{value:t.updateData.lastMaintainTime,callback:function(e){t.$set(t.updateData,"lastMaintainTime",e)},expression:"updateData.lastMaintainTime"}}),a("v-date-picker",{attrs:{locale:"zh-cn",dayFormat:t.dayFormat},on:{change:function(e){t.uDLastMaintainTimeModal=!1}},model:{value:t.updateData.lastMaintainTime,callback:function(e){t.$set(t.updateData,"lastMaintainTime",e)},expression:"updateData.lastMaintainTime"}})],1)],1)],1)],1),a("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t._v("\n          更换备件\n          "),a("v-btn",{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){return t.addRowSpareParts()}}},[a("v-icon",[t._v("\n              add\n            ")])],1),a("v-btn",{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){return t.deleteSpareparts(t.delPos,t.delIndex)}}},[a("v-icon",[t._v("\n              remove\n            ")])],1)],1),a("v-container",{attrs:{id:"box"}},t._l(t.updateData.rMaintainStandardSparePartsViewModelList,(function(e,i){return a("v-layout",{key:e.field,staticClass:"box-child",attrs:{"data-pos":e.id,wrap:"",row:"","align-center":"","justify-space-around":""}},t._l(t.editSpares,(function(i){return a("v-flex",{key:i.field,attrs:{xs3:""}},["备件"==i.text?a("v-select",{attrs:{items:t.sparePartsList,label:i.text,"item-text":"codeName","item-value":"id"},model:{value:e[i.value],callback:function(a){t.$set(e,i.value,a)},expression:"pos[item.value]"}}):t._e(),"规格型号"==i.text?a("v-text-field",{attrs:{label:i.text,disabled:""},model:{value:e[i.value],callback:function(a){t.$set(e,i.value,a)},expression:"pos[item.value]"}}):t._e(),"数量"==i.text?a("v-text-field",{attrs:{label:i.text,type:"number",rules:[function(t){return!t||/^(0|[1-9][0-9]*)$/.test(t)||"只能是正整数"}]},model:{value:e[i.value],callback:function(a){t.$set(e,i.value,a)},expression:"pos[item.value]"}}):t._e(),"更换位置"==i.text?a("v-text-field",{attrs:{label:i.text,required:""},model:{value:e[i.value],callback:function(a){t.$set(e,i.value,a)},expression:"pos[item.value]"}}):t._e()],1)})),1)})),1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticStyle:{"margin-right":"30px"},attrs:{color:"primary"},on:{click:function(e){return t.maintainStandardUpdateComfirmed()}}},[t._v("确定")]),a("v-btn",{attrs:{color:"primary"},on:{click:function(e){return t.maintainStandardUpdateClosed()}}},[t._v("取消")])],1)],1)],1)},w=[],M=a("a504"),k=new u["a"]((new s["a"]).rMaintainStandardSparePartsViewModelList.model),_=new u["a"](new M["a"]),q={name:"maintainStandardUpdate",data:function(){return{title:"编辑保养标准",periodUnitData:[],eqpStatusData:[],purposeData:[],sparePartsList:[],editSpares:k.formatGridHeader(),rules:{required:function(t){return!!t||"必填项."},selectRe:function(t){return!!/^(0)$/.test(t)||!!t||"必填项"},min:function(t){return t.length>=8||"Min 8 characters"}},isDisabled:!0,isUpdate:!0,uDLastMaintainTimeModal:!1,delIndex:0,delPos:{}}},mounted:function(){var t=this;t.init(),$("#box").on("click",".box-child",(function(){t.delIndex=$(this).index(),t.delPos.id=$(this).attr("data-pos"),$(".box-child").removeClass("box-active"),$(this).addClass("box-active")}))},watch:{updateData:{handler:function(t,e){"admin"===sessionStorage.getItem("user")&&(this.isDisabled=!1);var a=this;t.rMaintainStandardSparePartsViewModelList.forEach((function(t,e){var i=a.sparePartsList.filter((function(e){return e.id==t.sparePartsId}));i.length>0&&(a.updateData.rMaintainStandardSparePartsViewModelList[e].model=i[0].model)}))},deep:!0}},methods:{init:function(){var t=this;t.periodUnitData=[],t.eqpStatusData=[],t.$Server.queryAll((new p["a"]).__name,null,{type:19}).then((function(e){t.periodUnitData=e.datas})),t.$Server.queryAll((new p["a"]).__name,null,{type:22}).then((function(e){t.eqpStatusData=e.datas})),t.$Server.queryAll((new m["a"]).__name,null,{deleted:!1}).then((function(e){t.sparePartsList=e.datas})),t.$Server.queryAll((new p["a"]).__name,null,{type:21}).then((function(e){t.purposeData=e.datas})),t.editSpares=this.editSpares.filter((function(t){return!("maintenancePlanId"==t.value)&&!("id"==t.value)}))},dayFormat:function(t){return t?new Date(t.replace(/-/g,"/")).getDate():""},input:function(){},maintainStandardUpdateComfirmed:function(){this.$refs.form1.validate()?(this.submitDatas(),this.init(),this.$refs.form1.resetValidation()):f["a"].alert("请填写必填项")},maintainStandardUpdateClosed:function(){this.$emit("maintainStandardUpdateClosed"),this.init()},addRowSpareParts:function(){this.updateData.rMaintainStandardSparePartsViewModelList.push({})},deleteSpareparts:function(t,e){var a=this;console.log(t),console.log(t.id),null!=t.id?a.$Server.delete(_.getModelName(),t).then((function(t){t.success&&a.updateData.rMaintainStandardSparePartsViewModelList.splice(e,1)}),(function(t){return f["a"].alert(t)})):a.updateData.rMaintainStandardSparePartsViewModelList.splice(e,1)},submitDatas:function(){var t=this;t.isUpdate&&(t.isUpdate=!1,t.$Server.addOrUpdate("MaintainStandard",t.updateData,!0).then((function(e){e.success&&(f["a"].alert("保存成功","success"),t.isUpdate=!0,t.$emit("maintainStandardUpdateSuccess"),t.$emit("maintainStandardUpdateComfirmed"))}),(function(e){t.isUpdate=!0,f["a"].alert(e.toString())})))}},components:{},props:["IsShow","updateData"]},g=q,O=Object(S["a"])(g,y,w,!1,null,null,null),C=O.exports,T=a("a2a7"),j=a("c976"),I={data:function(){var t=this;return{initCondition:{deleted:!1},headerBtns:[{disabled:!this.$per("MaintainStandard","c"),text:"添加",icon:"self_add",click:function(){return t.maintainStandardAddClick()}},{disabled:!this.$per("MaintainStandard","u"),text:"编辑",icon:"self_edit",click:function(){return t.maintainStandardUpdateClick()}},{disabled:!this.$per("MaintainStandard","d"),text:"删除",icon:"self_delete",click:function(){return t.$refs.childGridTemplate.GridDelete()}},{disabled:!this.$per("MaintainStandard","import"),text:"导入",icon:"self_import",click:function(){return t.importMaintainStandard()}},{disabled:!this.$per("MaintainStandard","e"),text:"导出",icon:"self_export",click:function(){return t.exportMaintainStandard()}}],headers:[{text:"设备编号",value:"code",align:"center",sortable:!1},{text:"设备名称",value:"name",align:"center",sortable:!1},{text:"规格型号",value:"model",align:"center",sortable:!1},{text:"设备位置",value:"position",align:"center",sortable:!1},{text:"保养内容",value:"content",align:"center",sortable:!1},{text:"保养位置",value:"part",align:"center",sortable:!1},{text:"保养周期",value:"periodData",align:"center",sortable:!1},{text:"保养时间(单位min)",value:"spendTime",align:"center",sortable:!1},{text:"设备状态",value:"eqpStatusChinese",align:"center",sortable:!1},{text:"保养目的",value:"purposeChinese",align:"center",sortable:!1},{text:"保养方法",value:"method",align:"center",sortable:!1},{text:"保养标准",value:"standard",align:"center",sortable:!1}],MaintainStandard:{},IsShowImport:!1,IsShowDetails:!1,importBackShow:!1,base64:"",IsShowAdd:!1,IsShowUpdate:!1,searchValue:"",updateData:{},allChangeList:[],allSourcesList:[]}},components:{gridTemplate:r["a"],UploadFile:l["a"],contentModal:T["a"],MaintainStandardAdd:D,MaintainStandardUpdate:C,importBackModal:j["a"]},mounted:function(){this.MaintainStandard=new s["a"]},methods:{init:function(){this.IsShowImport=!1,this.IsShowDetails=!1,this.importBackShow=!1,this.base64="",this.IsShowAdd=!1,this.IsShowUpdate=!1,this.searchValue="",this.allChangeList=[],this.allSourcesList=[]},maintainStandardAddClick:function(){this.$refs.MaintainStandardAdd.$refs.form.resetValidation(),this.IsShowAdd=!0},maintainStandardUpdateClick:function(){1!=this.$refs.childGridTemplate.getCheckItems().length?f["a"].alert("请选中一个需要修改的项"):(this.updateData=this.$refs.childGridTemplate.getCheckItems()[0],this.updateData.lastMaintainTime=this.updateData.lastMaintainTime.substring(0,10),this.IsShowUpdate=!0)},editorsReCode:function(){},beforeEdit:function(){},beforeAdd:function(){},beforeEditSubmit:function(){},doSearch:function(){var t=this,e={like:this.searchValue};t.$refs.childGridTemplate.doSearch(e)},clearMessage:function(){this.$refs.childGridTemplate.doSearch({})},exportMaintainStandard:function(){this.$Server.exportFile("MaintainStandard","保养标准"+this.$Utils.getLocalFotmatTime())},importMaintainStandard:function(){this.IsShowImport=!0},modalClosedImport:function(){this.IsShowImport=!1,this.$refs.uploadFile.clearFile()},ComfirmImport:function(){var t=this;t.allSourcesList=[],t.allChangeList=[];var e=this.$refs.uploadFile.filename,a={base64:this.base64,fileName:e,fileType:"xls"};null==this.base64||0==this.base64.length?f["a"].alert("请选择导入的文件"):this.$Server.importFile((new s["a"]).__name,a).then((function(e){if(t.$refs.uploadFile.clearFile(),e.success&&e.datas.success)f["a"].alert("导入成功","success"),t.IsShowImport=!1,t.$refs.childGridTemplate.init();else{t.importBackShow=!0,t.IsShowImport=!1;var a=JSON.parse(JSON.stringify(e.datas.data)),i=JSON.parse(JSON.stringify(e.datas.data));i.forEach((function(e){t.allSourcesList.push(e.t)})),a.forEach((function(e){null!==e.t.id&&(e.t.content=t.$Utils.setRed(e.t.content)),t.allChangeList.push(e.t)}))}}),(function(t){return f["a"].alert(t)}))},importBackModalClosed:function(){this.importBackShow=!1},importBackModalComfirmed:function(){var t=this;t.$Server.batchSave((new s["a"]).__name,t.allSourcesList).then((function(e){e.success&&(f["a"].alert("导入成功","success"),t.importBackShow=!1,t.init())}),(function(t){return f["a"].alert(t)}))},getFormData:function(t){var e=this,a=t.get("data");if(a){var i=a.name.substring(a.name.lastIndexOf(".")+1,a.name.length);"xls"!=i&&"xlsx"!=i&&(f["a"].alert("请检查文件是否为Excel文件"),e.$refs.uploadFile.clearFile())}},modalClosed:function(){this.IsShowDetails=!1},modalComfirmed:function(){this.IsShowDetails=!1},maintainStandardAddClosed:function(){this.IsShowAdd=!1,this.$refs.childGridTemplate.init({}),this.init()},maintainStandardAddComfirmed:function(){this.IsShowAdd=!1,this.$refs.childGridTemplate.init({}),this.init()},maintainStandardUpdateClosed:function(){var t=this;this.$refs.childGridTemplate.unCheckItems(),t.$refs.childGridTemplate.init({}),this.init()},maintainStandardUpdateSuccess:function(){var t=this;t.$refs.childGridTemplate.init({})},maintainStandardAddSuccess:function(){var t=this;t.$refs.childGridTemplate.init({})},maintainStandardUpdateComfirmed:function(){this.$refs.childGridTemplate.unCheckItems(),this.init()},rowDbClick:function(){},downloadTemp:function(){var t=document.createElement("a");t.href="/imporTemp/maintainStandard.xls",t.download="保养标准.xls",t.click()}}},P=I,U=(a("7650"),Object(S["a"])(P,i,n,!1,null,null,null));e["default"]=U.exports},7650:function(t,e,a){"use strict";var i=a("820f"),n=a.n(i);n.a},"820f":function(t,e,a){},"95c0":function(t,e,a){},a504:function(t,e,a){"use strict";a.d(e,"a",(function(){return m}));var i=a("7300"),n=a("5873"),r=a("ddf2"),s=a("80ea"),l=a("ae0a"),d=a("97a3"),o=a("652a"),c=a("1269"),u=a("2c75"),p=new o["a"],m=function(t){function e(){var t,a;Object(i["a"])(this,e);for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];return a=Object(n["a"])(this,(t=Object(r["a"])(e)).call.apply(t,[this].concat(o))),Object(d["a"])(Object(s["a"])(a),"__name","RMaintainStandardSpareParts"),Object(d["a"])(Object(s["a"])(a),"sparePartsId",p.comboBoxField(u["a"],{require:!0,fieldName:"备件"})),Object(d["a"])(Object(s["a"])(a),"model",p.charField({require:!1,fieldName:"规格型号"})),Object(d["a"])(Object(s["a"])(a),"amount",p.numberField("int",{require:!0,visible:!0,fieldName:"数量"})),Object(d["a"])(Object(s["a"])(a),"part",p.charField({require:!1,fieldName:"更换位置"})),Object(d["a"])(Object(s["a"])(a),"id",p.charField({require:!1,fieldName:"id",visible:!1})),Object(d["a"])(Object(s["a"])(a),"maintenancePlanId",p.charField({require:!1,fieldName:"保养计划id",editable:!1})),a}return Object(l["a"])(e,t),e}(c["a"])},d1fc:function(t,e,a){"use strict";a.d(e,"a",(function(){return m}));var i=a("7300"),n=a("5873"),r=a("ddf2"),s=a("80ea"),l=a("ae0a"),d=a("97a3"),o=a("652a"),c=a("1269"),u=a("a504"),p=new o["a"],m=function(t){function e(){var t,a;Object(i["a"])(this,e);for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];return a=Object(n["a"])(this,(t=Object(r["a"])(e)).call.apply(t,[this].concat(o))),Object(d["a"])(Object(s["a"])(a),"__name","MaintainStandard"),Object(d["a"])(Object(s["a"])(a),"equipmentId",p.charField({require:!1,visible:!1,fieldName:"设备id"})),Object(d["a"])(Object(s["a"])(a),"code",p.charField({require:!1,visible:!0,fieldName:"设备编号",tableOrder:9})),Object(d["a"])(Object(s["a"])(a),"name",p.charField({require:!1,visible:!0,fieldName:"设备名称",tableOrder:10})),Object(d["a"])(Object(s["a"])(a),"model",p.charField({require:!1,visible:!0,fieldName:"规格型号",tableOrder:20})),Object(d["a"])(Object(s["a"])(a),"position",p.charField({require:!1,visible:!1,fieldName:"设备位置",tableOrder:30})),Object(d["a"])(Object(s["a"])(a),"part",p.charField({require:!0,visible:!1,fieldName:"保养位置",tableOrder:40})),Object(d["a"])(Object(s["a"])(a),"content",p.charField({require:!0,visible:!0,fieldName:"保养内容",tableOrder:50})),Object(d["a"])(Object(s["a"])(a),"purpose",p.charField({require:!0,visible:!1,fieldName:"保养目的"})),Object(d["a"])(Object(s["a"])(a),"purposeChinese",p.charField({require:!0,visible:!0,fieldName:"保养目的",tableOrder:60})),Object(d["a"])(Object(s["a"])(a),"method",p.charField({require:!0,visible:!0,fieldName:"保养方法",tableOrder:70})),Object(d["a"])(Object(s["a"])(a),"materiel",p.charField({require:!1,visible:!0,fieldName:"保养工具物料"})),Object(d["a"])(Object(s["a"])(a),"standard",p.charField({require:!0,visible:!0,fieldName:"标准描述",tableOrder:80})),Object(d["a"])(Object(s["a"])(a),"spendTime",p.numberField("int",{require:!0,visible:!0,fieldName:"标准保养时间(min)",tableOrder:90})),Object(d["a"])(Object(s["a"])(a),"periodData",p.charField({require:!0,visible:!0,fieldName:"保养周期",tableOrder:100})),Object(d["a"])(Object(s["a"])(a),"eqpStatus",p.charField({require:!0,visible:!1,fieldName:"设备状态"})),Object(d["a"])(Object(s["a"])(a),"eqpStatusChinese",p.charField({require:!0,visible:!0,fieldName:"保养时设备状态",tableOrder:110})),Object(d["a"])(Object(s["a"])(a),"dataEqpStatus",p.charField({require:!1,visible:!1,fieldName:"保养目的",format:function(t){if(null!=t&&null!=t.dname)return t.dname}})),Object(d["a"])(Object(s["a"])(a),"datePurpose",p.charField({require:!1,visible:!1,fieldName:"保养目的",format:function(t){if(null!=t&&null!=t.dname)return t.dname}})),Object(d["a"])(Object(s["a"])(a),"period",p.charField({require:!0,visible:!1,fieldName:"保养周期"})),Object(d["a"])(Object(s["a"])(a),"periodUnit",p.charField({require:!0,visible:!1,fieldName:"周期单位"})),Object(d["a"])(Object(s["a"])(a),"lastMaintainTime",p.charField({require:!0,visible:!0,fieldName:"上次保养时间",editable:!1,tableOrder:120,format:function(t){if(t)return t.substring(0,10)}})),Object(d["a"])(Object(s["a"])(a),"nextMaintainTime",p.charField({require:!0,visible:!1,fieldName:"下次保养时间",editable:!1})),Object(d["a"])(Object(s["a"])(a),"description",p.charField({require:!1,visible:!1,fieldName:"备注",editable:!1})),Object(d["a"])(Object(s["a"])(a),"rMaintainStandardSparePartsViewModelList",p.oneToManyField(u["a"],"fff",{editableMode:"grid"})),a}return Object(l["a"])(e,t),e}(c["a"])},e650:function(t,e,a){"use strict";var i=a("95c0"),n=a.n(i);n.a}}]);