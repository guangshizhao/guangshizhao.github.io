(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-200ea4ae"],{7422:function(e,t,i){},adb2:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("layContentHeader",{attrs:{title:"数据字典",buttons:e.headerBtns}}),i("layContent",[i("v-layout",[i("layContentLeft",{attrs:{title:"数据字典"}},[i("v-treeview",{attrs:{active:e.treeValues,open:e.open,items:e.rows,activatable:"","active-class":"primary--text","return-object":"","open-on-click":""},on:{"update:active":function(t){e.treeValues=t},"update:open":function(t){e.open=t}},scopedSlots:e._u([{key:"prepend",fn:function(t){var a=t.item,n=t.open;return[a.file?i("v-icon",[e._v("\n              "+e._s(e.files[a.file])+"\n            ")]):i("v-icon",[e._v("\n              "+e._s(n?"mdi-folder-open":"mdi-folder")+"\n            ")])]}}])})],1),i("layContentRight",[i("v-layout",{staticStyle:{"background-color":"#ececee"}},[i("v-flex",{staticClass:"primary--text",staticStyle:{"margin-left":"20px","font-size":"20px"}},[e._v(e._s(e.activeItem.dname?e.activeItem.dname:""))])],1),i("v-flex",[i("dataTable",{ref:"childDataTable",attrs:{headers:e.headers,DataSource:e.DataSource,totalDatas:e.totalDatas,parentId:e.parentId,hideOperation:!0},on:{rowDbClick:e.rowDbClick}})],1)],1)],1)],1),i("contentModal",{attrs:{title:e.title,IsShow:e.IsShow,width:"600px"},on:{modalClosed:function(t){return e.modalClosed()},modalComfirmed:function(t){return e.modalComfirmed()}}},[i("v-container",{attrs:{"grid-list-md":""}},[i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-layout",{staticStyle:{padding:"0 50px"},attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-text-field",{attrs:{label:"名称",disabled:e.editedItem.power&&"0011"==e.editedItem.power,rules:[function(e){return!!e||"必填项"}]},scopedSlots:e._u([{key:"label",fn:function(){return[e._v("\n                名称 "),i("span",{staticStyle:{color:"red"}},[e._v("*")])]},proxy:!0}]),model:{value:e.editedItem.dname,callback:function(t){e.$set(e.editedItem,"dname",t)},expression:"editedItem.dname"}})],1),i("v-flex",{attrs:{xs12:""}},[i("v-text-field",{attrs:{label:"编码"},model:{value:e.editedItem.dcode,callback:function(t){e.$set(e.editedItem,"dcode",t)},expression:"editedItem.dcode"}})],1),i("v-flex",{attrs:{xs12:""}},[i("v-textarea",{attrs:{label:"备注",rules:[function(e){return!0}]},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",t)},expression:"editedItem.description"}})],1),0==e.treeValues.length?i("v-flex",{attrs:{xs12:"",sm6:"",md6:""}},[i("v-radio-group",{attrs:{row:""},model:{value:e.editedItem.viewType,callback:function(t){e.$set(e.editedItem,"viewType",t)},expression:"editedItem.viewType"}},[e._v("\n              是否为树形结构：\n              "),i("v-radio",{attrs:{label:"是",value:"0"}}),i("v-radio",{attrs:{label:"否",value:"1"}})],1)],1):e._e()],1)],1)],1)],1),i("comfirmModal",{attrs:{title:"提示",IsShow:e.IsComfirmShow,text:"确定删除所选项？"},on:{modalComfirmedClose:function(t){return e.modalComfirmedClose()},modalComfirmed:function(t){return e.cofirmDelete()}}})],1)},n=[],r=(i("0b34"),i("cc1d"),i("bada"),i("4634"),i("7cfd"),i("a2a7")),d=i("23f5"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.currentDatas,"item-key":"id","hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[i("tr",{class:e.activeItem.id==t.item.id?"secondary":"",on:{click:function(i){return e.setActiveItem(t.item)},dblclick:function(i){return e.rowDbClick(t.item)}}},[i("td",[i("span",{style:t.item.level?"margin-left:"+20*t.item.level+"px":"",on:{click:function(i){return e.expandTree(t)}}},[t.item.hasChild?i("v-icon",[e._v(e._s(t.item.isExpand?"expand_less":"expand_more"))]):e._e()],1),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.item[e.fiestColumn.value]))])]),e._l(e.fheader,(function(a){return i("td",{key:a.value},[e._v(e._s(t.item[a.value]))])})),e.hideOperation?e._e():i("td",{staticClass:"justify-start layout px-0"},["0"==t.item.viewType?i("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(i){return e.addChildItem(t.item)}}},[e._v("\n                    add\n                ")]):e._e(),i("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(i){return e.editItem(t.item)}}},[e._v("\n                    edit\n                ")]),i("v-icon",{attrs:{small:""},on:{click:function(i){return e.deleteItem(t.item)}}},[e._v("\n                    delete\n                ")])],1)],2)]}}]),model:{value:e.checkedItem,callback:function(t){e.checkedItem=t},expression:"checkedItem"}},[i("template",{slot:"no-data"},[i("v-btn",{attrs:{color:"primary"},on:{click:e.initialize}},[e._v("重新获取")])],1)],2)},l=[],o=i("dea4"),c=(i("8f42"),{data:function(){return{checkedItem:[],currentDatas:[],activeItem:{}}},props:{headers:{type:Array,required:!0},DataSource:{type:Array,required:!0},totalDatas:{type:Number,default:0},parentId:{type:String,default:""},hideOperation:{type:Boolean,default:!1}},computed:{fiestColumn:function(){return this.headers?this.headers[0]:{}},fheader:function(){var e=this;return e.headers.filter((function(e,t){return e.value&&t>0}))}},watch:{checkedItem:{handler:function(e,t){}},DataSource:{handler:function(){this.initialize()},deep:!0}},mounted:function(){this.initialize()},methods:{initialize:function(){var e=this;this.DataSource.forEach((function(t){e.DataSource.filter((function(e){return e.parentId==t.id})).length?t.hasChild=!0:t.hasChild=!1})),this.currentDatas=this.DataSource.filter((function(t){return t.parentId==e.parentId}))},addChildItem:function(e){this.$emit("addChildItem",e)},editItem:function(e){this.$emit("editItem",e)},deleteItem:function(e){this.$emit("deleteItem",e)},getCheckItems:function(){return this.checkedItem},getPagination:function(){return this.pagination?this.pagination:{page:1,rowsPerPage:10}},expandTree:function(e){if(e.item.isExpand){e.item.isExpand=!1;var t=this.currentDatas.filter((function(t){return t.parentId==e.item.id}));t.map((function(e){return e.level=0})),this.currentDatas=this.currentDatas.filter((function(t){return t.parentId!=e.item.id}))}else{e.item.isExpand=!0;var i=this.currentDatas.findIndex((function(t){return t.id==e.item.id})),a=this.DataSource.filter((function(t){return t.parentId==e.item.id}));if(a){a.forEach((function(e){e.level?e.level+=1:e.level=1}));var n=this.currentDatas.filter((function(e,t,a){return t<=i})),r=this.currentDatas.filter((function(e,t,a){return t>i}));this.currentDatas=[].concat(Object(o["a"])(n),Object(o["a"])(a),Object(o["a"])(r))}}},setActiveItem:function(e){null!=this.activeItem.id&&this.activeItem.id==e.id?this.activeItem={}:(this.activeItem={},this.activeItem=e)},getActiveItem:function(){return this.activeItem},unActiveItem:function(){this.activeItem={}},rowDbClick:function(e){this.$emit("rowDbClick",e)}}}),u=c,m=i("6691"),f=Object(m["a"])(u,s,l,!1,null,null,null),h=f.exports,v=i("8333"),p=i("1e17"),I=i("07c5"),b=i("8907"),y=i("adf0"),w=i("a7fe"),D=i("d5b3"),C=new v["a"](new w["a"]),g={name:"orderTable",data:function(){var e=this;return{treeValues:[],open:[1],valid:!0,rules:{required:function(e){return!!e||"必填项"}},selectItems:[],IsShow:!1,IsComfirmShow:!1,IsLoading:!0,DataSource:[],dataMenus:[],temporary:{},totalDatas:0,parentId:"",headers:C.formatGridHeader(),editedItem:{},defaultEdit:C.getEditFields(),headerBtns:[{disabled:!this.$per("Datadict","c"),text:"添加",icon:"self_add",click:function(){return e.GridAdd()}},{disabled:!this.$per("Datadict","u"),text:"编辑",icon:"self_edit",click:function(){return e.GridEdit()}},{disabled:!this.$per("Datadict","d"),text:"删除",icon:"self_delete",click:function(){return e.GridDelete()}}],Datadict:{},title:"",activeItem:{}}},components:{contentModal:r["a"],comfirmModal:d["a"],dataTable:h,layContent:p["a"],layContentHeader:I["a"],layContentLeft:b["a"],layContentRight:y["a"]},watch:{treeValues:{handler:function(e){this.treeValues=e,1==this.treeValues.length&&this.findById(this.treeValues[0].dvalue,this.treeValues[0].id)},deep:!0}},mounted:function(){this.Datadict=new w["a"],this.init()},computed:{rows:function(){var e={},t=[];if(void 0==this.dataMenus||null==this.dataMenus||0==this.dataMenus.length);else for(var i=0;i<this.dataMenus.length;i++){var a=this.dataMenus[i],n=a.dgroup;if(e[n])for(var r=0;r<t.length;r++){var d=t[r];if(n==d.name){d.children.push(a);break}}else t.push({id:i+1,name:n,children:[a]}),e[n]=a}return t.forEach((function(e){e.children.forEach((function(e){e.name=e.dname}))})),t}},methods:{init:function(){var e=this;this.$Server.queryAll(C.getModelName(),{},{parentId:-1}).then((function(t){e.dataMenus=t.datas,e.dataMenus.length}),(function(e){return D["a"].alert(e)}))},findById:function(e,t){var i=this;i.parentId=t,i.selectItems=[],this.$refs.childDataTable.unActiveItem(),this.activeItem=this.dataMenus.find((function(e){return e.id==t})),this.$Server.queryAll(C.getModelName(),{page:"-1",rowsPerPage:"-1"},{type:e}).then((function(e){i.DataSource=e.datas,i.DataSource.length<1&&D["a"].alert("当前分类下没有数据")}),(function(e){return D["a"].alert(e)}))},guid:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},GridAdd:function(){var e=this;if(this.treeValues.length>0)if(0==this.activeItem.editable)D["a"].alert("该节点不能编辑");else if(this.$refs.form.reset(),this.title="添加数据字典",null!=this.$refs.childDataTable.getActiveItem().id){var t=this.$refs.childDataTable.getActiveItem();1==t.viewType?D["a"].alert("该项目下不能添加数据"):(this.editedItem={},this.editedItem.parentId=t.id,this.editedItem.typeId=t.typeId,this.editedItem.viewType=t.viewType,this.editedItem.editable=t.editable,this.IsShow=!0)}else this.editedItem={},this.editedItem.parentId=this.parentId,this.editedItem.typeId=this.activeItem.dvalue,this.editedItem.viewType=this.dataMenus.find((function(t){return t.id==e.parentId})).viewType,this.editedItem.editable=this.activeItem.editable,this.IsShow=!0;else D["a"].alert("请选中一条数据字典的类型")},GridEdit:function(){var e=this,t=this.$refs.childDataTable.getActiveItem();if(null==t.id)D["a"].alert("请选中需要修改的数据");else if(0==t.editable)D["a"].alert("节点不可编辑");else{this.$refs.form.resetValidation(),this.title="编辑数据字典",this.editedItem={};var i=t,a=i.id,n=i.createTime,r=i.updateTime,d=i.creator,s=i.modifier,l=i.dvalue,o=i.dcode,c=i.parentId,u=i.typeId,m=i.viewType,f=i.editable,h=i.power;this.editedItem={id:a,createTime:n,updateTime:r,creator:d,modifier:s,dvalue:l,dcode:o,parentId:c,typeId:u,viewType:m,editable:f,power:h},this.defaultEdit.forEach((function(t,a){t.field&&(e.editedItem[t.field]=i[t.field])})),this.IsShow=!0}},GridDelete:function(){var e=this.$refs.childDataTable.getActiveItem();null==e.id?D["a"].alert("请选中需要删除的数据"):0==e.editable?D["a"].alert("该节点不能删除"):"0011"==e.power?D["a"].alert("该节点不能删除"):this.IsComfirmShow=!0},cofirmDelete:function(){var e=this;null==this.$refs.childDataTable.getActiveItem().id?D["a"].alert("请选择要删除的数据"):e.$Server.delete(C.getModelName(),this.$refs.childDataTable.getActiveItem()).then((function(t){t.success?(e.IsComfirmShow=!1,e.findById(e.$refs.childDataTable.getActiveItem().typeId,e.parentId),e.$refs.childDataTable.setActiveItem({})):D["a"].alert("删除失败")}),(function(t){e.IsComfirmShow=!1,D["a"].alert(t)}))},modalClosed:function(){var e=this;this.IsShow=!1;this.DataSource.findIndex((function(t){return e.temporary.id==t.id}))},modalComfirmed:function(){var e=this;this.$refs.form.validate()&&e.$Server.addOrUpdate(C.getModelName(),e.editedItem,e.editedItem.id).then((function(t){t.success&&(e.IsShow=!1,null!=e.activeItem&&null!=e.activeItem.dvalue?e.findById(e.activeItem.dvalue,e.parentId):e.init(),e.IsShow=!1)}),(function(e){D["a"].alert(e)}))},modalComfirmedClose:function(){this.IsComfirmShow=!1},rowDbClick:function(){}}},x=g,S=(i("b91d"),Object(m["a"])(x,a,n,!1,null,"05a08de0",null));t["default"]=S.exports},b91d:function(e,t,i){"use strict";var a=i("7422"),n=i.n(a);n.a}}]);